{"remainingRequest":"C:\\dev\\freshnet-vue\\node_modules\\babel-loader\\lib\\index.js!C:\\dev\\freshnet-vue\\src\\stores\\tools\\DataLoader.js","dependencies":[{"path":"C:\\dev\\freshnet-vue\\src\\stores\\tools\\DataLoader.js","mtime":1666019912109},{"path":"C:\\dev\\freshnet-vue\\babel.config.js","mtime":1662650914175},{"path":"C:\\dev\\freshnet-vue\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1662650916242},{"path":"C:\\dev\\freshnet-vue\\node_modules\\babel-loader\\lib\\index.js","mtime":1662650915901}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IF9hc3luY1RvR2VuZXJhdG9yIGZyb20gIkM6XFxkZXZcXGZyZXNobmV0LXZ1ZVxcbm9kZV9tb2R1bGVzXFxAYmFiZWxcXHJ1bnRpbWVcXGhlbHBlcnNcXGVzbVxcYXN5bmNUb0dlbmVyYXRvci5qcyI7CmltcG9ydCBfY2xhc3NDYWxsQ2hlY2sgZnJvbSAiQzpcXGRldlxcZnJlc2huZXQtdnVlXFxub2RlX21vZHVsZXNcXEBiYWJlbFxccnVudGltZVxcaGVscGVyc1xcZXNtXFxjbGFzc0NhbGxDaGVjay5qcyI7CmltcG9ydCBfY3JlYXRlQ2xhc3MgZnJvbSAiQzpcXGRldlxcZnJlc2huZXQtdnVlXFxub2RlX21vZHVsZXNcXEBiYWJlbFxccnVudGltZVxcaGVscGVyc1xcZXNtXFxjcmVhdGVDbGFzcy5qcyI7CmltcG9ydCBfZGVmaW5lUHJvcGVydHkgZnJvbSAiQzpcXGRldlxcZnJlc2huZXQtdnVlXFxub2RlX21vZHVsZXNcXEBiYWJlbFxccnVudGltZVxcaGVscGVyc1xcZXNtXFxkZWZpbmVQcm9wZXJ0eS5qcyI7CmltcG9ydCAicmVnZW5lcmF0b3ItcnVudGltZS9ydW50aW1lLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMub2JqZWN0LnRvLXN0cmluZy5qcyI7CmltcG9ydCBWYWxpZGF0aW9uQ2hlY2tlciBmcm9tICIuL1ZhbGlkYXRpb25DaGVja2VyIjsKCnZhciBEYXRhTG9hZGVyID0gLyojX19QVVJFX18qL2Z1bmN0aW9uICgpIHsKICBmdW5jdGlvbiBEYXRhTG9hZGVyKCkgewogICAgdmFyIGFyZyA9IGFyZ3VtZW50cy5sZW5ndGggPiAwICYmIGFyZ3VtZW50c1swXSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzBdIDogewogICAgICB0aW1lb3V0OiAxMDAwICogNjAgKiAxMAogICAgfTsKCiAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgRGF0YUxvYWRlcik7CgogICAgX2RlZmluZVByb3BlcnR5KHRoaXMsICIkdmFsaWRhdG9yIiwgdm9pZCAwKTsKCiAgICBfZGVmaW5lUHJvcGVydHkodGhpcywgIiRnZXRQcm9jZXNzb3IiLCB2b2lkIDApOwoKICAgIF9kZWZpbmVQcm9wZXJ0eSh0aGlzLCAiJGxvYWREYXRhIiwgdm9pZCAwKTsKCiAgICBfZGVmaW5lUHJvcGVydHkodGhpcywgIiRzZXREYXRhIiwgdm9pZCAwKTsKCiAgICBfZGVmaW5lUHJvcGVydHkodGhpcywgIiRnZXREYXRhIiwgdm9pZCAwKTsKCiAgICB0aGlzLiR2YWxpZGF0b3IgPSBuZXcgVmFsaWRhdGlvbkNoZWNrZXIoewogICAgICB0aW1lb3V0OiBhcmcudGltZW91dAogICAgfSk7CiAgfQoKICBfY3JlYXRlQ2xhc3MoRGF0YUxvYWRlciwgW3sKICAgIGtleTogInByb2Nlc3NvciIsCiAgICB2YWx1ZTogZnVuY3Rpb24gcHJvY2Vzc29yKGNhbGxiYWNrKSB7CiAgICAgIHRoaXMuJGdldFByb2Nlc3NvciA9IGNhbGxiYWNrOwogICAgICByZXR1cm4gdGhpczsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJsb2FkRGF0YSIsCiAgICB2YWx1ZTogZnVuY3Rpb24gbG9hZERhdGEoY2FsbGJhY2spIHsKICAgICAgdGhpcy4kbG9hZERhdGEgPSBjYWxsYmFjazsKICAgICAgcmV0dXJuIHRoaXM7CiAgICB9CiAgfSwgewogICAga2V5OiAic2V0RGF0YSIsCiAgICB2YWx1ZTogZnVuY3Rpb24gc2V0RGF0YShjYWxsYmFjaykgewogICAgICB0aGlzLiRzZXREYXRhID0gY2FsbGJhY2s7CiAgICAgIHJldHVybiB0aGlzOwogICAgfQogIH0sIHsKICAgIGtleTogImdldERhdGEiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGdldERhdGEoY2FsbGJhY2spIHsKICAgICAgdGhpcy4kZ2V0RGF0YSA9IGNhbGxiYWNrOwogICAgICByZXR1cm4gdGhpczsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJkb1RpbWVvdXQiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGRvVGltZW91dCgpIHsKICAgICAgdGhpcy4kdmFsaWRhdG9yLnJlc2V0Q2hlY2twb2ludCgpOwogICAgfQogIH0sIHsKICAgIGtleTogImlzVGltZW91dCIsCiAgICB2YWx1ZTogZnVuY3Rpb24gaXNUaW1lb3V0KCkgewogICAgICByZXR1cm4gIXRoaXMuJHZhbGlkYXRvci5pc1ZhbGlkKCk7CiAgICB9CiAgfSwgewogICAga2V5OiAiZGF0YSIsCiAgICB2YWx1ZTogZnVuY3Rpb24gZGF0YSgpIHsKICAgICAgdmFyIHZhbGlkYXRvciA9IHRoaXMuJHZhbGlkYXRvcjsKICAgICAgdmFyIHByb2Nlc3NvciA9IHRoaXMuJGdldFByb2Nlc3NvcigpOwogICAgICB2YXIgZ2V0RGF0YSA9IHRoaXMuJGdldERhdGE7CiAgICAgIHZhciBzZXREYXRhID0gdGhpcy4kc2V0RGF0YTsKICAgICAgdmFyIGxvYWREYXRhID0gdGhpcy4kbG9hZERhdGE7CiAgICAgIHJldHVybiBwcm9jZXNzb3IuYWNxdWlyZSgiRGF0YUxvYWRlciIsIC8qI19fUFVSRV9fKi9fYXN5bmNUb0dlbmVyYXRvciggLyojX19QVVJFX18qL3JlZ2VuZXJhdG9yUnVudGltZS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWUoKSB7CiAgICAgICAgdmFyIGRhdGE7CiAgICAgICAgcmV0dXJuIHJlZ2VuZXJhdG9yUnVudGltZS53cmFwKGZ1bmN0aW9uIF9jYWxsZWUkKF9jb250ZXh0KSB7CiAgICAgICAgICB3aGlsZSAoMSkgewogICAgICAgICAgICBzd2l0Y2ggKF9jb250ZXh0LnByZXYgPSBfY29udGV4dC5uZXh0KSB7CiAgICAgICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICAgICAgX2NvbnRleHQucHJldiA9IDA7CgogICAgICAgICAgICAgICAgaWYgKCF2YWxpZGF0b3IuaXNWYWxpZCgpKSB7CiAgICAgICAgICAgICAgICAgIF9jb250ZXh0Lm5leHQgPSAzOwogICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQuYWJydXB0KCJyZXR1cm4iLCBnZXREYXRhKCkpOwoKICAgICAgICAgICAgICBjYXNlIDM6CiAgICAgICAgICAgICAgICBfY29udGV4dC5uZXh0ID0gNTsKICAgICAgICAgICAgICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7CiAgICAgICAgICAgICAgICAgIHZhbGlkYXRvci5yZXNldENoZWNrcG9pbnQoKTsKICAgICAgICAgICAgICAgICAgc2V0RGF0YShudWxsKTsKICAgICAgICAgICAgICAgICAgbG9hZERhdGEoKS50aGVuKGZ1bmN0aW9uIChkYXRhKSB7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHJlc29sdmUoZGF0YSk7CiAgICAgICAgICAgICAgICAgIH0pLmNhdGNoKGZ1bmN0aW9uIChlcnJvcikgewogICAgICAgICAgICAgICAgICAgIHJldHVybiByZWplY3QoZXJyb3IpOwogICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgIH0pOwoKICAgICAgICAgICAgICBjYXNlIDU6CiAgICAgICAgICAgICAgICBkYXRhID0gX2NvbnRleHQuc2VudDsKICAgICAgICAgICAgICAgIHNldERhdGEoZGF0YSk7CiAgICAgICAgICAgICAgICB2YWxpZGF0b3IubWFrZUNoZWNrcG9pbnQoKTsKICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dC5hYnJ1cHQoInJldHVybiIsIGdldERhdGEoKSk7CgogICAgICAgICAgICAgIGNhc2UgMTE6CiAgICAgICAgICAgICAgICBfY29udGV4dC5wcmV2ID0gMTE7CiAgICAgICAgICAgICAgICBfY29udGV4dC50MCA9IF9jb250ZXh0WyJjYXRjaCJdKDApOwogICAgICAgICAgICAgICAgdmFsaWRhdG9yLnJlc2V0Q2hlY2twb2ludCgpOwogICAgICAgICAgICAgICAgc2V0RGF0YShudWxsKTsKICAgICAgICAgICAgICAgIHRocm93IF9jb250ZXh0LnQwOwoKICAgICAgICAgICAgICBjYXNlIDE2OgogICAgICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQuc3RvcCgpOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfSwgX2NhbGxlZSwgbnVsbCwgW1swLCAxMV1dKTsKICAgICAgfSkpKTsKICAgIH0KICB9XSk7CgogIHJldHVybiBEYXRhTG9hZGVyOwp9KCk7CgpleHBvcnQgZGVmYXVsdCBEYXRhTG9hZGVyOw=="},{"version":3,"sources":["C:/dev/freshnet-vue/src/stores/tools/DataLoader.js"],"names":["ValidationChecker","DataLoader","arg","timeout","$validator","callback","$getProcessor","$loadData","$setData","$getData","resetCheckpoint","isValid","validator","processor","getData","setData","loadData","acquire","Promise","resolve","reject","then","data","catch","error","makeCheckpoint"],"mappings":";;;;;;AAAA,OAAOA,iBAAP,MAA8B,qBAA9B;;IAEMC,U;AASL,wBAA+C;AAAA,QAAnCC,GAAmC,uEAA7B;AAAEC,MAAAA,OAAO,EAAE,OAAO,EAAP,GAAY;AAAvB,KAA6B;;AAAA;;AAAA;;AAAA;;AAAA;;AAAA;;AAAA;;AAC9C,SAAKC,UAAL,GAAkB,IAAIJ,iBAAJ,CAAsB;AAAEG,MAAAA,OAAO,EAAED,GAAG,CAACC;AAAf,KAAtB,CAAlB;AACA;;;;WAED,mBAAUE,QAAV,EAAoB;AACnB,WAAKC,aAAL,GAAqBD,QAArB;AACA,aAAO,IAAP;AACA;;;WAED,kBAASA,QAAT,EAAmB;AAClB,WAAKE,SAAL,GAAiBF,QAAjB;AACA,aAAO,IAAP;AACA;;;WACD,iBAAQA,QAAR,EAAkB;AACjB,WAAKG,QAAL,GAAgBH,QAAhB;AACA,aAAO,IAAP;AACA;;;WACD,iBAAQA,QAAR,EAAkB;AACjB,WAAKI,QAAL,GAAgBJ,QAAhB;AACA,aAAO,IAAP;AACA;;;WAED,qBAAY;AACX,WAAKD,UAAL,CAAgBM,eAAhB;AACA;;;WACD,qBAAY;AACX,aAAO,CAAC,KAAKN,UAAL,CAAgBO,OAAhB,EAAR;AACA;;;WAED,gBAAO;AACN,UAAMC,SAAS,GAAG,KAAKR,UAAvB;AAEA,UAAMS,SAAS,GAAG,KAAKP,aAAL,EAAlB;AAEA,UAAMQ,OAAO,GAAG,KAAKL,QAArB;AACA,UAAMM,OAAO,GAAG,KAAKP,QAArB;AACA,UAAMQ,QAAQ,GAAG,KAAKT,SAAtB;AAEA,aAAOM,SAAS,CAACI,OAAV,CAAkB,YAAlB,uEAAgC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA,qBAEjCL,SAAS,CAACD,OAAV,EAFiC;AAAA;AAAA;AAAA;;AAAA,iDAELG,OAAO,EAFF;;AAAA;AAAA;AAAA,uBAIlB,IAAII,OAAJ,CAAY,UAACC,OAAD,EAAUC,MAAV,EAAqB;AACnDR,kBAAAA,SAAS,CAACF,eAAV;AACAK,kBAAAA,OAAO,CAAC,IAAD,CAAP;AACAC,kBAAAA,QAAQ,GACNK,IADF,CACO,UAACC,IAAD;AAAA,2BAAUH,OAAO,CAACG,IAAD,CAAjB;AAAA,mBADP,EAEEC,KAFF,CAEQ,UAACC,KAAD;AAAA,2BAAWJ,MAAM,CAACI,KAAD,CAAjB;AAAA,mBAFR;AAGA,iBANkB,CAJkB;;AAAA;AAI/BF,gBAAAA,IAJ+B;AAYrCP,gBAAAA,OAAO,CAACO,IAAD,CAAP;AACAV,gBAAAA,SAAS,CAACa,cAAV;AAbqC,iDAc9BX,OAAO,EAduB;;AAAA;AAAA;AAAA;AAgBrCF,gBAAAA,SAAS,CAACF,eAAV;AACAK,gBAAAA,OAAO,CAAC,IAAD,CAAP;AAjBqC;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OAAhC,GAAP;AAqBA;;;;;;AAGF,eAAed,UAAf","sourcesContent":["import ValidationChecker from \"./ValidationChecker\";\r\n\r\nclass DataLoader {\r\n\t$validator;\r\n\r\n\t$getProcessor;\r\n\r\n\t$loadData;\r\n\t$setData;\r\n\t$getData;\r\n\r\n\tconstructor(arg = { timeout: 1000 * 60 * 10 }) {\r\n\t\tthis.$validator = new ValidationChecker({ timeout: arg.timeout });\r\n\t}\r\n\r\n\tprocessor(callback) {\r\n\t\tthis.$getProcessor = callback;\r\n\t\treturn this;\r\n\t}\r\n\r\n\tloadData(callback) {\r\n\t\tthis.$loadData = callback;\r\n\t\treturn this;\r\n\t}\r\n\tsetData(callback) {\r\n\t\tthis.$setData = callback;\r\n\t\treturn this;\r\n\t}\r\n\tgetData(callback) {\r\n\t\tthis.$getData = callback;\r\n\t\treturn this;\r\n\t}\r\n\r\n\tdoTimeout() {\r\n\t\tthis.$validator.resetCheckpoint();\r\n\t}\r\n\tisTimeout() {\r\n\t\treturn !this.$validator.isValid();\r\n\t}\r\n\r\n\tdata() {\r\n\t\tconst validator = this.$validator;\r\n\r\n\t\tconst processor = this.$getProcessor();\r\n\r\n\t\tconst getData = this.$getData;\r\n\t\tconst setData = this.$setData;\r\n\t\tconst loadData = this.$loadData;\r\n\r\n\t\treturn processor.acquire(\"DataLoader\", async () => {\r\n\t\t\ttry {\r\n\t\t\t\tif (validator.isValid()) return getData();\r\n\r\n\t\t\t\tconst data = await new Promise((resolve, reject) => {\r\n\t\t\t\t\tvalidator.resetCheckpoint();\r\n\t\t\t\t\tsetData(null);\r\n\t\t\t\t\tloadData()\r\n\t\t\t\t\t\t.then((data) => resolve(data))\r\n\t\t\t\t\t\t.catch((error) => reject(error));\r\n\t\t\t\t});\r\n\r\n\t\t\t\tsetData(data);\r\n\t\t\t\tvalidator.makeCheckpoint();\r\n\t\t\t\treturn getData();\r\n\t\t\t} catch (error) {\r\n\t\t\t\tvalidator.resetCheckpoint();\r\n\t\t\t\tsetData(null);\r\n\t\t\t\tthrow error;\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n}\r\n\r\nexport default DataLoader;\r\n"]}]}