{"remainingRequest":"C:\\development\\freshnet-v2\\vue\\node_modules\\babel-loader\\lib\\index.js!C:\\development\\freshnet-v2\\vue\\src\\stores\\store.js","dependencies":[{"path":"C:\\development\\freshnet-v2\\vue\\src\\stores\\store.js","mtime":1662650937471},{"path":"C:\\development\\freshnet-v2\\vue\\babel.config.js","mtime":1662650914175},{"path":"C:\\development\\freshnet-v2\\vue\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1662650916242},{"path":"C:\\development\\freshnet-v2\\vue\\node_modules\\babel-loader\\lib\\index.js","mtime":1662650915901}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IFZ1ZSBmcm9tICJ2dWUiOwppbXBvcnQgVnVleCBmcm9tICJ2dWV4IjsKaW1wb3J0IHNvY2tldElvIGZyb20gInNvY2tldC5pby1jbGllbnQiOwppbXBvcnQgQXBpSG9zdCBmcm9tICIuLi9ob3N0L0FwaUhvc3QuanMiOwppbXBvcnQgU29ja2V0RGF0YSBmcm9tICIuLi8uLi8uLi9leHByZXNzL2RhdGFfc3RydWN0dXJlcy9Tb2NrZXREYXRhLmpzIjsKVnVlLnVzZShWdWV4KTsKZXhwb3J0IGRlZmF1bHQgewogIGluaXQ6IGZ1bmN0aW9uIGluaXQoU3RvcmVzKSB7CiAgICB2YXIgc3RvcmUgPSBuZXcgVnVleC5TdG9yZSh7CiAgICAgIHN0YXRlOiB7CiAgICAgICAgc29ja2V0OiBudWxsIC8vIGxpc3RlbmVyczogW10sCgogICAgICB9LAogICAgICBtdXRhdGlvbnM6IHsKICAgICAgICBzb2NrZXQ6IGZ1bmN0aW9uIHNvY2tldChzdGF0ZSwgX3NvY2tldCkgewogICAgICAgICAgcmV0dXJuIHN0YXRlLnNvY2tldCA9IF9zb2NrZXQ7CiAgICAgICAgfQogICAgICB9LAogICAgICBnZXR0ZXJzOiB7CiAgICAgICAgaXNDb25uZWN0ZWQ6IGZ1bmN0aW9uIGlzQ29ubmVjdGVkKHN0YXRlKSB7CiAgICAgICAgICByZXR1cm4gc3RhdGUuc29ja2V0ICYmIHN0YXRlLnNvY2tldC5jb25uZWN0ZWQ7CiAgICAgICAgfQogICAgICB9LAogICAgICBhY3Rpb25zOiB7CiAgICAgICAgb3BlblNvY2tldDogZnVuY3Rpb24gb3BlblNvY2tldChjb250ZXh0KSB7CiAgICAgICAgICBpZiAoY29udGV4dC5nZXR0ZXJzLmlzQ29ubmVjdGVkKSByZXR1cm47CiAgICAgICAgICB2YXIgc29ja2V0ID0gc29ja2V0SW8oQXBpSG9zdC5vcmlnaW4sIHsKICAgICAgICAgICAgZXh0cmFIZWFkZXJzOiB7CiAgICAgICAgICAgICAgYXV0aG9yaXphdGlvbjogd2luZG93LmxvY2FsU3RvcmFnZS5nZXRJdGVtKCJ1c2VyVG9rZW4iKQogICAgICAgICAgICB9CiAgICAgICAgICB9KTsgLy8gc29ja2V0Lm9uKCJjb25uZWN0X2Vycm9yIiwgKCkgPT4gY29uc29sZS5pbmZvKCJjb25uZWN0IGVycm9yIikpOwogICAgICAgICAgLy8gc29ja2V0Lm9uKCJjb25uZWN0IiwgKCkgPT4gY29uc29sZS5pbmZvKCJjb25uZWN0ZWQiKSk7CiAgICAgICAgICAvLyBzb2NrZXQub24oImRpc2Nvbm5lY3QiLCAocmVhc29uKSA9PiBjb25zb2xlLmluZm8oImRpc2Nvbm5lY3RlZCIpKTsKCiAgICAgICAgICBzb2NrZXQub24oImVtaXQiLCBmdW5jdGlvbiAoYm9keSkgewogICAgICAgICAgICB2YXIgX3JlZiA9IGJvZHkgPyBib2R5IDoge30sCiAgICAgICAgICAgICAgICBjb250ZW50ID0gX3JlZi5jb250ZW50LAogICAgICAgICAgICAgICAga2V5ID0gX3JlZi5rZXk7CgogICAgICAgICAgICB2YXIgZGF0YSA9IG5ldyBTb2NrZXREYXRhKGNvbnRlbnQsIGtleSk7CiAgICAgICAgICAgIGNvbnNvbGUubG9nKGRhdGEpOyAvLyBmb3IgKGxldCBsaXN0ZW5lciBvZiBzdG9yZS5zdGF0ZS5saXN0ZW5lcnMpIHsKICAgICAgICAgICAgLy8gICAgaWYgKGRhdGEua2V5ID09PSBsaXN0ZW5lci5rZXkpIHsKICAgICAgICAgICAgLy8gICAgICAgbGlzdGVuZXIudGVsbChkYXRhLmNvbnRlbnQpOwogICAgICAgICAgICAvLyAgICAgICByZXR1cm47CiAgICAgICAgICAgIC8vICAgIH0KICAgICAgICAgICAgLy8gICAgaWYgKCFsaXN0ZW5lci5rZXkgJiYgIWxpc3RlbmVyLmtleSkgewogICAgICAgICAgICAvLyAgICAgICBsaXN0ZW5lci50ZWxsKGRhdGEuY29udGVudCk7CiAgICAgICAgICAgIC8vICAgICAgIHJldHVybjsKICAgICAgICAgICAgLy8gICAgfQogICAgICAgICAgICAvLyB9CiAgICAgICAgICB9KTsKICAgICAgICAgIGNvbnRleHQuY29tbWl0KCJzb2NrZXQiLCBzb2NrZXQpOwogICAgICAgIH0sCiAgICAgICAgY2xvc2VTb2NrZXQ6IGZ1bmN0aW9uIGNsb3NlU29ja2V0KGNvbnRleHQpIHsKICAgICAgICAgIGlmICghY29udGV4dC5nZXR0ZXJzLmlzQ29ubmVjdGVkKSByZXR1cm47CiAgICAgICAgICB2YXIgc29ja2V0ID0gY29udGV4dC5zdGF0ZS5zb2NrZXQ7CiAgICAgICAgICBjb250ZXh0LmNvbW1pdCgic29ja2V0IiwgbnVsbCk7CiAgICAgICAgICBzb2NrZXQuY2xvc2UoKTsKICAgICAgICB9LAogICAgICAgIHJlc3RhcnRTb2NrZXQ6IGZ1bmN0aW9uIHJlc3RhcnRTb2NrZXQoY29udGV4dCkgewogICAgICAgICAgY29udGV4dC5kaXNwYXRjaCgiY2xvc2VTb2NrZXQiKTsKICAgICAgICAgIGNvbnRleHQuZGlzcGF0Y2goIm9wZW5Tb2NrZXQiKTsKICAgICAgICB9CiAgICAgIH0KICAgIH0pOwogICAgc3RvcmUuZGlzcGF0Y2goIm9wZW5Tb2NrZXQiKTsKICAgIHJldHVybiBzdG9yZTsKICB9Cn07"},{"version":3,"sources":["C:/development/freshnet-v2/vue/src/stores/store.js"],"names":["Vue","Vuex","socketIo","ApiHost","SocketData","use","init","Stores","store","Store","state","socket","mutations","getters","isConnected","connected","actions","openSocket","context","origin","extraHeaders","authorization","window","localStorage","getItem","on","body","content","key","data","console","log","commit","closeSocket","close","restartSocket","dispatch"],"mappings":"AAAA,OAAOA,GAAP,MAAgB,KAAhB;AACA,OAAOC,IAAP,MAAiB,MAAjB;AACA,OAAOC,QAAP,MAAqB,kBAArB;AACA,OAAOC,OAAP,MAAoB,oBAApB;AACA,OAAOC,UAAP,MAAuB,gDAAvB;AAEAJ,GAAG,CAACK,GAAJ,CAAQJ,IAAR;AAEA,eAAe;AACZK,EAAAA,IADY,gBACPC,MADO,EACC;AACV,QAAMC,KAAK,GAAG,IAAIP,IAAI,CAACQ,KAAT,CAAe;AAC1BC,MAAAA,KAAK,EAAE;AACJC,QAAAA,MAAM,EAAE,IADJ,CAEJ;;AAFI,OADmB;AAK1BC,MAAAA,SAAS,EAAE;AACRD,QAAAA,MAAM,EAAE,gBAACD,KAAD,EAAQC,OAAR;AAAA,iBAAoBD,KAAK,CAACC,MAAN,GAAeA,OAAnC;AAAA;AADA,OALe;AAQ1BE,MAAAA,OAAO,EAAE;AACNC,QAAAA,WAAW,EAAE,qBAACJ,KAAD;AAAA,iBAAWA,KAAK,CAACC,MAAN,IAAgBD,KAAK,CAACC,MAAN,CAAaI,SAAxC;AAAA;AADP,OARiB;AAW1BC,MAAAA,OAAO,EAAE;AACNC,QAAAA,UADM,sBACKC,OADL,EACc;AACjB,cAAIA,OAAO,CAACL,OAAR,CAAgBC,WAApB,EAAiC;AAEjC,cAAIH,MAAM,GAAGT,QAAQ,CAACC,OAAO,CAACgB,MAAT,EAAiB;AACnCC,YAAAA,YAAY,EAAE;AACXC,cAAAA,aAAa,EAAEC,MAAM,CAACC,YAAP,CAAoBC,OAApB,CAA4B,WAA5B;AADJ;AADqB,WAAjB,CAArB,CAHiB,CAQjB;AACA;AACA;;AACAb,UAAAA,MAAM,CAACc,EAAP,CAAU,MAAV,EAAkB,UAACC,IAAD,EAAU;AACzB,uBAAyBA,IAAI,GAAGA,IAAH,GAAU,EAAvC;AAAA,gBAAQC,OAAR,QAAQA,OAAR;AAAA,gBAAiBC,GAAjB,QAAiBA,GAAjB;;AACA,gBAAMC,IAAI,GAAG,IAAIzB,UAAJ,CAAeuB,OAAf,EAAwBC,GAAxB,CAAb;AAEAE,YAAAA,OAAO,CAACC,GAAR,CAAYF,IAAZ,EAJyB,CAMzB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACF,WAhBD;AAkBAX,UAAAA,OAAO,CAACc,MAAR,CAAe,QAAf,EAAyBrB,MAAzB;AACF,SA/BK;AAgCNsB,QAAAA,WAhCM,uBAgCMf,OAhCN,EAgCe;AAClB,cAAI,CAACA,OAAO,CAACL,OAAR,CAAgBC,WAArB,EAAkC;AAElC,cAAIH,MAAM,GAAGO,OAAO,CAACR,KAAR,CAAcC,MAA3B;AACAO,UAAAA,OAAO,CAACc,MAAR,CAAe,QAAf,EAAyB,IAAzB;AACArB,UAAAA,MAAM,CAACuB,KAAP;AACF,SAtCK;AAuCNC,QAAAA,aAvCM,yBAuCQjB,OAvCR,EAuCiB;AACpBA,UAAAA,OAAO,CAACkB,QAAR,CAAiB,aAAjB;AACAlB,UAAAA,OAAO,CAACkB,QAAR,CAAiB,YAAjB;AACF;AA1CK;AAXiB,KAAf,CAAd;AAyDA5B,IAAAA,KAAK,CAAC4B,QAAN,CAAe,YAAf;AAEA,WAAO5B,KAAP;AACF;AA9DW,CAAf","sourcesContent":["import Vue from \"vue\";\r\nimport Vuex from \"vuex\";\r\nimport socketIo from \"socket.io-client\";\r\nimport ApiHost from \"../host/ApiHost.js\";\r\nimport SocketData from \"../../../express/data_structures/SocketData.js\";\r\n\r\nVue.use(Vuex);\r\n\r\nexport default {\r\n   init(Stores) {\r\n      const store = new Vuex.Store({\r\n         state: {\r\n            socket: null,\r\n            // listeners: [],\r\n         },\r\n         mutations: {\r\n            socket: (state, socket) => (state.socket = socket),\r\n         },\r\n         getters: {\r\n            isConnected: (state) => state.socket && state.socket.connected,\r\n         },\r\n         actions: {\r\n            openSocket(context) {\r\n               if (context.getters.isConnected) return;\r\n\r\n               let socket = socketIo(ApiHost.origin, {\r\n                  extraHeaders: {\r\n                     authorization: window.localStorage.getItem(\"userToken\"),\r\n                  },\r\n               });\r\n               // socket.on(\"connect_error\", () => console.info(\"connect error\"));\r\n               // socket.on(\"connect\", () => console.info(\"connected\"));\r\n               // socket.on(\"disconnect\", (reason) => console.info(\"disconnected\"));\r\n               socket.on(\"emit\", (body) => {\r\n                  const { content, key } = body ? body : {};\r\n                  const data = new SocketData(content, key);\r\n\r\n                  console.log(data);\r\n\r\n                  // for (let listener of store.state.listeners) {\r\n                  //    if (data.key === listener.key) {\r\n                  //       listener.tell(data.content);\r\n                  //       return;\r\n                  //    }\r\n                  //    if (!listener.key && !listener.key) {\r\n                  //       listener.tell(data.content);\r\n                  //       return;\r\n                  //    }\r\n                  // }\r\n               });\r\n\r\n               context.commit(\"socket\", socket);\r\n            },\r\n            closeSocket(context) {\r\n               if (!context.getters.isConnected) return;\r\n\r\n               let socket = context.state.socket;\r\n               context.commit(\"socket\", null);\r\n               socket.close();\r\n            },\r\n            restartSocket(context) {\r\n               context.dispatch(\"closeSocket\");\r\n               context.dispatch(\"openSocket\");\r\n            },\r\n         },\r\n      });\r\n\r\n      store.dispatch(\"openSocket\");\r\n\r\n      return store;\r\n   },\r\n};\r\n"]}]}