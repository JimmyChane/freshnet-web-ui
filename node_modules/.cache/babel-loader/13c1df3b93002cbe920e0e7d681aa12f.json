{"remainingRequest":"C:\\development\\freshnet-v2\\vue\\node_modules\\thread-loader\\dist\\cjs.js!C:\\development\\freshnet-v2\\vue\\node_modules\\babel-loader\\lib\\index.js!C:\\development\\freshnet-v2\\vue\\src\\stores\\store.product.js","dependencies":[{"path":"C:\\development\\freshnet-v2\\vue\\src\\stores\\store.product.js","mtime":1663504444448},{"path":"C:\\development\\freshnet-v2\\vue\\babel.config.js","mtime":1662650914175},{"path":"C:\\development\\freshnet-v2\\vue\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1662650916242},{"path":"C:\\development\\freshnet-v2\\vue\\node_modules\\thread-loader\\dist\\cjs.js","mtime":1662650934417},{"path":"C:\\development\\freshnet-v2\\vue\\node_modules\\babel-loader\\lib\\index.js","mtime":1662650915901}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IF9hc3luY1RvR2VuZXJhdG9yIGZyb20gIkM6XFxkZXZlbG9wbWVudFxcZnJlc2huZXQtdjJcXHZ1ZVxcbm9kZV9tb2R1bGVzXFxAYmFiZWxcXHJ1bnRpbWVcXGhlbHBlcnNcXGVzbVxcYXN5bmNUb0dlbmVyYXRvci5qcyI7CmltcG9ydCAicmVnZW5lcmF0b3ItcnVudGltZS9ydW50aW1lLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMub2JqZWN0LnRvLXN0cmluZy5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLnN0cmluZy5pdGVyYXRvci5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL3dlYi5kb20tY29sbGVjdGlvbnMuaXRlcmF0b3IuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5hcnJheS5tYXAuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5hcnJheS5zb3J0LmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuZmluZC5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLmFycmF5LmZpbHRlci5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLnN5bWJvbC5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLnN5bWJvbC5kZXNjcmlwdGlvbi5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLnN0cmluZy50cmltLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuZnVuY3Rpb24ubmFtZS5qcyI7CmltcG9ydCBWdWV4IGZyb20gInZ1ZXgiOwppbXBvcnQgQXBpSG9zdCBmcm9tICJAL2hvc3QvQXBpSG9zdC5qcyI7CmltcG9ydCBEYXRhTG9hZGVyIGZyb20gIi4vY29tcG9uZW50cy9EYXRhTG9hZGVyIjsKaW1wb3J0IENvbGxlY3Rpb25VcGRhdGVyIGZyb20gIi4vY29tcG9uZW50cy9Db2xsZWN0aW9uVXBkYXRlciI7CmltcG9ydCBQcm9jZXNzb3IgZnJvbSAiLi9jb21wb25lbnRzL1Byb2Nlc3Nvci5qcyI7CmltcG9ydCBNb2R1bGVCdW5kbGUgZnJvbSAiLi4vLi4vLi4vZXhwcmVzcy9kYXRhX3N0cnVjdHVyZXMvUHJvZHVjdEJ1bmRsZS5qcyI7CmltcG9ydCBNb2R1bGVQcmljZSBmcm9tICIuLi8uLi8uLi9leHByZXNzL2RhdGFfc3RydWN0dXJlcy9Qcm9kdWN0UHJpY2UuanMiOwppbXBvcnQgTW9kdWxlQ2F0ZWdvcnkgZnJvbSAiLi4vLi4vLi4vZXhwcmVzcy9kYXRhX3N0cnVjdHVyZXMvQ2F0ZWdvcnkiOwppbXBvcnQgUHJvZHVjdCBmcm9tICIuLi9pdGVtcy9Qcm9kdWN0LmpzIjsKaW1wb3J0IFByb2R1Y3RQcmljZSBmcm9tICIuLi9pdGVtcy9Qcm9kdWN0UHJpY2UuanMiOwppbXBvcnQgUHJvZHVjdFNwZWNDb250ZW50IGZyb20gIi4uL2l0ZW1zL1Byb2R1Y3RTcGVjQ29udGVudC5qcyI7CmltcG9ydCBJbWFnZSBmcm9tICIuLi9pdGVtcy9JbWFnZS5qcyI7Cgp2YXIgY2F0Y2hFcnJvcldpdGhDb250ZXh0ID0gZnVuY3Rpb24gY2F0Y2hFcnJvcldpdGhDb250ZXh0KGNvbnRleHQsIGVycm9yKSB7CiAgY29uc29sZS5lcnJvcihlcnJvcik7CiAgdGhyb3cgZXJyb3I7Cn07CgpleHBvcnQgZGVmYXVsdCB7CiAgaW5pdDogZnVuY3Rpb24gaW5pdChTdG9yZXMpIHsKICAgIHZhciBjYXRlZ29yeVN0b3JlID0gU3RvcmVzLmNhdGVnb3J5OwogICAgdmFyIHByb2R1Y3RTdG9yZSA9IG5ldyBWdWV4LlN0b3JlKHsKICAgICAgc3RhdGU6IHsKICAgICAgICBkYXRhTG9hZGVyOiBuZXcgRGF0YUxvYWRlcih7CiAgICAgICAgICB0aW1lb3V0OiAxMDAwICogNjAgKiAxMAogICAgICAgIH0pIC8vIDEwbWluCiAgICAgICAgLnByb2Nlc3NvcihmdW5jdGlvbiAoKSB7CiAgICAgICAgICByZXR1cm4gcHJvZHVjdFN0b3JlLnN0YXRlLnByb2Nlc3NvcjsKICAgICAgICB9KS5sb2FkRGF0YSggLyojX19QVVJFX18qL19hc3luY1RvR2VuZXJhdG9yKCAvKiNfX1BVUkVfXyovcmVnZW5lcmF0b3JSdW50aW1lLm1hcmsoZnVuY3Rpb24gX2NhbGxlZSgpIHsKICAgICAgICAgIHZhciBhcGksIGVycm9yLCBjb250ZW50czsKICAgICAgICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUud3JhcChmdW5jdGlvbiBfY2FsbGVlJChfY29udGV4dCkgewogICAgICAgICAgICB3aGlsZSAoMSkgewogICAgICAgICAgICAgIHN3aXRjaCAoX2NvbnRleHQucHJldiA9IF9jb250ZXh0Lm5leHQpIHsKICAgICAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICAgICAgX2NvbnRleHQubmV4dCA9IDI7CiAgICAgICAgICAgICAgICAgIHJldHVybiBBcGlIb3N0LnJlcXVlc3QoKS51cmwoInByb2R1Y3R2Mi9saXN0LyIpLnNlbmQoKTsKCiAgICAgICAgICAgICAgICBjYXNlIDI6CiAgICAgICAgICAgICAgICAgIGFwaSA9IF9jb250ZXh0LnNlbnQ7CiAgICAgICAgICAgICAgICAgIGVycm9yID0gYXBpLmdldEVycm9yKCk7CiAgICAgICAgICAgICAgICAgIGNvbnRlbnRzID0gYXBpLmdldENvbnRlbnQoKTsKCiAgICAgICAgICAgICAgICAgIGlmICghZXJyb3IpIHsKICAgICAgICAgICAgICAgICAgICBfY29udGV4dC5uZXh0ID0gNzsKICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKGVycm9yKTsKCiAgICAgICAgICAgICAgICBjYXNlIDc6CiAgICAgICAgICAgICAgICAgIGlmIChBcnJheS5pc0FycmF5KGNvbnRlbnRzKSkgewogICAgICAgICAgICAgICAgICAgIF9jb250ZXh0Lm5leHQgPSA5OwogICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoImNvbnRlbnQgaXMgbm90IGFycmF5Iik7CgogICAgICAgICAgICAgICAgY2FzZSA5OgogICAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQuYWJydXB0KCJyZXR1cm4iLCBQcm9taXNlLmFsbChjb250ZW50cy5tYXAoZnVuY3Rpb24gKGNvbnRlbnQpIHsKICAgICAgICAgICAgICAgICAgICByZXR1cm4gUHJvZHVjdC5pbXBvcnREYXRhKGNvbnRlbnQpOwogICAgICAgICAgICAgICAgICB9KSkpOwoKICAgICAgICAgICAgICAgIGNhc2UgMTA6CiAgICAgICAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQuc3RvcCgpOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgfSwgX2NhbGxlZSk7CiAgICAgICAgfSkpKS5zZXREYXRhKGZ1bmN0aW9uIChkYXRhKSB7CiAgICAgICAgICByZXR1cm4gcHJvZHVjdFN0b3JlLmNvbW1pdCgiaXRlbXMiLCBBcnJheS5pc0FycmF5KGRhdGEpID8gZGF0YSA6IFtdKTsKICAgICAgICB9KS5nZXREYXRhKGZ1bmN0aW9uICgpIHsKICAgICAgICAgIHJldHVybiBwcm9kdWN0U3RvcmUuZ2V0dGVycy5pdGVtczsKICAgICAgICB9KSwKICAgICAgICBpdGVtczogW10sCiAgICAgICAgcHJvY2Vzc29yOiBuZXcgUHJvY2Vzc29yKCkKICAgICAgfSwKICAgICAgbXV0YXRpb25zOiB7CiAgICAgICAgaXRlbXM6IGZ1bmN0aW9uIGl0ZW1zKHN0YXRlLCBfaXRlbXMpIHsKICAgICAgICAgIHJldHVybiBzdGF0ZS5pdGVtcyA9IF9pdGVtczsKICAgICAgICB9CiAgICAgIH0sCiAgICAgIGdldHRlcnM6IHsKICAgICAgICBpc0xvYWRpbmc6IGZ1bmN0aW9uIGlzTG9hZGluZyhzdGF0ZSkgewogICAgICAgICAgcmV0dXJuIHN0YXRlLnByb2Nlc3Nvci5pc0xvYWRpbmcoKTsKICAgICAgICB9LAogICAgICAgIGl0ZW1zOiBmdW5jdGlvbiBpdGVtcyhzdGF0ZSkgewogICAgICAgICAgcmV0dXJuIHN0YXRlLml0ZW1zLnNvcnQoZnVuY3Rpb24gKHByb2R1Y3QxLCBwcm9kdWN0MikgewogICAgICAgICAgICByZXR1cm4gcHJvZHVjdDEuY29tcGFyZShwcm9kdWN0Mik7CiAgICAgICAgICB9KTsKICAgICAgICB9CiAgICAgIH0sCiAgICAgIGFjdGlvbnM6IHsKICAgICAgICByZWZyZXNoOiBmdW5jdGlvbiByZWZyZXNoKGNvbnRleHQpIHsKICAgICAgICAgIHJldHVybiBfYXN5bmNUb0dlbmVyYXRvciggLyojX19QVVJFX18qL3JlZ2VuZXJhdG9yUnVudGltZS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWUzKCkgewogICAgICAgICAgICByZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLndyYXAoZnVuY3Rpb24gX2NhbGxlZTMkKF9jb250ZXh0MykgewogICAgICAgICAgICAgIHdoaWxlICgxKSB7CiAgICAgICAgICAgICAgICBzd2l0Y2ggKF9jb250ZXh0My5wcmV2ID0gX2NvbnRleHQzLm5leHQpIHsKICAgICAgICAgICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDMuYWJydXB0KCJyZXR1cm4iLCBjb250ZXh0LnN0YXRlLnByb2Nlc3Nvci5hY3F1aXJlKCJyZWZyZXNoIiwgLyojX19QVVJFX18qL19hc3luY1RvR2VuZXJhdG9yKCAvKiNfX1BVUkVfXyovcmVnZW5lcmF0b3JSdW50aW1lLm1hcmsoZnVuY3Rpb24gX2NhbGxlZTIoKSB7CiAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLndyYXAoZnVuY3Rpb24gX2NhbGxlZTIkKF9jb250ZXh0MikgewogICAgICAgICAgICAgICAgICAgICAgICB3aGlsZSAoMSkgewogICAgICAgICAgICAgICAgICAgICAgICAgIHN3aXRjaCAoX2NvbnRleHQyLnByZXYgPSBfY29udGV4dDIubmV4dCkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb250ZXh0LnN0YXRlLmRhdGFMb2FkZXIuZG9UaW1lb3V0KCk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9jb250ZXh0Mi5uZXh0ID0gMzsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGNvbnRleHQuZGlzcGF0Y2goImdldEl0ZW1zIik7CgogICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAzOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0Mi5zdG9wKCk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICB9LCBfY2FsbGVlMik7CiAgICAgICAgICAgICAgICAgICAgfSkpKSk7CgogICAgICAgICAgICAgICAgICBjYXNlIDE6CiAgICAgICAgICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0My5zdG9wKCk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9LCBfY2FsbGVlMyk7CiAgICAgICAgICB9KSkoKTsKICAgICAgICB9LAogICAgICAgIGdldEl0ZW1zOiBmdW5jdGlvbiBnZXRJdGVtcyhjb250ZXh0KSB7CiAgICAgICAgICByZXR1cm4gX2FzeW5jVG9HZW5lcmF0b3IoIC8qI19fUFVSRV9fKi9yZWdlbmVyYXRvclJ1bnRpbWUubWFyayhmdW5jdGlvbiBfY2FsbGVlNSgpIHsKICAgICAgICAgICAgcmV0dXJuIHJlZ2VuZXJhdG9yUnVudGltZS53cmFwKGZ1bmN0aW9uIF9jYWxsZWU1JChfY29udGV4dDUpIHsKICAgICAgICAgICAgICB3aGlsZSAoMSkgewogICAgICAgICAgICAgICAgc3dpdGNoIChfY29udGV4dDUucHJldiA9IF9jb250ZXh0NS5uZXh0KSB7CiAgICAgICAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQ1LmFicnVwdCgicmV0dXJuIiwgY29udGV4dC5zdGF0ZS5wcm9jZXNzb3IuYWNxdWlyZSgiZ2V0SXRlbXMiLCAvKiNfX1BVUkVfXyovX2FzeW5jVG9HZW5lcmF0b3IoIC8qI19fUFVSRV9fKi9yZWdlbmVyYXRvclJ1bnRpbWUubWFyayhmdW5jdGlvbiBfY2FsbGVlNCgpIHsKICAgICAgICAgICAgICAgICAgICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUud3JhcChmdW5jdGlvbiBfY2FsbGVlNCQoX2NvbnRleHQ0KSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHdoaWxlICgxKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgc3dpdGNoIChfY29udGV4dDQucHJldiA9IF9jb250ZXh0NC5uZXh0KSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDQuYWJydXB0KCJyZXR1cm4iLCBjb250ZXh0LnN0YXRlLmRhdGFMb2FkZXIuZGF0YSgpKTsKCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDE6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQ0LnN0b3AoKTsKICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgIH0sIF9jYWxsZWU0KTsKICAgICAgICAgICAgICAgICAgICB9KSkpKTsKCiAgICAgICAgICAgICAgICAgIGNhc2UgMToKICAgICAgICAgICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQ1LnN0b3AoKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0sIF9jYWxsZWU1KTsKICAgICAgICAgIH0pKSgpOwogICAgICAgIH0sCiAgICAgICAgZ2V0SXRlbU9mSWQ6IGZ1bmN0aW9uIGdldEl0ZW1PZklkKGNvbnRleHQpIHsKICAgICAgICAgIHZhciBfYXJndW1lbnRzID0gYXJndW1lbnRzOwogICAgICAgICAgcmV0dXJuIF9hc3luY1RvR2VuZXJhdG9yKCAvKiNfX1BVUkVfXyovcmVnZW5lcmF0b3JSdW50aW1lLm1hcmsoZnVuY3Rpb24gX2NhbGxlZTcoKSB7CiAgICAgICAgICAgIHZhciBhcmc7CiAgICAgICAgICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUud3JhcChmdW5jdGlvbiBfY2FsbGVlNyQoX2NvbnRleHQ3KSB7CiAgICAgICAgICAgICAgd2hpbGUgKDEpIHsKICAgICAgICAgICAgICAgIHN3aXRjaCAoX2NvbnRleHQ3LnByZXYgPSBfY29udGV4dDcubmV4dCkgewogICAgICAgICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgICAgICAgYXJnID0gX2FyZ3VtZW50cy5sZW5ndGggPiAxICYmIF9hcmd1bWVudHNbMV0gIT09IHVuZGVmaW5lZCA/IF9hcmd1bWVudHNbMV0gOiB7CiAgICAgICAgICAgICAgICAgICAgICBpZDogaWQKICAgICAgICAgICAgICAgICAgICB9OwogICAgICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDcuYWJydXB0KCJyZXR1cm4iLCBjb250ZXh0LnN0YXRlLnByb2Nlc3Nvci5hY3F1aXJlKCJnZXRJdGVtT2ZJZCIsIC8qI19fUFVSRV9fKi9fYXN5bmNUb0dlbmVyYXRvciggLyojX19QVVJFX18qL3JlZ2VuZXJhdG9yUnVudGltZS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWU2KCkgewogICAgICAgICAgICAgICAgICAgICAgdmFyIGlkLCBpdGVtcywgaXRlbTsKICAgICAgICAgICAgICAgICAgICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUud3JhcChmdW5jdGlvbiBfY2FsbGVlNiQoX2NvbnRleHQ2KSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHdoaWxlICgxKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgc3dpdGNoIChfY29udGV4dDYucHJldiA9IF9jb250ZXh0Ni5uZXh0KSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlkID0gYXJnLmlkOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfY29udGV4dDYubmV4dCA9IDM7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBjb250ZXh0LmRpc3BhdGNoKCJnZXRJdGVtcyIpOwoKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgMzoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaXRlbXMgPSBfY29udGV4dDYuc2VudDsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaXRlbSA9IGl0ZW1zLmZpbmQoZnVuY3Rpb24gKGl0ZW0pIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gaXRlbS5nZXRJZCgpID09PSBpZDsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7CgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoaXRlbSkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9jb250ZXh0Ni5uZXh0ID0gMTA7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9jb250ZXh0Ni5uZXh0ID0gODsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGNvbnRleHQuZGlzcGF0Y2goInJlZnJlc2hJdGVtcyIpOwoKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgODoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaXRlbXMgPSBfY29udGV4dDYuc2VudDsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaXRlbSA9IGl0ZW1zLmZpbmQoZnVuY3Rpb24gKGl0ZW0pIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gaXRlbS5nZXRJZCgpID09PSBpZDsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7CgogICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAxMDoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0Ni5hYnJ1cHQoInJldHVybiIsIGl0ZW0pOwoKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgMTE6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQ2LnN0b3AoKTsKICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgIH0sIF9jYWxsZWU2KTsKICAgICAgICAgICAgICAgICAgICB9KSkpKTsKCiAgICAgICAgICAgICAgICAgIGNhc2UgMjoKICAgICAgICAgICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQ3LnN0b3AoKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0sIF9jYWxsZWU3KTsKICAgICAgICAgIH0pKSgpOwogICAgICAgIH0sCiAgICAgICAgYWRkSXRlbTogZnVuY3Rpb24gYWRkSXRlbShjb250ZXh0KSB7CiAgICAgICAgICB2YXIgX2FyZ3VtZW50czIgPSBhcmd1bWVudHM7CiAgICAgICAgICByZXR1cm4gX2FzeW5jVG9HZW5lcmF0b3IoIC8qI19fUFVSRV9fKi9yZWdlbmVyYXRvclJ1bnRpbWUubWFyayhmdW5jdGlvbiBfY2FsbGVlOSgpIHsKICAgICAgICAgICAgdmFyIGFyZzsKICAgICAgICAgICAgcmV0dXJuIHJlZ2VuZXJhdG9yUnVudGltZS53cmFwKGZ1bmN0aW9uIF9jYWxsZWU5JChfY29udGV4dDkpIHsKICAgICAgICAgICAgICB3aGlsZSAoMSkgewogICAgICAgICAgICAgICAgc3dpdGNoIChfY29udGV4dDkucHJldiA9IF9jb250ZXh0OS5uZXh0KSB7CiAgICAgICAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICAgICAgICBhcmcgPSBfYXJndW1lbnRzMi5sZW5ndGggPiAxICYmIF9hcmd1bWVudHMyWzFdICE9PSB1bmRlZmluZWQgPyBfYXJndW1lbnRzMlsxXSA6IHsKICAgICAgICAgICAgICAgICAgICAgIGRhdGE6IGRhdGEKICAgICAgICAgICAgICAgICAgICB9OwogICAgICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDkuYWJydXB0KCJyZXR1cm4iLCBjb250ZXh0LnN0YXRlLnByb2Nlc3Nvci5hY3F1aXJlKCJhZGRJdGVtIiwgLyojX19QVVJFX18qL19hc3luY1RvR2VuZXJhdG9yKCAvKiNfX1BVUkVfXyovcmVnZW5lcmF0b3JSdW50aW1lLm1hcmsoZnVuY3Rpb24gX2NhbGxlZTgoKSB7CiAgICAgICAgICAgICAgICAgICAgICB2YXIgZGF0YSwgYXBpLCBlcnJvciwgY29udGVudCwgcHJvZHVjdE5ldywgaXRlbTsKICAgICAgICAgICAgICAgICAgICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUud3JhcChmdW5jdGlvbiBfY2FsbGVlOCQoX2NvbnRleHQ4KSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHdoaWxlICgxKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgc3dpdGNoIChfY29udGV4dDgucHJldiA9IF9jb250ZXh0OC5uZXh0KSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRhdGEgPSBhcmcuZGF0YTsKCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChkYXRhKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgX2NvbnRleHQ4Lm5leHQgPSAzOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoImRhdGEgbm90IHZhbGlkIik7CgogICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAzOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfY29udGV4dDgubmV4dCA9IDU7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBBcGlIb3N0LnJlcXVlc3QoKS5QT1NUKCkudXJsKCJwcm9kdWN0djIvIikuYm9keSh7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29udGVudDogZGF0YQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KS5zZW5kKCk7CgogICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSA1OgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhcGkgPSBfY29udGV4dDguc2VudDsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZXJyb3IgPSBhcGkuZ2V0RXJyb3IoKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29udGVudCA9IGFwaS5nZXRDb250ZW50KCk7CgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoIWVycm9yKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgX2NvbnRleHQ4Lm5leHQgPSAxMDsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKGVycm9yKTsKCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDEwOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfY29udGV4dDgubmV4dCA9IDEyOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gUHJvZHVjdC5pbXBvcnREYXRhKGNvbnRlbnQpOwoKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgMTI6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHByb2R1Y3ROZXcgPSBfY29udGV4dDguc2VudDsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaXRlbSA9IG5ldyBDb2xsZWN0aW9uVXBkYXRlcihjb250ZXh0KS5vbklkKGZ1bmN0aW9uIChpdGVtKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGl0ZW0uZ2V0SWQoKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSkuZ2V0SXRlbShwcm9kdWN0TmV3KTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0OC5hYnJ1cHQoInJldHVybiIsIGl0ZW0pOwoKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgMTU6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQ4LnN0b3AoKTsKICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgIH0sIF9jYWxsZWU4KTsKICAgICAgICAgICAgICAgICAgICB9KSkpLmNhdGNoKGZ1bmN0aW9uIChlcnJvcikgewogICAgICAgICAgICAgICAgICAgICAgY2F0Y2hFcnJvcldpdGhDb250ZXh0KGNvbnRleHQsIGVycm9yKTsKICAgICAgICAgICAgICAgICAgICB9KSk7CgogICAgICAgICAgICAgICAgICBjYXNlIDI6CiAgICAgICAgICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0OS5zdG9wKCk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9LCBfY2FsbGVlOSk7CiAgICAgICAgICB9KSkoKTsKICAgICAgICB9LAogICAgICAgIHJlbW92ZUl0ZW1PZklkOiBmdW5jdGlvbiByZW1vdmVJdGVtT2ZJZChjb250ZXh0KSB7CiAgICAgICAgICB2YXIgX2FyZ3VtZW50czMgPSBhcmd1bWVudHM7CiAgICAgICAgICByZXR1cm4gX2FzeW5jVG9HZW5lcmF0b3IoIC8qI19fUFVSRV9fKi9yZWdlbmVyYXRvclJ1bnRpbWUubWFyayhmdW5jdGlvbiBfY2FsbGVlMTEoKSB7CiAgICAgICAgICAgIHZhciBhcmc7CiAgICAgICAgICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUud3JhcChmdW5jdGlvbiBfY2FsbGVlMTEkKF9jb250ZXh0MTEpIHsKICAgICAgICAgICAgICB3aGlsZSAoMSkgewogICAgICAgICAgICAgICAgc3dpdGNoIChfY29udGV4dDExLnByZXYgPSBfY29udGV4dDExLm5leHQpIHsKICAgICAgICAgICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICAgICAgICAgIGFyZyA9IF9hcmd1bWVudHMzLmxlbmd0aCA+IDEgJiYgX2FyZ3VtZW50czNbMV0gIT09IHVuZGVmaW5lZCA/IF9hcmd1bWVudHMzWzFdIDogewogICAgICAgICAgICAgICAgICAgICAgaWQ6IGlkCiAgICAgICAgICAgICAgICAgICAgfTsKICAgICAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQxMS5hYnJ1cHQoInJldHVybiIsIGNvbnRleHQuc3RhdGUucHJvY2Vzc29yLmFjcXVpcmUoInJlbW92ZUl0ZW1PZklkIiwgLyojX19QVVJFX18qL19hc3luY1RvR2VuZXJhdG9yKCAvKiNfX1BVUkVfXyovcmVnZW5lcmF0b3JSdW50aW1lLm1hcmsoZnVuY3Rpb24gX2NhbGxlZTEwKCkgewogICAgICAgICAgICAgICAgICAgICAgdmFyIGlkLCBhcGksIGVycm9yLCBpdGVtczsKICAgICAgICAgICAgICAgICAgICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUud3JhcChmdW5jdGlvbiBfY2FsbGVlMTAkKF9jb250ZXh0MTApIHsKICAgICAgICAgICAgICAgICAgICAgICAgd2hpbGUgKDEpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICBzd2l0Y2ggKF9jb250ZXh0MTAucHJldiA9IF9jb250ZXh0MTAubmV4dCkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZCA9IGFyZy5pZDsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgX2NvbnRleHQxMC5uZXh0ID0gMzsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIEFwaUhvc3QucmVxdWVzdCgpLkRFTEVURSgpLnVybCgicHJvZHVjdHYyL2lkLyIuY29uY2F0KGlkKSkuYm9keSh7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWQ6IGlkCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pLnNlbmQoKTsKCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDM6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFwaSA9IF9jb250ZXh0MTAuc2VudDsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZXJyb3IgPSBhcGkuZ2V0RXJyb3IoKTsKCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICghZXJyb3IpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfY29udGV4dDEwLm5leHQgPSA3OwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoZXJyb3IpOwoKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgNzoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaXRlbXMgPSBjb250ZXh0LnN0YXRlLml0ZW1zLmZpbHRlcihmdW5jdGlvbiAoaXRlbSkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBpdGVtLmdldElkKCkgIT09IGlkOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29udGV4dC5jb21taXQoIml0ZW1zIiwgaXRlbXMpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQxMC5hYnJ1cHQoInJldHVybiIsIHRydWUpOwoKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgMTA6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQxMC5zdG9wKCk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICB9LCBfY2FsbGVlMTApOwogICAgICAgICAgICAgICAgICAgIH0pKSkpOwoKICAgICAgICAgICAgICAgICAgY2FzZSAyOgogICAgICAgICAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDExLnN0b3AoKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0sIF9jYWxsZWUxMSk7CiAgICAgICAgICB9KSkoKTsKICAgICAgICB9LAogICAgICAgIG9uVXBkYXRlSXRlbTogZnVuY3Rpb24gb25VcGRhdGVJdGVtKGNvbnRleHQpIHsKICAgICAgICAgIHZhciBfYXJndW1lbnRzNCA9IGFyZ3VtZW50czsKICAgICAgICAgIHJldHVybiBfYXN5bmNUb0dlbmVyYXRvciggLyojX19QVVJFX18qL3JlZ2VuZXJhdG9yUnVudGltZS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWUxMygpIHsKICAgICAgICAgICAgdmFyIGFyZzsKICAgICAgICAgICAgcmV0dXJuIHJlZ2VuZXJhdG9yUnVudGltZS53cmFwKGZ1bmN0aW9uIF9jYWxsZWUxMyQoX2NvbnRleHQxMykgewogICAgICAgICAgICAgIHdoaWxlICgxKSB7CiAgICAgICAgICAgICAgICBzd2l0Y2ggKF9jb250ZXh0MTMucHJldiA9IF9jb250ZXh0MTMubmV4dCkgewogICAgICAgICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgICAgICAgYXJnID0gX2FyZ3VtZW50czQubGVuZ3RoID4gMSAmJiBfYXJndW1lbnRzNFsxXSAhPT0gdW5kZWZpbmVkID8gX2FyZ3VtZW50czRbMV0gOiB7CiAgICAgICAgICAgICAgICAgICAgICBpZDogaWQsCiAgICAgICAgICAgICAgICAgICAgICBjYWxsYmFjazogY2FsbGJhY2sKICAgICAgICAgICAgICAgICAgICB9OwogICAgICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDEzLmFicnVwdCgicmV0dXJuIiwgY29udGV4dC5zdGF0ZS5wcm9jZXNzb3IuYWNxdWlyZSgib25VcGRhdGVJdGVtIiwgLyojX19QVVJFX18qL19hc3luY1RvR2VuZXJhdG9yKCAvKiNfX1BVUkVfXyovcmVnZW5lcmF0b3JSdW50aW1lLm1hcmsoZnVuY3Rpb24gX2NhbGxlZTEyKCkgewogICAgICAgICAgICAgICAgICAgICAgdmFyIGlkLCBjYWxsYmFjaywgaXRlbTsKICAgICAgICAgICAgICAgICAgICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUud3JhcChmdW5jdGlvbiBfY2FsbGVlMTIkKF9jb250ZXh0MTIpIHsKICAgICAgICAgICAgICAgICAgICAgICAgd2hpbGUgKDEpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICBzd2l0Y2ggKF9jb250ZXh0MTIucHJldiA9IF9jb250ZXh0MTIubmV4dCkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZCA9IGFyZy5pZCwgY2FsbGJhY2sgPSBhcmcuY2FsbGJhY2s7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9jb250ZXh0MTIubmV4dCA9IDM7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBjb250ZXh0LmRpc3BhdGNoKCJnZXRJdGVtT2ZJZCIsIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZDogaWQKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7CgogICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAzOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpdGVtID0gX2NvbnRleHQxMi5zZW50OwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoaXRlbSkgY2FsbGJhY2soaXRlbSk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDEyLmFicnVwdCgicmV0dXJuIiwgaXRlbSk7CgogICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSA2OgogICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0MTIuc3RvcCgpOwogICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgfSwgX2NhbGxlZTEyKTsKICAgICAgICAgICAgICAgICAgICB9KSkpKTsKCiAgICAgICAgICAgICAgICAgIGNhc2UgMjoKICAgICAgICAgICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQxMy5zdG9wKCk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9LCBfY2FsbGVlMTMpOwogICAgICAgICAgfSkpKCk7CiAgICAgICAgfSwKICAgICAgICB1cGRhdGVUaXRsZU9mSWQ6IGZ1bmN0aW9uIHVwZGF0ZVRpdGxlT2ZJZChjb250ZXh0KSB7CiAgICAgICAgICB2YXIgX2FyZ3VtZW50czUgPSBhcmd1bWVudHM7CiAgICAgICAgICByZXR1cm4gX2FzeW5jVG9HZW5lcmF0b3IoIC8qI19fUFVSRV9fKi9yZWdlbmVyYXRvclJ1bnRpbWUubWFyayhmdW5jdGlvbiBfY2FsbGVlMTUoKSB7CiAgICAgICAgICAgIHZhciBhcmc7CiAgICAgICAgICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUud3JhcChmdW5jdGlvbiBfY2FsbGVlMTUkKF9jb250ZXh0MTUpIHsKICAgICAgICAgICAgICB3aGlsZSAoMSkgewogICAgICAgICAgICAgICAgc3dpdGNoIChfY29udGV4dDE1LnByZXYgPSBfY29udGV4dDE1Lm5leHQpIHsKICAgICAgICAgICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICAgICAgICAgIGFyZyA9IF9hcmd1bWVudHM1Lmxlbmd0aCA+IDEgJiYgX2FyZ3VtZW50czVbMV0gIT09IHVuZGVmaW5lZCA/IF9hcmd1bWVudHM1WzFdIDogewogICAgICAgICAgICAgICAgICAgICAgaWQ6IGlkLAogICAgICAgICAgICAgICAgICAgICAgdGl0bGU6IHRpdGxlCiAgICAgICAgICAgICAgICAgICAgfTsKICAgICAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQxNS5hYnJ1cHQoInJldHVybiIsIGNvbnRleHQuc3RhdGUucHJvY2Vzc29yLmFjcXVpcmUoInVwZGF0ZVRpdGxlT2ZJZCIsIC8qI19fUFVSRV9fKi9fYXN5bmNUb0dlbmVyYXRvciggLyojX19QVVJFX18qL3JlZ2VuZXJhdG9yUnVudGltZS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWUxNCgpIHsKICAgICAgICAgICAgICAgICAgICAgIHZhciBpZCwgdGl0bGUsIGFwaSwgZXJyb3IsIGNvbnRlbnQsIGl0ZW07CiAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLndyYXAoZnVuY3Rpb24gX2NhbGxlZTE0JChfY29udGV4dDE0KSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHdoaWxlICgxKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgc3dpdGNoIChfY29udGV4dDE0LnByZXYgPSBfY29udGV4dDE0Lm5leHQpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWQgPSBhcmcuaWQsIHRpdGxlID0gYXJnLnRpdGxlOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfY29udGV4dDE0Lm5leHQgPSAzOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gQXBpSG9zdC5yZXF1ZXN0KCkuUFVUKCkudXJsKCJwcm9kdWN0djIvdGl0bGUvIikuYm9keSh7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29udGVudDogewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcHJvZHVjdElkOiBpZCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRpdGxlOiB0aXRsZQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSkuc2VuZCgpOwoKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgMzoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYXBpID0gX2NvbnRleHQxNC5zZW50OwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlcnJvciA9IGFwaS5nZXRFcnJvcigpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb250ZW50ID0gYXBpLmdldENvbnRlbnQoKTsKCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICghZXJyb3IpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfY29udGV4dDE0Lm5leHQgPSA4OwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoZXJyb3IpOwoKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgODoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgX2NvbnRleHQxNC5uZXh0ID0gMTA7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBjb250ZXh0LmRpc3BhdGNoKCJvblVwZGF0ZUl0ZW0iLCB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWQ6IGNvbnRlbnQucHJvZHVjdElkLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhbGxiYWNrOiBmdW5jdGlvbiBjYWxsYmFjayhpdGVtKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gaXRlbS5zZXRUaXRsZShjb250ZW50LnRpdGxlKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pOwoKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgMTA6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGl0ZW0gPSBfY29udGV4dDE0LnNlbnQ7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDE0LmFicnVwdCgicmV0dXJuIiwgaXRlbSk7CgogICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAxMjoKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDE0LnN0b3AoKTsKICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgIH0sIF9jYWxsZWUxNCk7CiAgICAgICAgICAgICAgICAgICAgfSkpKSk7CgogICAgICAgICAgICAgICAgICBjYXNlIDI6CiAgICAgICAgICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0MTUuc3RvcCgpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSwgX2NhbGxlZTE1KTsKICAgICAgICAgIH0pKSgpOwogICAgICAgIH0sCiAgICAgICAgdXBkYXRlRGVzY3JpcHRpb25PZklkOiBmdW5jdGlvbiB1cGRhdGVEZXNjcmlwdGlvbk9mSWQoY29udGV4dCkgewogICAgICAgICAgdmFyIF9hcmd1bWVudHM2ID0gYXJndW1lbnRzOwogICAgICAgICAgcmV0dXJuIF9hc3luY1RvR2VuZXJhdG9yKCAvKiNfX1BVUkVfXyovcmVnZW5lcmF0b3JSdW50aW1lLm1hcmsoZnVuY3Rpb24gX2NhbGxlZTE3KCkgewogICAgICAgICAgICB2YXIgYXJnOwogICAgICAgICAgICByZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLndyYXAoZnVuY3Rpb24gX2NhbGxlZTE3JChfY29udGV4dDE3KSB7CiAgICAgICAgICAgICAgd2hpbGUgKDEpIHsKICAgICAgICAgICAgICAgIHN3aXRjaCAoX2NvbnRleHQxNy5wcmV2ID0gX2NvbnRleHQxNy5uZXh0KSB7CiAgICAgICAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICAgICAgICBhcmcgPSBfYXJndW1lbnRzNi5sZW5ndGggPiAxICYmIF9hcmd1bWVudHM2WzFdICE9PSB1bmRlZmluZWQgPyBfYXJndW1lbnRzNlsxXSA6IHsKICAgICAgICAgICAgICAgICAgICAgIGlkOiBpZCwKICAgICAgICAgICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBkZXNjcmlwdGlvbgogICAgICAgICAgICAgICAgICAgIH07CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0MTcuYWJydXB0KCJyZXR1cm4iLCBjb250ZXh0LnN0YXRlLnByb2Nlc3Nvci5hY3F1aXJlKCJ1cGRhdGVEZXNjcmlwdGlvbk9mSWQiLCAvKiNfX1BVUkVfXyovX2FzeW5jVG9HZW5lcmF0b3IoIC8qI19fUFVSRV9fKi9yZWdlbmVyYXRvclJ1bnRpbWUubWFyayhmdW5jdGlvbiBfY2FsbGVlMTYoKSB7CiAgICAgICAgICAgICAgICAgICAgICB2YXIgaWQsIGRlc2NyaXB0aW9uLCBhcGksIGVycm9yLCBjb250ZW50LCBpdGVtOwogICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHJlZ2VuZXJhdG9yUnVudGltZS53cmFwKGZ1bmN0aW9uIF9jYWxsZWUxNiQoX2NvbnRleHQxNikgewogICAgICAgICAgICAgICAgICAgICAgICB3aGlsZSAoMSkgewogICAgICAgICAgICAgICAgICAgICAgICAgIHN3aXRjaCAoX2NvbnRleHQxNi5wcmV2ID0gX2NvbnRleHQxNi5uZXh0KSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlkID0gYXJnLmlkLCBkZXNjcmlwdGlvbiA9IGFyZy5kZXNjcmlwdGlvbjsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgX2NvbnRleHQxNi5uZXh0ID0gMzsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIEFwaUhvc3QucmVxdWVzdCgpLlBVVCgpLnVybCgicHJvZHVjdHYyL2Rlc2NyaXB0aW9uLyIpLmJvZHkoewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRlbnQ6IHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHByb2R1Y3RJZDogaWQsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogZGVzY3JpcHRpb24KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pLnNlbmQoKTsKCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDM6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFwaSA9IF9jb250ZXh0MTYuc2VudDsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZXJyb3IgPSBhcGkuZ2V0RXJyb3IoKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29udGVudCA9IGFwaS5nZXRDb250ZW50KCk7CgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoIWVycm9yKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgX2NvbnRleHQxNi5uZXh0ID0gODsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKGVycm9yKTsKCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDg6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9jb250ZXh0MTYubmV4dCA9IDEwOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gY29udGV4dC5kaXNwYXRjaCgib25VcGRhdGVJdGVtIiwgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlkOiBjb250ZW50LnByb2R1Y3RJZCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYWxsYmFjazogZnVuY3Rpb24gY2FsbGJhY2soaXRlbSkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaXRlbS5zZXREZXNjcmlwdGlvbihjb250ZW50LmRlc2NyaXB0aW9uKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pOwoKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgMTA6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGl0ZW0gPSBfY29udGV4dDE2LnNlbnQ7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDE2LmFicnVwdCgicmV0dXJuIiwgaXRlbSk7CgogICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAxMjoKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDE2LnN0b3AoKTsKICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgIH0sIF9jYWxsZWUxNik7CiAgICAgICAgICAgICAgICAgICAgfSkpKSk7CgogICAgICAgICAgICAgICAgICBjYXNlIDI6CiAgICAgICAgICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0MTcuc3RvcCgpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSwgX2NhbGxlZTE3KTsKICAgICAgICAgIH0pKSgpOwogICAgICAgIH0sCiAgICAgICAgdXBkYXRlQnJhbmRJZE9mSWQ6IGZ1bmN0aW9uIHVwZGF0ZUJyYW5kSWRPZklkKGNvbnRleHQpIHsKICAgICAgICAgIHZhciBfYXJndW1lbnRzNyA9IGFyZ3VtZW50czsKICAgICAgICAgIHJldHVybiBfYXN5bmNUb0dlbmVyYXRvciggLyojX19QVVJFX18qL3JlZ2VuZXJhdG9yUnVudGltZS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWUxOSgpIHsKICAgICAgICAgICAgdmFyIGFyZzsKICAgICAgICAgICAgcmV0dXJuIHJlZ2VuZXJhdG9yUnVudGltZS53cmFwKGZ1bmN0aW9uIF9jYWxsZWUxOSQoX2NvbnRleHQxOSkgewogICAgICAgICAgICAgIHdoaWxlICgxKSB7CiAgICAgICAgICAgICAgICBzd2l0Y2ggKF9jb250ZXh0MTkucHJldiA9IF9jb250ZXh0MTkubmV4dCkgewogICAgICAgICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgICAgICAgYXJnID0gX2FyZ3VtZW50czcubGVuZ3RoID4gMSAmJiBfYXJndW1lbnRzN1sxXSAhPT0gdW5kZWZpbmVkID8gX2FyZ3VtZW50czdbMV0gOiB7CiAgICAgICAgICAgICAgICAgICAgICBpZDogaWQsCiAgICAgICAgICAgICAgICAgICAgICBicmFuZElkOiBicmFuZElkCiAgICAgICAgICAgICAgICAgICAgfTsKICAgICAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQxOS5hYnJ1cHQoInJldHVybiIsIGNvbnRleHQuc3RhdGUucHJvY2Vzc29yLmFjcXVpcmUoInVwZGF0ZUJyYW5kSWRPZklkIiwgLyojX19QVVJFX18qL19hc3luY1RvR2VuZXJhdG9yKCAvKiNfX1BVUkVfXyovcmVnZW5lcmF0b3JSdW50aW1lLm1hcmsoZnVuY3Rpb24gX2NhbGxlZTE4KCkgewogICAgICAgICAgICAgICAgICAgICAgdmFyIGlkLCBicmFuZElkLCBhcGksIGVycm9yLCBjb250ZW50LCBpdGVtOwogICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHJlZ2VuZXJhdG9yUnVudGltZS53cmFwKGZ1bmN0aW9uIF9jYWxsZWUxOCQoX2NvbnRleHQxOCkgewogICAgICAgICAgICAgICAgICAgICAgICB3aGlsZSAoMSkgewogICAgICAgICAgICAgICAgICAgICAgICAgIHN3aXRjaCAoX2NvbnRleHQxOC5wcmV2ID0gX2NvbnRleHQxOC5uZXh0KSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlkID0gYXJnLmlkLCBicmFuZElkID0gYXJnLmJyYW5kSWQ7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9jb250ZXh0MTgubmV4dCA9IDM7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBBcGlIb3N0LnJlcXVlc3QoKS5QVVQoKS51cmwoInByb2R1Y3R2Mi9icmFuZElkLyIpLmJvZHkoewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRlbnQ6IHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHByb2R1Y3RJZDogaWQsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmFuZElkOiBicmFuZElkCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KS5zZW5kKCk7CgogICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAzOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhcGkgPSBfY29udGV4dDE4LnNlbnQ7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVycm9yID0gYXBpLmdldEVycm9yKCk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRlbnQgPSBhcGkuZ2V0Q29udGVudCgpOwoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFlcnJvcikgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9jb250ZXh0MTgubmV4dCA9IDg7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihlcnJvcik7CgogICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSA4OgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfY29udGV4dDE4Lm5leHQgPSAxMDsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGNvbnRleHQuZGlzcGF0Y2goIm9uVXBkYXRlSXRlbSIsIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZDogY29udGVudC5wcm9kdWN0SWQsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FsbGJhY2s6IGZ1bmN0aW9uIGNhbGxiYWNrKGl0ZW0pIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBpdGVtLnNldEJyYW5kSWQoY29udGVudC5icmFuZElkKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pOwoKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgMTA6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGl0ZW0gPSBfY29udGV4dDE4LnNlbnQ7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDE4LmFicnVwdCgicmV0dXJuIiwgaXRlbSk7CgogICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAxMjoKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDE4LnN0b3AoKTsKICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgIH0sIF9jYWxsZWUxOCk7CiAgICAgICAgICAgICAgICAgICAgfSkpKSk7CgogICAgICAgICAgICAgICAgICBjYXNlIDI6CiAgICAgICAgICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0MTkuc3RvcCgpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSwgX2NhbGxlZTE5KTsKICAgICAgICAgIH0pKSgpOwogICAgICAgIH0sCiAgICAgICAgdXBkYXRlQ2F0ZWdvcnlJZE9mSWQ6IGZ1bmN0aW9uIHVwZGF0ZUNhdGVnb3J5SWRPZklkKGNvbnRleHQpIHsKICAgICAgICAgIHZhciBfYXJndW1lbnRzOCA9IGFyZ3VtZW50czsKICAgICAgICAgIHJldHVybiBfYXN5bmNUb0dlbmVyYXRvciggLyojX19QVVJFX18qL3JlZ2VuZXJhdG9yUnVudGltZS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWUyMSgpIHsKICAgICAgICAgICAgdmFyIGFyZzsKICAgICAgICAgICAgcmV0dXJuIHJlZ2VuZXJhdG9yUnVudGltZS53cmFwKGZ1bmN0aW9uIF9jYWxsZWUyMSQoX2NvbnRleHQyMSkgewogICAgICAgICAgICAgIHdoaWxlICgxKSB7CiAgICAgICAgICAgICAgICBzd2l0Y2ggKF9jb250ZXh0MjEucHJldiA9IF9jb250ZXh0MjEubmV4dCkgewogICAgICAgICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgICAgICAgYXJnID0gX2FyZ3VtZW50czgubGVuZ3RoID4gMSAmJiBfYXJndW1lbnRzOFsxXSAhPT0gdW5kZWZpbmVkID8gX2FyZ3VtZW50czhbMV0gOiB7CiAgICAgICAgICAgICAgICAgICAgICBpZDogaWQsCiAgICAgICAgICAgICAgICAgICAgICBjYXRlZ29yeUlkOiBjYXRlZ29yeUlkCiAgICAgICAgICAgICAgICAgICAgfTsKICAgICAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQyMS5hYnJ1cHQoInJldHVybiIsIGNvbnRleHQuc3RhdGUucHJvY2Vzc29yLmFjcXVpcmUoInVwZGF0ZUNhdGVnb3J5SWRPZklkIiwgLyojX19QVVJFX18qL19hc3luY1RvR2VuZXJhdG9yKCAvKiNfX1BVUkVfXyovcmVnZW5lcmF0b3JSdW50aW1lLm1hcmsoZnVuY3Rpb24gX2NhbGxlZTIwKCkgewogICAgICAgICAgICAgICAgICAgICAgdmFyIGlkLCBjYXRlZ29yeUlkLCBhcGksIGVycm9yLCBjb250ZW50LCBpdGVtOwogICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHJlZ2VuZXJhdG9yUnVudGltZS53cmFwKGZ1bmN0aW9uIF9jYWxsZWUyMCQoX2NvbnRleHQyMCkgewogICAgICAgICAgICAgICAgICAgICAgICB3aGlsZSAoMSkgewogICAgICAgICAgICAgICAgICAgICAgICAgIHN3aXRjaCAoX2NvbnRleHQyMC5wcmV2ID0gX2NvbnRleHQyMC5uZXh0KSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlkID0gYXJnLmlkLCBjYXRlZ29yeUlkID0gYXJnLmNhdGVnb3J5SWQ7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9jb250ZXh0MjAubmV4dCA9IDM7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBBcGlIb3N0LnJlcXVlc3QoKS5QVVQoKS51cmwoInByb2R1Y3R2Mi9jYXRlZ29yeUlkLyIpLmJvZHkoewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRlbnQ6IHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHByb2R1Y3RJZDogaWQsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXRlZ29yeUlkOiBjYXRlZ29yeUlkCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KS5zZW5kKCk7CgogICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAzOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhcGkgPSBfY29udGV4dDIwLnNlbnQ7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVycm9yID0gYXBpLmdldEVycm9yKCk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRlbnQgPSBhcGkuZ2V0Q29udGVudCgpOwoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFlcnJvcikgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9jb250ZXh0MjAubmV4dCA9IDg7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihlcnJvcik7CgogICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSA4OgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfY29udGV4dDIwLm5leHQgPSAxMDsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGNvbnRleHQuZGlzcGF0Y2goIm9uVXBkYXRlSXRlbSIsIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZDogY29udGVudC5wcm9kdWN0SWQsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FsbGJhY2s6IGZ1bmN0aW9uIGNhbGxiYWNrKGl0ZW0pIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBpdGVtLnNldENhdGVnb3J5SWQoY29udGVudC5jYXRlZ29yeUlkKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pOwoKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgMTA6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGl0ZW0gPSBfY29udGV4dDIwLnNlbnQ7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDIwLmFicnVwdCgicmV0dXJuIiwgaXRlbSk7CgogICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAxMjoKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDIwLnN0b3AoKTsKICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgIH0sIF9jYWxsZWUyMCk7CiAgICAgICAgICAgICAgICAgICAgfSkpKSk7CgogICAgICAgICAgICAgICAgICBjYXNlIDI6CiAgICAgICAgICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0MjEuc3RvcCgpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSwgX2NhbGxlZTIxKTsKICAgICAgICAgIH0pKSgpOwogICAgICAgIH0sCiAgICAgICAgdXBkYXRlQXZhaWxhYmlsaXR5T2ZJZDogZnVuY3Rpb24gdXBkYXRlQXZhaWxhYmlsaXR5T2ZJZChjb250ZXh0KSB7CiAgICAgICAgICB2YXIgX2FyZ3VtZW50czkgPSBhcmd1bWVudHM7CiAgICAgICAgICByZXR1cm4gX2FzeW5jVG9HZW5lcmF0b3IoIC8qI19fUFVSRV9fKi9yZWdlbmVyYXRvclJ1bnRpbWUubWFyayhmdW5jdGlvbiBfY2FsbGVlMjMoKSB7CiAgICAgICAgICAgIHZhciBhcmc7CiAgICAgICAgICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUud3JhcChmdW5jdGlvbiBfY2FsbGVlMjMkKF9jb250ZXh0MjMpIHsKICAgICAgICAgICAgICB3aGlsZSAoMSkgewogICAgICAgICAgICAgICAgc3dpdGNoIChfY29udGV4dDIzLnByZXYgPSBfY29udGV4dDIzLm5leHQpIHsKICAgICAgICAgICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICAgICAgICAgIGFyZyA9IF9hcmd1bWVudHM5Lmxlbmd0aCA+IDEgJiYgX2FyZ3VtZW50czlbMV0gIT09IHVuZGVmaW5lZCA/IF9hcmd1bWVudHM5WzFdIDogewogICAgICAgICAgICAgICAgICAgICAgaWQ6IGlkLAogICAgICAgICAgICAgICAgICAgICAgaXNBdmFpbGFibGU6IGlzQXZhaWxhYmxlCiAgICAgICAgICAgICAgICAgICAgfTsKICAgICAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQyMy5hYnJ1cHQoInJldHVybiIsIGNvbnRleHQuc3RhdGUucHJvY2Vzc29yLmFjcXVpcmUoInVwZGF0ZUF2YWlsYWJpbGl0eU9mSWQiLCAvKiNfX1BVUkVfXyovX2FzeW5jVG9HZW5lcmF0b3IoIC8qI19fUFVSRV9fKi9yZWdlbmVyYXRvclJ1bnRpbWUubWFyayhmdW5jdGlvbiBfY2FsbGVlMjIoKSB7CiAgICAgICAgICAgICAgICAgICAgICB2YXIgaWQsIGlzQXZhaWxhYmxlLCBhcGksIGVycm9yLCBjb250ZW50LCBpdGVtOwogICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHJlZ2VuZXJhdG9yUnVudGltZS53cmFwKGZ1bmN0aW9uIF9jYWxsZWUyMiQoX2NvbnRleHQyMikgewogICAgICAgICAgICAgICAgICAgICAgICB3aGlsZSAoMSkgewogICAgICAgICAgICAgICAgICAgICAgICAgIHN3aXRjaCAoX2NvbnRleHQyMi5wcmV2ID0gX2NvbnRleHQyMi5uZXh0KSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlkID0gYXJnLmlkLCBpc0F2YWlsYWJsZSA9IGFyZy5pc0F2YWlsYWJsZTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgX2NvbnRleHQyMi5uZXh0ID0gMzsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIEFwaUhvc3QucmVxdWVzdCgpLlBVVCgpLnVybCgicHJvZHVjdHYyL2lzQXZhaWxhYmxlLyIpLmJvZHkoewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRlbnQ6IHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHByb2R1Y3RJZDogaWQsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpc0F2YWlsYWJsZTogaXNBdmFpbGFibGUKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pLnNlbmQoKTsKCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDM6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFwaSA9IF9jb250ZXh0MjIuc2VudDsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZXJyb3IgPSBhcGkuZ2V0RXJyb3IoKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29udGVudCA9IGFwaS5nZXRDb250ZW50KCk7CgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoIWVycm9yKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgX2NvbnRleHQyMi5uZXh0ID0gODsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKGVycm9yKTsKCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDg6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9jb250ZXh0MjIubmV4dCA9IDEwOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gY29udGV4dC5kaXNwYXRjaCgib25VcGRhdGVJdGVtIiwgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlkOiBjb250ZW50LnByb2R1Y3RJZCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYWxsYmFjazogZnVuY3Rpb24gY2FsbGJhY2soaXRlbSkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaXRlbS5zdG9jay5pc0F2YWlsYWJsZSA9IGNvbnRlbnQuaXNBdmFpbGFibGU7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTsKCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDEwOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpdGVtID0gX2NvbnRleHQyMi5zZW50OwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQyMi5hYnJ1cHQoInJldHVybiIsIGl0ZW0pOwoKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgMTI6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQyMi5zdG9wKCk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICB9LCBfY2FsbGVlMjIpOwogICAgICAgICAgICAgICAgICAgIH0pKSkpOwoKICAgICAgICAgICAgICAgICAgY2FzZSAyOgogICAgICAgICAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDIzLnN0b3AoKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0sIF9jYWxsZWUyMyk7CiAgICAgICAgICB9KSkoKTsKICAgICAgICB9LAogICAgICAgIHVwZGF0ZVNlY29uZEhhbmRPZklkOiBmdW5jdGlvbiB1cGRhdGVTZWNvbmRIYW5kT2ZJZChjb250ZXh0KSB7CiAgICAgICAgICB2YXIgX2FyZ3VtZW50czEwID0gYXJndW1lbnRzOwogICAgICAgICAgcmV0dXJuIF9hc3luY1RvR2VuZXJhdG9yKCAvKiNfX1BVUkVfXyovcmVnZW5lcmF0b3JSdW50aW1lLm1hcmsoZnVuY3Rpb24gX2NhbGxlZTI1KCkgewogICAgICAgICAgICB2YXIgYXJnOwogICAgICAgICAgICByZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLndyYXAoZnVuY3Rpb24gX2NhbGxlZTI1JChfY29udGV4dDI1KSB7CiAgICAgICAgICAgICAgd2hpbGUgKDEpIHsKICAgICAgICAgICAgICAgIHN3aXRjaCAoX2NvbnRleHQyNS5wcmV2ID0gX2NvbnRleHQyNS5uZXh0KSB7CiAgICAgICAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICAgICAgICBhcmcgPSBfYXJndW1lbnRzMTAubGVuZ3RoID4gMSAmJiBfYXJndW1lbnRzMTBbMV0gIT09IHVuZGVmaW5lZCA/IF9hcmd1bWVudHMxMFsxXSA6IHsKICAgICAgICAgICAgICAgICAgICAgIGlkOiBpZCwKICAgICAgICAgICAgICAgICAgICAgIGlzU2Vjb25kSGFuZDogaXNTZWNvbmRIYW5kCiAgICAgICAgICAgICAgICAgICAgfTsKICAgICAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQyNS5hYnJ1cHQoInJldHVybiIsIGNvbnRleHQuc3RhdGUucHJvY2Vzc29yLmFjcXVpcmUoInVwZGF0ZVNlY29uZEhhbmRPZklkIiwgLyojX19QVVJFX18qL19hc3luY1RvR2VuZXJhdG9yKCAvKiNfX1BVUkVfXyovcmVnZW5lcmF0b3JSdW50aW1lLm1hcmsoZnVuY3Rpb24gX2NhbGxlZTI0KCkgewogICAgICAgICAgICAgICAgICAgICAgdmFyIGlkLCBpc1NlY29uZEhhbmQsIGFwaSwgZXJyb3IsIGNvbnRlbnQsIGl0ZW07CiAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLndyYXAoZnVuY3Rpb24gX2NhbGxlZTI0JChfY29udGV4dDI0KSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHdoaWxlICgxKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgc3dpdGNoIChfY29udGV4dDI0LnByZXYgPSBfY29udGV4dDI0Lm5leHQpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWQgPSBhcmcuaWQsIGlzU2Vjb25kSGFuZCA9IGFyZy5pc1NlY29uZEhhbmQ7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9jb250ZXh0MjQubmV4dCA9IDM7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBBcGlIb3N0LnJlcXVlc3QoKS5QVVQoKS51cmwoInByb2R1Y3R2Mi9pc1NlY29uZEhhbmQvIikuYm9keSh7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29udGVudDogewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcHJvZHVjdElkOiBpZCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlzU2Vjb25kSGFuZDogaXNTZWNvbmRIYW5kCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KS5zZW5kKCk7CgogICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAzOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhcGkgPSBfY29udGV4dDI0LnNlbnQ7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVycm9yID0gYXBpLmdldEVycm9yKCk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRlbnQgPSBhcGkuZ2V0Q29udGVudCgpOwoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFlcnJvcikgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9jb250ZXh0MjQubmV4dCA9IDg7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihlcnJvcik7CgogICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSA4OgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfY29udGV4dDI0Lm5leHQgPSAxMDsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGNvbnRleHQuZGlzcGF0Y2goIm9uVXBkYXRlSXRlbSIsIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZDogY29udGVudC5wcm9kdWN0SWQsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FsbGJhY2s6IGZ1bmN0aW9uIGNhbGxiYWNrKGl0ZW0pIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGl0ZW0uc3RvY2suaXNTZWNvbmRIYW5kID0gY29udGVudC5pc1NlY29uZEhhbmQ7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTsKCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDEwOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpdGVtID0gX2NvbnRleHQyNC5zZW50OwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQyNC5hYnJ1cHQoInJldHVybiIsIGl0ZW0pOwoKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgMTI6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQyNC5zdG9wKCk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICB9LCBfY2FsbGVlMjQpOwogICAgICAgICAgICAgICAgICAgIH0pKSkpOwoKICAgICAgICAgICAgICAgICAgY2FzZSAyOgogICAgICAgICAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDI1LnN0b3AoKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0sIF9jYWxsZWUyNSk7CiAgICAgICAgICB9KSkoKTsKICAgICAgICB9LAogICAgICAgIHVwZGF0ZVByaWNlT2ZJZDogZnVuY3Rpb24gdXBkYXRlUHJpY2VPZklkKGNvbnRleHQpIHsKICAgICAgICAgIHZhciBfYXJndW1lbnRzMTEgPSBhcmd1bWVudHM7CiAgICAgICAgICByZXR1cm4gX2FzeW5jVG9HZW5lcmF0b3IoIC8qI19fUFVSRV9fKi9yZWdlbmVyYXRvclJ1bnRpbWUubWFyayhmdW5jdGlvbiBfY2FsbGVlMjcoKSB7CiAgICAgICAgICAgIHZhciBhcmc7CiAgICAgICAgICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUud3JhcChmdW5jdGlvbiBfY2FsbGVlMjckKF9jb250ZXh0MjcpIHsKICAgICAgICAgICAgICB3aGlsZSAoMSkgewogICAgICAgICAgICAgICAgc3dpdGNoIChfY29udGV4dDI3LnByZXYgPSBfY29udGV4dDI3Lm5leHQpIHsKICAgICAgICAgICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICAgICAgICAgIGFyZyA9IF9hcmd1bWVudHMxMS5sZW5ndGggPiAxICYmIF9hcmd1bWVudHMxMVsxXSAhPT0gdW5kZWZpbmVkID8gX2FyZ3VtZW50czExWzFdIDogewogICAgICAgICAgICAgICAgICAgICAgaWQ6IGlkLAogICAgICAgICAgICAgICAgICAgICAgcHJpY2U6IHByaWNlCiAgICAgICAgICAgICAgICAgICAgfTsKICAgICAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQyNy5hYnJ1cHQoInJldHVybiIsIGNvbnRleHQuc3RhdGUucHJvY2Vzc29yLmFjcXVpcmUoInVwZGF0ZVByaWNlT2ZJZCIsIC8qI19fUFVSRV9fKi9fYXN5bmNUb0dlbmVyYXRvciggLyojX19QVVJFX18qL3JlZ2VuZXJhdG9yUnVudGltZS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWUyNigpIHsKICAgICAgICAgICAgICAgICAgICAgIHZhciBpZCwgcHJpY2UsIGFwaSwgZXJyb3IsIGNvbnRlbnQsIGl0ZW07CiAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLndyYXAoZnVuY3Rpb24gX2NhbGxlZTI2JChfY29udGV4dDI2KSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHdoaWxlICgxKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgc3dpdGNoIChfY29udGV4dDI2LnByZXYgPSBfY29udGV4dDI2Lm5leHQpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWQgPSBhcmcuaWQsIHByaWNlID0gYXJnLnByaWNlOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwcmljZSA9IE1vZHVsZVByaWNlLnRyaW0ocHJpY2UpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfY29udGV4dDI2Lm5leHQgPSA0OwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gQXBpSG9zdC5yZXF1ZXN0KCkuUFVUKCkudXJsKCJwcm9kdWN0djIvcHJpY2UvIikuYm9keSh7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29udGVudDogewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcHJvZHVjdElkOiBpZCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHByaWNlOiBwcmljZQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSkuc2VuZCgpOwoKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgNDoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYXBpID0gX2NvbnRleHQyNi5zZW50OwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlcnJvciA9IGFwaS5nZXRFcnJvcigpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb250ZW50ID0gYXBpLmdldENvbnRlbnQoKTsKCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICghZXJyb3IpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfY29udGV4dDI2Lm5leHQgPSA5OwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoZXJyb3IpOwoKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgOToKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgX2NvbnRleHQyNi5uZXh0ID0gMTE7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBjb250ZXh0LmRpc3BhdGNoKCJvblVwZGF0ZUl0ZW0iLCB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWQ6IGNvbnRlbnQucHJvZHVjdElkLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhbGxiYWNrOiBmdW5jdGlvbiBjYWxsYmFjayhpdGVtKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpdGVtLnNldFByaWNlKHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbm9ybWFsOiBQcm9kdWN0UHJpY2UucGFyc2VTdHJpbmcoY29udGVudC5wcmljZS5ub3JtYWwpLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwcm9tb3Rpb246IFByb2R1Y3RQcmljZS5wYXJzZVN0cmluZyhjb250ZW50LnByaWNlLnByb21vdGlvbikKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7CgogICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAxMToKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaXRlbSA9IF9jb250ZXh0MjYuc2VudDsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0MjYuYWJydXB0KCJyZXR1cm4iLCBpdGVtKTsKCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDEzOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0MjYuc3RvcCgpOwogICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgfSwgX2NhbGxlZTI2KTsKICAgICAgICAgICAgICAgICAgICB9KSkpKTsKCiAgICAgICAgICAgICAgICAgIGNhc2UgMjoKICAgICAgICAgICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQyNy5zdG9wKCk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9LCBfY2FsbGVlMjcpOwogICAgICAgICAgfSkpKCk7CiAgICAgICAgfSwKICAgICAgICBhZGRCdW5kbGVPZklkOiBmdW5jdGlvbiBhZGRCdW5kbGVPZklkKGNvbnRleHQpIHsKICAgICAgICAgIHZhciBfYXJndW1lbnRzMTIgPSBhcmd1bWVudHM7CiAgICAgICAgICByZXR1cm4gX2FzeW5jVG9HZW5lcmF0b3IoIC8qI19fUFVSRV9fKi9yZWdlbmVyYXRvclJ1bnRpbWUubWFyayhmdW5jdGlvbiBfY2FsbGVlMjkoKSB7CiAgICAgICAgICAgIHZhciBhcmc7CiAgICAgICAgICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUud3JhcChmdW5jdGlvbiBfY2FsbGVlMjkkKF9jb250ZXh0MjkpIHsKICAgICAgICAgICAgICB3aGlsZSAoMSkgewogICAgICAgICAgICAgICAgc3dpdGNoIChfY29udGV4dDI5LnByZXYgPSBfY29udGV4dDI5Lm5leHQpIHsKICAgICAgICAgICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICAgICAgICAgIGFyZyA9IF9hcmd1bWVudHMxMi5sZW5ndGggPiAxICYmIF9hcmd1bWVudHMxMlsxXSAhPT0gdW5kZWZpbmVkID8gX2FyZ3VtZW50czEyWzFdIDogewogICAgICAgICAgICAgICAgICAgICAgaWQ6IGlkLAogICAgICAgICAgICAgICAgICAgICAgYnVuZGxlOiBidW5kbGUKICAgICAgICAgICAgICAgICAgICB9OwogICAgICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDI5LmFicnVwdCgicmV0dXJuIiwgY29udGV4dC5zdGF0ZS5wcm9jZXNzb3IuYWNxdWlyZSgiYWRkQnVuZGxlT2ZJZCIsIC8qI19fUFVSRV9fKi9fYXN5bmNUb0dlbmVyYXRvciggLyojX19QVVJFX18qL3JlZ2VuZXJhdG9yUnVudGltZS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWUyOCgpIHsKICAgICAgICAgICAgICAgICAgICAgIHZhciBpZCwgYnVuZGxlLCBhcGksIGVycm9yLCBjb250ZW50LCBpdGVtOwogICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHJlZ2VuZXJhdG9yUnVudGltZS53cmFwKGZ1bmN0aW9uIF9jYWxsZWUyOCQoX2NvbnRleHQyOCkgewogICAgICAgICAgICAgICAgICAgICAgICB3aGlsZSAoMSkgewogICAgICAgICAgICAgICAgICAgICAgICAgIHN3aXRjaCAoX2NvbnRleHQyOC5wcmV2ID0gX2NvbnRleHQyOC5uZXh0KSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlkID0gYXJnLmlkLCBidW5kbGUgPSBhcmcuYnVuZGxlOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfY29udGV4dDI4Lm5leHQgPSAzOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gQXBpSG9zdC5yZXF1ZXN0KCkuUE9TVCgpLnVybCgicHJvZHVjdHYyL2J1bmRsZS8iKS5ib2R5KHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb250ZW50OiB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwcm9kdWN0SWQ6IGlkLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnVuZGxlOiBidW5kbGUKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pLnNlbmQoKTsKCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDM6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFwaSA9IF9jb250ZXh0Mjguc2VudDsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZXJyb3IgPSBhcGkuZ2V0RXJyb3IoKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29udGVudCA9IGFwaS5nZXRDb250ZW50KCk7CgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoIWVycm9yKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgX2NvbnRleHQyOC5uZXh0ID0gODsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKGVycm9yKTsKCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDg6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9jb250ZXh0MjgubmV4dCA9IDEwOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gY29udGV4dC5kaXNwYXRjaCgib25VcGRhdGVJdGVtIiwgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlkOiBjb250ZW50LnByb2R1Y3RJZCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYWxsYmFjazogZnVuY3Rpb24gY2FsbGJhY2soaXRlbSkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaXRlbS5hZGRCdW5kbGUoTW9kdWxlQnVuZGxlLnRyaW0oY29udGVudC5idW5kbGUpKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pOwoKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgMTA6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGl0ZW0gPSBfY29udGV4dDI4LnNlbnQ7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDI4LmFicnVwdCgicmV0dXJuIiwgaXRlbSk7CgogICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAxMjoKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDI4LnN0b3AoKTsKICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgIH0sIF9jYWxsZWUyOCk7CiAgICAgICAgICAgICAgICAgICAgfSkpKSk7CgogICAgICAgICAgICAgICAgICBjYXNlIDI6CiAgICAgICAgICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0Mjkuc3RvcCgpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSwgX2NhbGxlZTI5KTsKICAgICAgICAgIH0pKSgpOwogICAgICAgIH0sCiAgICAgICAgcmVtb3ZlQnVuZGxlT2ZJZDogZnVuY3Rpb24gcmVtb3ZlQnVuZGxlT2ZJZChjb250ZXh0KSB7CiAgICAgICAgICB2YXIgX2FyZ3VtZW50czEzID0gYXJndW1lbnRzOwogICAgICAgICAgcmV0dXJuIF9hc3luY1RvR2VuZXJhdG9yKCAvKiNfX1BVUkVfXyovcmVnZW5lcmF0b3JSdW50aW1lLm1hcmsoZnVuY3Rpb24gX2NhbGxlZTMxKCkgewogICAgICAgICAgICB2YXIgYXJnOwogICAgICAgICAgICByZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLndyYXAoZnVuY3Rpb24gX2NhbGxlZTMxJChfY29udGV4dDMxKSB7CiAgICAgICAgICAgICAgd2hpbGUgKDEpIHsKICAgICAgICAgICAgICAgIHN3aXRjaCAoX2NvbnRleHQzMS5wcmV2ID0gX2NvbnRleHQzMS5uZXh0KSB7CiAgICAgICAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICAgICAgICBhcmcgPSBfYXJndW1lbnRzMTMubGVuZ3RoID4gMSAmJiBfYXJndW1lbnRzMTNbMV0gIT09IHVuZGVmaW5lZCA/IF9hcmd1bWVudHMxM1sxXSA6IHsKICAgICAgICAgICAgICAgICAgICAgIGlkOiBpZCwKICAgICAgICAgICAgICAgICAgICAgIGJ1bmRsZTogYnVuZGxlCiAgICAgICAgICAgICAgICAgICAgfTsKICAgICAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQzMS5hYnJ1cHQoInJldHVybiIsIGNvbnRleHQuc3RhdGUucHJvY2Vzc29yLmFjcXVpcmUoInJlbW92ZUJ1bmRsZU9mSWQiLCAvKiNfX1BVUkVfXyovX2FzeW5jVG9HZW5lcmF0b3IoIC8qI19fUFVSRV9fKi9yZWdlbmVyYXRvclJ1bnRpbWUubWFyayhmdW5jdGlvbiBfY2FsbGVlMzAoKSB7CiAgICAgICAgICAgICAgICAgICAgICB2YXIgaWQsIGJ1bmRsZSwgYXBpLCBlcnJvciwgY29udGVudCwgaXRlbTsKICAgICAgICAgICAgICAgICAgICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUud3JhcChmdW5jdGlvbiBfY2FsbGVlMzAkKF9jb250ZXh0MzApIHsKICAgICAgICAgICAgICAgICAgICAgICAgd2hpbGUgKDEpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICBzd2l0Y2ggKF9jb250ZXh0MzAucHJldiA9IF9jb250ZXh0MzAubmV4dCkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZCA9IGFyZy5pZCwgYnVuZGxlID0gYXJnLmJ1bmRsZTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgX2NvbnRleHQzMC5uZXh0ID0gMzsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIEFwaUhvc3QucmVxdWVzdCgpLkRFTEVURSgpLnVybCgicHJvZHVjdHYyL2J1bmRsZS8iKS5ib2R5KHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb250ZW50OiB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwcm9kdWN0SWQ6IGlkLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnVuZGxlOiBNb2R1bGVCdW5kbGUudHJpbShidW5kbGUpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KS5zZW5kKCk7CgogICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAzOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhcGkgPSBfY29udGV4dDMwLnNlbnQ7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVycm9yID0gYXBpLmdldEVycm9yKCk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRlbnQgPSBhcGkuZ2V0Q29udGVudCgpOwoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFlcnJvcikgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9jb250ZXh0MzAubmV4dCA9IDg7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihlcnJvcik7CgogICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSA4OgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfY29udGV4dDMwLm5leHQgPSAxMDsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGNvbnRleHQuZGlzcGF0Y2goIm9uVXBkYXRlSXRlbSIsIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZDogY29udGVudC5wcm9kdWN0SWQsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FsbGJhY2s6IGZ1bmN0aW9uIGNhbGxiYWNrKGl0ZW0pIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBpdGVtLnJlbW92ZUJ1bmRsZShjb250ZW50LmJ1bmRsZSk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTsKCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDEwOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpdGVtID0gX2NvbnRleHQzMC5zZW50OwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQzMC5hYnJ1cHQoInJldHVybiIsIGl0ZW0pOwoKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgMTI6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQzMC5zdG9wKCk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICB9LCBfY2FsbGVlMzApOwogICAgICAgICAgICAgICAgICAgIH0pKSkpOwoKICAgICAgICAgICAgICAgICAgY2FzZSAyOgogICAgICAgICAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDMxLnN0b3AoKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0sIF9jYWxsZWUzMSk7CiAgICAgICAgICB9KSkoKTsKICAgICAgICB9LAogICAgICAgIGFkZEdpZnRPZklkOiBmdW5jdGlvbiBhZGRHaWZ0T2ZJZChjb250ZXh0KSB7CiAgICAgICAgICB2YXIgX2FyZ3VtZW50czE0ID0gYXJndW1lbnRzOwogICAgICAgICAgcmV0dXJuIF9hc3luY1RvR2VuZXJhdG9yKCAvKiNfX1BVUkVfXyovcmVnZW5lcmF0b3JSdW50aW1lLm1hcmsoZnVuY3Rpb24gX2NhbGxlZTMzKCkgewogICAgICAgICAgICB2YXIgYXJnOwogICAgICAgICAgICByZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLndyYXAoZnVuY3Rpb24gX2NhbGxlZTMzJChfY29udGV4dDMzKSB7CiAgICAgICAgICAgICAgd2hpbGUgKDEpIHsKICAgICAgICAgICAgICAgIHN3aXRjaCAoX2NvbnRleHQzMy5wcmV2ID0gX2NvbnRleHQzMy5uZXh0KSB7CiAgICAgICAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICAgICAgICBhcmcgPSBfYXJndW1lbnRzMTQubGVuZ3RoID4gMSAmJiBfYXJndW1lbnRzMTRbMV0gIT09IHVuZGVmaW5lZCA/IF9hcmd1bWVudHMxNFsxXSA6IHsKICAgICAgICAgICAgICAgICAgICAgIGlkOiBpZCwKICAgICAgICAgICAgICAgICAgICAgIGdpZnQ6IGdpZnQKICAgICAgICAgICAgICAgICAgICB9OwogICAgICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDMzLmFicnVwdCgicmV0dXJuIiwgY29udGV4dC5zdGF0ZS5wcm9jZXNzb3IuYWNxdWlyZSgiYWRkR2lmdE9mSWQiLCAvKiNfX1BVUkVfXyovX2FzeW5jVG9HZW5lcmF0b3IoIC8qI19fUFVSRV9fKi9yZWdlbmVyYXRvclJ1bnRpbWUubWFyayhmdW5jdGlvbiBfY2FsbGVlMzIoKSB7CiAgICAgICAgICAgICAgICAgICAgICB2YXIgaWQsIGdpZnQsIGFwaSwgZXJyb3IsIGNvbnRlbnQsIGl0ZW07CiAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLndyYXAoZnVuY3Rpb24gX2NhbGxlZTMyJChfY29udGV4dDMyKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHdoaWxlICgxKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgc3dpdGNoIChfY29udGV4dDMyLnByZXYgPSBfY29udGV4dDMyLm5leHQpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWQgPSBhcmcuaWQsIGdpZnQgPSBhcmcuZ2lmdDsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgX2NvbnRleHQzMi5uZXh0ID0gMzsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIEFwaUhvc3QucmVxdWVzdCgpLlBPU1QoKS51cmwoInByb2R1Y3R2Mi9naWZ0LyIpLmJvZHkoewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRlbnQ6IHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHByb2R1Y3RJZDogaWQsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBnaWZ0OiBnaWZ0CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KS5zZW5kKCk7CgogICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAzOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhcGkgPSBfY29udGV4dDMyLnNlbnQ7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVycm9yID0gYXBpLmdldEVycm9yKCk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRlbnQgPSBhcGkuZ2V0Q29udGVudCgpOwoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFlcnJvcikgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9jb250ZXh0MzIubmV4dCA9IDg7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihlcnJvcik7CgogICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSA4OgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfY29udGV4dDMyLm5leHQgPSAxMDsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGNvbnRleHQuZGlzcGF0Y2goIm9uVXBkYXRlSXRlbSIsIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZDogY29udGVudC5wcm9kdWN0SWQsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FsbGJhY2s6IGZ1bmN0aW9uIGNhbGxiYWNrKGl0ZW0pIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBpdGVtLmFkZEdpZnQoY29udGVudC5naWZ0KTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pOwoKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgMTA6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGl0ZW0gPSBfY29udGV4dDMyLnNlbnQ7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDMyLmFicnVwdCgicmV0dXJuIiwgaXRlbSk7CgogICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAxMjoKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDMyLnN0b3AoKTsKICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgIH0sIF9jYWxsZWUzMik7CiAgICAgICAgICAgICAgICAgICAgfSkpKSk7CgogICAgICAgICAgICAgICAgICBjYXNlIDI6CiAgICAgICAgICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0MzMuc3RvcCgpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSwgX2NhbGxlZTMzKTsKICAgICAgICAgIH0pKSgpOwogICAgICAgIH0sCiAgICAgICAgcmVtb3ZlR2lmdE9mSWQ6IGZ1bmN0aW9uIHJlbW92ZUdpZnRPZklkKGNvbnRleHQpIHsKICAgICAgICAgIHZhciBfYXJndW1lbnRzMTUgPSBhcmd1bWVudHM7CiAgICAgICAgICByZXR1cm4gX2FzeW5jVG9HZW5lcmF0b3IoIC8qI19fUFVSRV9fKi9yZWdlbmVyYXRvclJ1bnRpbWUubWFyayhmdW5jdGlvbiBfY2FsbGVlMzUoKSB7CiAgICAgICAgICAgIHZhciBhcmc7CiAgICAgICAgICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUud3JhcChmdW5jdGlvbiBfY2FsbGVlMzUkKF9jb250ZXh0MzUpIHsKICAgICAgICAgICAgICB3aGlsZSAoMSkgewogICAgICAgICAgICAgICAgc3dpdGNoIChfY29udGV4dDM1LnByZXYgPSBfY29udGV4dDM1Lm5leHQpIHsKICAgICAgICAgICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICAgICAgICAgIGFyZyA9IF9hcmd1bWVudHMxNS5sZW5ndGggPiAxICYmIF9hcmd1bWVudHMxNVsxXSAhPT0gdW5kZWZpbmVkID8gX2FyZ3VtZW50czE1WzFdIDogewogICAgICAgICAgICAgICAgICAgICAgaWQ6IGlkLAogICAgICAgICAgICAgICAgICAgICAgZ2lmdDogZ2lmdAogICAgICAgICAgICAgICAgICAgIH07CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0MzUuYWJydXB0KCJyZXR1cm4iLCBjb250ZXh0LnN0YXRlLnByb2Nlc3Nvci5hY3F1aXJlKCJyZW1vdmVHaWZ0T2ZJZCIsIC8qI19fUFVSRV9fKi9fYXN5bmNUb0dlbmVyYXRvciggLyojX19QVVJFX18qL3JlZ2VuZXJhdG9yUnVudGltZS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWUzNCgpIHsKICAgICAgICAgICAgICAgICAgICAgIHZhciBpZCwgZ2lmdCwgYXBpLCBlcnJvciwgY29udGVudCwgaXRlbTsKICAgICAgICAgICAgICAgICAgICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUud3JhcChmdW5jdGlvbiBfY2FsbGVlMzQkKF9jb250ZXh0MzQpIHsKICAgICAgICAgICAgICAgICAgICAgICAgd2hpbGUgKDEpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICBzd2l0Y2ggKF9jb250ZXh0MzQucHJldiA9IF9jb250ZXh0MzQubmV4dCkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZCA9IGFyZy5pZCwgZ2lmdCA9IGFyZy5naWZ0OwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfY29udGV4dDM0Lm5leHQgPSAzOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gQXBpSG9zdC5yZXF1ZXN0KCkuREVMRVRFKCkudXJsKCJwcm9kdWN0djIvZ2lmdC8iKS5ib2R5KHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb250ZW50OiB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwcm9kdWN0SWQ6IGlkLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZ2lmdDogZ2lmdAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSkuc2VuZCgpOwoKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgMzoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYXBpID0gX2NvbnRleHQzNC5zZW50OwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlcnJvciA9IGFwaS5nZXRFcnJvcigpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb250ZW50ID0gYXBpLmdldENvbnRlbnQoKTsKCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICghZXJyb3IpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfY29udGV4dDM0Lm5leHQgPSA4OwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoZXJyb3IpOwoKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgODoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgX2NvbnRleHQzNC5uZXh0ID0gMTA7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBjb250ZXh0LmRpc3BhdGNoKCJvblVwZGF0ZUl0ZW0iLCB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWQ6IGNvbnRlbnQucHJvZHVjdElkLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhbGxiYWNrOiBmdW5jdGlvbiBjYWxsYmFjayhpdGVtKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gaXRlbS5yZW1vdmVHaWZ0KGNvbnRlbnQuZ2lmdCk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTsKCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDEwOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpdGVtID0gX2NvbnRleHQzNC5zZW50OwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQzNC5hYnJ1cHQoInJldHVybiIsIGl0ZW0pOwoKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgMTI6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQzNC5zdG9wKCk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICB9LCBfY2FsbGVlMzQpOwogICAgICAgICAgICAgICAgICAgIH0pKSkpOwoKICAgICAgICAgICAgICAgICAgY2FzZSAyOgogICAgICAgICAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDM1LnN0b3AoKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0sIF9jYWxsZWUzNSk7CiAgICAgICAgICB9KSkoKTsKICAgICAgICB9LAogICAgICAgIGFkZFNwZWNpZmljYXRpb25PZklkOiBmdW5jdGlvbiBhZGRTcGVjaWZpY2F0aW9uT2ZJZChjb250ZXh0KSB7CiAgICAgICAgICB2YXIgX2FyZ3VtZW50czE2ID0gYXJndW1lbnRzOwogICAgICAgICAgcmV0dXJuIF9hc3luY1RvR2VuZXJhdG9yKCAvKiNfX1BVUkVfXyovcmVnZW5lcmF0b3JSdW50aW1lLm1hcmsoZnVuY3Rpb24gX2NhbGxlZTM3KCkgewogICAgICAgICAgICB2YXIgYXJnOwogICAgICAgICAgICByZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLndyYXAoZnVuY3Rpb24gX2NhbGxlZTM3JChfY29udGV4dDM3KSB7CiAgICAgICAgICAgICAgd2hpbGUgKDEpIHsKICAgICAgICAgICAgICAgIHN3aXRjaCAoX2NvbnRleHQzNy5wcmV2ID0gX2NvbnRleHQzNy5uZXh0KSB7CiAgICAgICAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICAgICAgICBhcmcgPSBfYXJndW1lbnRzMTYubGVuZ3RoID4gMSAmJiBfYXJndW1lbnRzMTZbMV0gIT09IHVuZGVmaW5lZCA/IF9hcmd1bWVudHMxNlsxXSA6IHsKICAgICAgICAgICAgICAgICAgICAgIGlkOiBpZCwKICAgICAgICAgICAgICAgICAgICAgIHNwZWNpZmljYXRpb246IHNwZWNpZmljYXRpb24KICAgICAgICAgICAgICAgICAgICB9OwogICAgICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDM3LmFicnVwdCgicmV0dXJuIiwgY29udGV4dC5zdGF0ZS5wcm9jZXNzb3IuYWNxdWlyZSgiYWRkU3BlY2lmaWNhdGlvbk9mSWQiLCAvKiNfX1BVUkVfXyovX2FzeW5jVG9HZW5lcmF0b3IoIC8qI19fUFVSRV9fKi9yZWdlbmVyYXRvclJ1bnRpbWUubWFyayhmdW5jdGlvbiBfY2FsbGVlMzYoKSB7CiAgICAgICAgICAgICAgICAgICAgICB2YXIgaWQsIHNwZWNpZmljYXRpb24sIGFwaSwgZXJyb3IsIGNvbnRlbnQsIGl0ZW07CiAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLndyYXAoZnVuY3Rpb24gX2NhbGxlZTM2JChfY29udGV4dDM2KSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHdoaWxlICgxKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgc3dpdGNoIChfY29udGV4dDM2LnByZXYgPSBfY29udGV4dDM2Lm5leHQpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWQgPSBhcmcuaWQsIHNwZWNpZmljYXRpb24gPSBhcmcuc3BlY2lmaWNhdGlvbjsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgX2NvbnRleHQzNi5uZXh0ID0gMzsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIEFwaUhvc3QucmVxdWVzdCgpLlBPU1QoKS51cmwoInByb2R1Y3R2Mi9zcGVjaWZpY2F0aW9uLyIpLmJvZHkoewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRlbnQ6IHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHByb2R1Y3RJZDogaWQsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzcGVjaWZpY2F0aW9uOiBzcGVjaWZpY2F0aW9uCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KS5zZW5kKCk7CgogICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAzOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhcGkgPSBfY29udGV4dDM2LnNlbnQ7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVycm9yID0gYXBpLmdldEVycm9yKCk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRlbnQgPSBhcGkuZ2V0Q29udGVudCgpOwoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFlcnJvcikgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9jb250ZXh0MzYubmV4dCA9IDg7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihlcnJvcik7CgogICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSA4OgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfY29udGV4dDM2Lm5leHQgPSAxMDsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGNvbnRleHQuZGlzcGF0Y2goIm9uVXBkYXRlSXRlbSIsIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZDogY29udGVudC5wcm9kdWN0SWQsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FsbGJhY2s6IGZ1bmN0aW9uIGNhbGxiYWNrKGl0ZW0pIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGl0ZW0uYWRkU3BlY2lmaWNhdGlvbihjb250ZW50LnNwZWNpZmljYXRpb24pOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7CgogICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAxMDoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaXRlbSA9IF9jb250ZXh0MzYuc2VudDsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0MzYuYWJydXB0KCJyZXR1cm4iLCBpdGVtKTsKCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDEyOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0MzYuc3RvcCgpOwogICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgfSwgX2NhbGxlZTM2KTsKICAgICAgICAgICAgICAgICAgICB9KSkpKTsKCiAgICAgICAgICAgICAgICAgIGNhc2UgMjoKICAgICAgICAgICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQzNy5zdG9wKCk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9LCBfY2FsbGVlMzcpOwogICAgICAgICAgfSkpKCk7CiAgICAgICAgfSwKICAgICAgICByZW1vdmVTcGVjaWZpY2F0aW9uT2ZJZDogZnVuY3Rpb24gcmVtb3ZlU3BlY2lmaWNhdGlvbk9mSWQoY29udGV4dCkgewogICAgICAgICAgdmFyIF9hcmd1bWVudHMxNyA9IGFyZ3VtZW50czsKICAgICAgICAgIHJldHVybiBfYXN5bmNUb0dlbmVyYXRvciggLyojX19QVVJFX18qL3JlZ2VuZXJhdG9yUnVudGltZS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWUzOSgpIHsKICAgICAgICAgICAgdmFyIGFyZzsKICAgICAgICAgICAgcmV0dXJuIHJlZ2VuZXJhdG9yUnVudGltZS53cmFwKGZ1bmN0aW9uIF9jYWxsZWUzOSQoX2NvbnRleHQzOSkgewogICAgICAgICAgICAgIHdoaWxlICgxKSB7CiAgICAgICAgICAgICAgICBzd2l0Y2ggKF9jb250ZXh0MzkucHJldiA9IF9jb250ZXh0MzkubmV4dCkgewogICAgICAgICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgICAgICAgYXJnID0gX2FyZ3VtZW50czE3Lmxlbmd0aCA+IDEgJiYgX2FyZ3VtZW50czE3WzFdICE9PSB1bmRlZmluZWQgPyBfYXJndW1lbnRzMTdbMV0gOiB7CiAgICAgICAgICAgICAgICAgICAgICBpZDogaWQsCiAgICAgICAgICAgICAgICAgICAgICBzcGVjaWZpY2F0aW9uOiBzcGVjaWZpY2F0aW9uCiAgICAgICAgICAgICAgICAgICAgfTsKICAgICAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQzOS5hYnJ1cHQoInJldHVybiIsIGNvbnRleHQuc3RhdGUucHJvY2Vzc29yLmFjcXVpcmUoInJlbW92ZVNwZWNpZmljYXRpb25PZklkIiwgLyojX19QVVJFX18qL19hc3luY1RvR2VuZXJhdG9yKCAvKiNfX1BVUkVfXyovcmVnZW5lcmF0b3JSdW50aW1lLm1hcmsoZnVuY3Rpb24gX2NhbGxlZTM4KCkgewogICAgICAgICAgICAgICAgICAgICAgdmFyIGlkLCBzcGVjaWZpY2F0aW9uLCBhcGksIGVycm9yLCBjb250ZW50LCBpdGVtOwogICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHJlZ2VuZXJhdG9yUnVudGltZS53cmFwKGZ1bmN0aW9uIF9jYWxsZWUzOCQoX2NvbnRleHQzOCkgewogICAgICAgICAgICAgICAgICAgICAgICB3aGlsZSAoMSkgewogICAgICAgICAgICAgICAgICAgICAgICAgIHN3aXRjaCAoX2NvbnRleHQzOC5wcmV2ID0gX2NvbnRleHQzOC5uZXh0KSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlkID0gYXJnLmlkLCBzcGVjaWZpY2F0aW9uID0gYXJnLnNwZWNpZmljYXRpb247CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNwZWNpZmljYXRpb24gPSBzcGVjaWZpY2F0aW9uIGluc3RhbmNlb2YgUHJvZHVjdFNwZWNDb250ZW50ID8gUHJvZHVjdFNwZWNDb250ZW50LmV4cG9ydEZyb20oc3BlY2lmaWNhdGlvbikgOiBzcGVjaWZpY2F0aW9uOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzcGVjaWZpY2F0aW9uLnR5cGUgPSBzcGVjaWZpY2F0aW9uLmtleTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgX2NvbnRleHQzOC5uZXh0ID0gNTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIEFwaUhvc3QucmVxdWVzdCgpLkRFTEVURSgpLnVybCgicHJvZHVjdHYyL3NwZWNpZmljYXRpb24vIikuYm9keSh7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29udGVudDogewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcHJvZHVjdElkOiBpZCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNwZWNpZmljYXRpb246IHNwZWNpZmljYXRpb24KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pLnNlbmQoKTsKCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDU6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFwaSA9IF9jb250ZXh0Mzguc2VudDsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZXJyb3IgPSBhcGkuZ2V0RXJyb3IoKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29udGVudCA9IGFwaS5nZXRDb250ZW50KCk7CgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoIWVycm9yKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgX2NvbnRleHQzOC5uZXh0ID0gMTA7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihlcnJvcik7CgogICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAxMDoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgX2NvbnRleHQzOC5uZXh0ID0gMTI7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBjb250ZXh0LmRpc3BhdGNoKCJvblVwZGF0ZUl0ZW0iLCB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWQ6IGNvbnRlbnQucHJvZHVjdElkLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhbGxiYWNrOiBmdW5jdGlvbiBjYWxsYmFjayhpdGVtKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpdGVtLnJlbW92ZVNwZWNpZmljYXRpb24oY29udGVudC5zcGVjaWZpY2F0aW9uKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pOwoKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgMTI6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGl0ZW0gPSBfY29udGV4dDM4LnNlbnQ7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDM4LmFicnVwdCgicmV0dXJuIiwgaXRlbSk7CgogICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAxNDoKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDM4LnN0b3AoKTsKICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgIH0sIF9jYWxsZWUzOCk7CiAgICAgICAgICAgICAgICAgICAgfSkpKSk7CgogICAgICAgICAgICAgICAgICBjYXNlIDI6CiAgICAgICAgICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0Mzkuc3RvcCgpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSwgX2NhbGxlZTM5KTsKICAgICAgICAgIH0pKSgpOwogICAgICAgIH0sCiAgICAgICAgdXBkYXRlU3BlY2lmaWNhdGlvbnNPZklkOiBmdW5jdGlvbiB1cGRhdGVTcGVjaWZpY2F0aW9uc09mSWQoY29udGV4dCkgewogICAgICAgICAgdmFyIF9hcmd1bWVudHMxOCA9IGFyZ3VtZW50czsKICAgICAgICAgIHJldHVybiBfYXN5bmNUb0dlbmVyYXRvciggLyojX19QVVJFX18qL3JlZ2VuZXJhdG9yUnVudGltZS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWU0MSgpIHsKICAgICAgICAgICAgdmFyIGFyZzsKICAgICAgICAgICAgcmV0dXJuIHJlZ2VuZXJhdG9yUnVudGltZS53cmFwKGZ1bmN0aW9uIF9jYWxsZWU0MSQoX2NvbnRleHQ0MSkgewogICAgICAgICAgICAgIHdoaWxlICgxKSB7CiAgICAgICAgICAgICAgICBzd2l0Y2ggKF9jb250ZXh0NDEucHJldiA9IF9jb250ZXh0NDEubmV4dCkgewogICAgICAgICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgICAgICAgYXJnID0gX2FyZ3VtZW50czE4Lmxlbmd0aCA+IDEgJiYgX2FyZ3VtZW50czE4WzFdICE9PSB1bmRlZmluZWQgPyBfYXJndW1lbnRzMThbMV0gOiB7CiAgICAgICAgICAgICAgICAgICAgICBpZDogaWQsCiAgICAgICAgICAgICAgICAgICAgICBzcGVjaWZpY2F0aW9uczogc3BlY2lmaWNhdGlvbnMKICAgICAgICAgICAgICAgICAgICB9OwogICAgICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDQxLmFicnVwdCgicmV0dXJuIiwgY29udGV4dC5zdGF0ZS5wcm9jZXNzb3IuYWNxdWlyZSgidXBkYXRlU3BlY2lmaWNhdGlvbnNPZklkIiwgLyojX19QVVJFX18qL19hc3luY1RvR2VuZXJhdG9yKCAvKiNfX1BVUkVfXyovcmVnZW5lcmF0b3JSdW50aW1lLm1hcmsoZnVuY3Rpb24gX2NhbGxlZTQwKCkgewogICAgICAgICAgICAgICAgICAgICAgdmFyIGlkLCBzcGVjaWZpY2F0aW9ucywgYXBpLCBlcnJvciwgY29udGVudCwgaXRlbTsKICAgICAgICAgICAgICAgICAgICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUud3JhcChmdW5jdGlvbiBfY2FsbGVlNDAkKF9jb250ZXh0NDApIHsKICAgICAgICAgICAgICAgICAgICAgICAgd2hpbGUgKDEpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICBzd2l0Y2ggKF9jb250ZXh0NDAucHJldiA9IF9jb250ZXh0NDAubmV4dCkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZCA9IGFyZy5pZCwgc3BlY2lmaWNhdGlvbnMgPSBhcmcuc3BlY2lmaWNhdGlvbnM7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9jb250ZXh0NDAubmV4dCA9IDM7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBBcGlIb3N0LnJlcXVlc3QoKS5QVVQoKS51cmwoInByb2R1Y3R2Mi9zcGVjaWZpY2F0aW9uL2xpc3QiKS5ib2R5KHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb250ZW50OiB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwcm9kdWN0SWQ6IGlkLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3BlY2lmaWNhdGlvbnM6IHNwZWNpZmljYXRpb25zCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KS5zZW5kKCk7CgogICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAzOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhcGkgPSBfY29udGV4dDQwLnNlbnQ7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVycm9yID0gYXBpLmdldEVycm9yKCk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRlbnQgPSBhcGkuZ2V0Q29udGVudCgpOwoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFlcnJvcikgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9jb250ZXh0NDAubmV4dCA9IDg7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihlcnJvcik7CgogICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSA4OgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfY29udGV4dDQwLm5leHQgPSAxMDsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGNvbnRleHQuZGlzcGF0Y2goIm9uVXBkYXRlSXRlbSIsIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZDogY29udGVudC5wcm9kdWN0SWQsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FsbGJhY2s6IGZ1bmN0aW9uIGNhbGxiYWNrKGl0ZW0pIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGl0ZW0uc2V0U3BlY2lmaWNhdGlvbnMoY29udGVudC5zcGVjaWZpY2F0aW9ucyk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTsKCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDEwOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpdGVtID0gX2NvbnRleHQ0MC5zZW50OwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQ0MC5hYnJ1cHQoInJldHVybiIsIGl0ZW0pOwoKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgMTI6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQ0MC5zdG9wKCk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICB9LCBfY2FsbGVlNDApOwogICAgICAgICAgICAgICAgICAgIH0pKSkpOwoKICAgICAgICAgICAgICAgICAgY2FzZSAyOgogICAgICAgICAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDQxLnN0b3AoKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0sIF9jYWxsZWU0MSk7CiAgICAgICAgICB9KSkoKTsKICAgICAgICB9LAogICAgICAgIGFkZEltYWdlT2ZJZDogZnVuY3Rpb24gYWRkSW1hZ2VPZklkKGNvbnRleHQpIHsKICAgICAgICAgIHZhciBfYXJndW1lbnRzMTkgPSBhcmd1bWVudHM7CiAgICAgICAgICByZXR1cm4gX2FzeW5jVG9HZW5lcmF0b3IoIC8qI19fUFVSRV9fKi9yZWdlbmVyYXRvclJ1bnRpbWUubWFyayhmdW5jdGlvbiBfY2FsbGVlNDMoKSB7CiAgICAgICAgICAgIHZhciBhcmc7CiAgICAgICAgICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUud3JhcChmdW5jdGlvbiBfY2FsbGVlNDMkKF9jb250ZXh0NDMpIHsKICAgICAgICAgICAgICB3aGlsZSAoMSkgewogICAgICAgICAgICAgICAgc3dpdGNoIChfY29udGV4dDQzLnByZXYgPSBfY29udGV4dDQzLm5leHQpIHsKICAgICAgICAgICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICAgICAgICAgIGFyZyA9IF9hcmd1bWVudHMxOS5sZW5ndGggPiAxICYmIF9hcmd1bWVudHMxOVsxXSAhPT0gdW5kZWZpbmVkID8gX2FyZ3VtZW50czE5WzFdIDogewogICAgICAgICAgICAgICAgICAgICAgaWQ6IGlkLAogICAgICAgICAgICAgICAgICAgICAgaW1hZ2VGaWxlOiBpbWFnZUZpbGUKICAgICAgICAgICAgICAgICAgICB9OwogICAgICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDQzLmFicnVwdCgicmV0dXJuIiwgY29udGV4dC5zdGF0ZS5wcm9jZXNzb3IuYWNxdWlyZSgiYWRkSW1hZ2VPZklkIiwgLyojX19QVVJFX18qL19hc3luY1RvR2VuZXJhdG9yKCAvKiNfX1BVUkVfXyovcmVnZW5lcmF0b3JSdW50aW1lLm1hcmsoZnVuY3Rpb24gX2NhbGxlZTQyKCkgewogICAgICAgICAgICAgICAgICAgICAgdmFyIGlkLCBpbWFnZUZpbGUsIGltYWdlRmlsZUZvcm0sIGFwaSwgY29udGVudCwgaXRlbTsKICAgICAgICAgICAgICAgICAgICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUud3JhcChmdW5jdGlvbiBfY2FsbGVlNDIkKF9jb250ZXh0NDIpIHsKICAgICAgICAgICAgICAgICAgICAgICAgd2hpbGUgKDEpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICBzd2l0Y2ggKF9jb250ZXh0NDIucHJldiA9IF9jb250ZXh0NDIubmV4dCkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZCA9IGFyZy5pZCwgaW1hZ2VGaWxlID0gYXJnLmltYWdlRmlsZTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaW1hZ2VGaWxlRm9ybSA9IG5ldyBGb3JtRGF0YSgpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpbWFnZUZpbGVGb3JtLmFwcGVuZChpbWFnZUZpbGUubmFtZSwgaW1hZ2VGaWxlKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgX2NvbnRleHQ0Mi5uZXh0ID0gNTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIEFwaUhvc3QuZmV0Y2goewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1ldGhvZDogIlBPU1QiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVybDogInByb2R1Y3R2Mi9pZC8iLmNvbmNhdChpZCwgIi9pbWFnZS8iKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBib2R5OiBpbWFnZUZpbGVGb3JtCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pOwoKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgNToKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYXBpID0gX2NvbnRleHQ0Mi5zZW50OwoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFhcGkuZXJyb3IpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfY29udGV4dDQyLm5leHQgPSA4OwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYXBpLmVycm9yKTsKCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDg6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRlbnQgPSBhcGkuY29udGVudDsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgX2NvbnRleHQ0Mi5uZXh0ID0gMTE7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBjb250ZXh0LmRpc3BhdGNoKCJvblVwZGF0ZUl0ZW0iLCB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWQ6IGNvbnRlbnQucHJvZHVjdElkLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhbGxiYWNrOiBmdW5jdGlvbiBjYWxsYmFjayhpdGVtKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpdGVtLmFkZEltYWdlcyhjb250ZW50LmltYWdlcyk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTsKCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDExOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpdGVtID0gX2NvbnRleHQ0Mi5zZW50OwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQ0Mi5hYnJ1cHQoInJldHVybiIsIGl0ZW0pOwoKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgMTM6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQ0Mi5zdG9wKCk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICB9LCBfY2FsbGVlNDIpOwogICAgICAgICAgICAgICAgICAgIH0pKSkpOwoKICAgICAgICAgICAgICAgICAgY2FzZSAyOgogICAgICAgICAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDQzLnN0b3AoKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0sIF9jYWxsZWU0Myk7CiAgICAgICAgICB9KSkoKTsKICAgICAgICB9LAogICAgICAgIHJlbW92ZUltYWdlT2ZJZDogZnVuY3Rpb24gcmVtb3ZlSW1hZ2VPZklkKGNvbnRleHQpIHsKICAgICAgICAgIHZhciBfYXJndW1lbnRzMjAgPSBhcmd1bWVudHM7CiAgICAgICAgICByZXR1cm4gX2FzeW5jVG9HZW5lcmF0b3IoIC8qI19fUFVSRV9fKi9yZWdlbmVyYXRvclJ1bnRpbWUubWFyayhmdW5jdGlvbiBfY2FsbGVlNDUoKSB7CiAgICAgICAgICAgIHZhciBhcmc7CiAgICAgICAgICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUud3JhcChmdW5jdGlvbiBfY2FsbGVlNDUkKF9jb250ZXh0NDUpIHsKICAgICAgICAgICAgICB3aGlsZSAoMSkgewogICAgICAgICAgICAgICAgc3dpdGNoIChfY29udGV4dDQ1LnByZXYgPSBfY29udGV4dDQ1Lm5leHQpIHsKICAgICAgICAgICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICAgICAgICAgIGFyZyA9IF9hcmd1bWVudHMyMC5sZW5ndGggPiAxICYmIF9hcmd1bWVudHMyMFsxXSAhPT0gdW5kZWZpbmVkID8gX2FyZ3VtZW50czIwWzFdIDogewogICAgICAgICAgICAgICAgICAgICAgaWQ6IGlkLAogICAgICAgICAgICAgICAgICAgICAgaW1hZ2U6IGltYWdlCiAgICAgICAgICAgICAgICAgICAgfTsKICAgICAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQ0NS5hYnJ1cHQoInJldHVybiIsIGNvbnRleHQuc3RhdGUucHJvY2Vzc29yLmFjcXVpcmUoInJlbW92ZUltYWdlT2ZJZCIsIC8qI19fUFVSRV9fKi9fYXN5bmNUb0dlbmVyYXRvciggLyojX19QVVJFX18qL3JlZ2VuZXJhdG9yUnVudGltZS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWU0NCgpIHsKICAgICAgICAgICAgICAgICAgICAgIHZhciBpZCwgaW1hZ2UsIGFwaSwgZXJyb3IsIGNvbnRlbnQsIGl0ZW07CiAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLndyYXAoZnVuY3Rpb24gX2NhbGxlZTQ0JChfY29udGV4dDQ0KSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHdoaWxlICgxKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgc3dpdGNoIChfY29udGV4dDQ0LnByZXYgPSBfY29udGV4dDQ0Lm5leHQpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWQgPSBhcmcuaWQsIGltYWdlID0gYXJnLmltYWdlOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpbWFnZSA9IGltYWdlIGluc3RhbmNlb2YgSW1hZ2UgPyBJbWFnZS5leHBvcnRGcm9tKGltYWdlKSA6IGltYWdlOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfY29udGV4dDQ0Lm5leHQgPSA0OwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gQXBpSG9zdC5yZXF1ZXN0KCkuREVMRVRFKCkudXJsKCJwcm9kdWN0djIvaWQvIi5jb25jYXQoaWQsICIvaW1hZ2UvIikpLmJvZHkoewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRlbnQ6IHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGltYWdlOiBpbWFnZQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSkuc2VuZCgpOwoKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgNDoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYXBpID0gX2NvbnRleHQ0NC5zZW50OwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlcnJvciA9IGFwaS5nZXRFcnJvcigpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb250ZW50ID0gYXBpLmdldENvbnRlbnQoKTsKCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICghZXJyb3IpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfY29udGV4dDQ0Lm5leHQgPSA5OwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoZXJyb3IpOwoKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgOToKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgX2NvbnRleHQ0NC5uZXh0ID0gMTE7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBjb250ZXh0LmRpc3BhdGNoKCJvblVwZGF0ZUl0ZW0iLCB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWQ6IGNvbnRlbnQucHJvZHVjdElkLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhbGxiYWNrOiBmdW5jdGlvbiBjYWxsYmFjayhpdGVtKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpdGVtLnJlbW92ZUltYWdlKGNvbnRlbnQuaW1hZ2UpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7CgogICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAxMToKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaXRlbSA9IF9jb250ZXh0NDQuc2VudDsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0NDQuYWJydXB0KCJyZXR1cm4iLCBpdGVtKTsKCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDEzOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0NDQuc3RvcCgpOwogICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgfSwgX2NhbGxlZTQ0KTsKICAgICAgICAgICAgICAgICAgICB9KSkpKTsKCiAgICAgICAgICAgICAgICAgIGNhc2UgMjoKICAgICAgICAgICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQ0NS5zdG9wKCk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9LCBfY2FsbGVlNDUpOwogICAgICAgICAgfSkpKCk7CiAgICAgICAgfQogICAgICB9CiAgICB9KTsKICAgIHZhciBzdG9yZSA9IG5ldyBWdWV4LlN0b3JlKHsKICAgICAgZ2V0dGVyczogewogICAgICAgIGNhdGVnb3JpZXM6IGZ1bmN0aW9uIGNhdGVnb3JpZXMoKSB7CiAgICAgICAgICByZXR1cm4gY2F0ZWdvcnlTdG9yZS5zdGF0ZS5pdGVtcy5tYXAoZnVuY3Rpb24gKGl0ZW0pIHsKICAgICAgICAgICAgcmV0dXJuIGl0ZW07CiAgICAgICAgICB9KTsKICAgICAgICB9LAogICAgICAgIHByb2R1Y3RzOiBmdW5jdGlvbiBwcm9kdWN0cygpIHsKICAgICAgICAgIHJldHVybiBwcm9kdWN0U3RvcmUuc3RhdGUuaXRlbXMubWFwKGZ1bmN0aW9uIChpdGVtKSB7CiAgICAgICAgICAgIHJldHVybiBpdGVtOwogICAgICAgICAgfSk7CiAgICAgICAgfSwKICAgICAgICBncm91cHM6IGZ1bmN0aW9uIGdyb3VwcygpIHsKICAgICAgICAgIHZhciBfc3RvcmUkZ2V0dGVycyA9IHN0b3JlLmdldHRlcnMsCiAgICAgICAgICAgICAgY2F0ZWdvcmllcyA9IF9zdG9yZSRnZXR0ZXJzLmNhdGVnb3JpZXMsCiAgICAgICAgICAgICAgcHJvZHVjdHMgPSBfc3RvcmUkZ2V0dGVycy5wcm9kdWN0czsKICAgICAgICAgIHZhciBjYXRlZ29yeU90aGVyID0gY2F0ZWdvcmllcy5maW5kKGZ1bmN0aW9uIChjYXRlZ29yeSkgewogICAgICAgICAgICByZXR1cm4gY2F0ZWdvcnkua2V5ID09PSBNb2R1bGVDYXRlZ29yeS5LZXkuT3RoZXI7CiAgICAgICAgICB9KTsKICAgICAgICAgIHZhciBjYXRlZ29yeU90aGVySWQgPSBjYXRlZ29yeU90aGVyID8gY2F0ZWdvcnlPdGhlci5faWQgOiAiIjsKICAgICAgICAgIHJldHVybiBjYXRlZ29yaWVzLm1hcChmdW5jdGlvbiAoY2F0ZWdvcnkpIHsKICAgICAgICAgICAgY2F0ZWdvcnkuaXRlbXMgPSBwcm9kdWN0cy5maWx0ZXIoZnVuY3Rpb24gKHByb2R1Y3QpIHsKICAgICAgICAgICAgICB2YXIgcHJvZHVjdENhdGVnb3J5SWQgPSBwcm9kdWN0LmdldENhdGVnb3J5SWQoKTsKCiAgICAgICAgICAgICAgaWYgKCFwcm9kdWN0Q2F0ZWdvcnlJZCkgewogICAgICAgICAgICAgICAgcHJvZHVjdENhdGVnb3J5SWQgPSBjYXRlZ29yeU90aGVySWQ7CiAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICByZXR1cm4gcHJvZHVjdC5nZXRDYXRlZ29yeUlkKCkgPT09IGNhdGVnb3J5Ll9pZDsKICAgICAgICAgICAgfSkuc29ydChmdW5jdGlvbiAocHJvZHVjdDEsIHByb2R1Y3QyKSB7CiAgICAgICAgICAgICAgcmV0dXJuIHByb2R1Y3QxLmNvbXBhcmUocHJvZHVjdDIpOwogICAgICAgICAgICB9KTsKICAgICAgICAgICAgcmV0dXJuIGNhdGVnb3J5OwogICAgICAgICAgfSkuc29ydChmdW5jdGlvbiAocHJvZHVjdDEsIHByb2R1Y3QyKSB7CiAgICAgICAgICAgIHJldHVybiBwcm9kdWN0MS5jb21wYXJlKHByb2R1Y3QyKTsKICAgICAgICAgIH0pOwogICAgICAgIH0sCiAgICAgICAgZ3JvdXBzMjogZnVuY3Rpb24gZ3JvdXBzMigpIHsKICAgICAgICAgIHZhciBfc3RvcmUkZ2V0dGVyczIgPSBzdG9yZS5nZXR0ZXJzLAogICAgICAgICAgICAgIGNhdGVnb3JpZXMgPSBfc3RvcmUkZ2V0dGVyczIuY2F0ZWdvcmllcywKICAgICAgICAgICAgICBwcm9kdWN0cyA9IF9zdG9yZSRnZXR0ZXJzMi5wcm9kdWN0czsKICAgICAgICAgIHZhciBjYXRlZ29yeU90aGVyID0gY2F0ZWdvcmllcy5maW5kKGZ1bmN0aW9uIChjYXRlZ29yeSkgewogICAgICAgICAgICByZXR1cm4gY2F0ZWdvcnkua2V5ID09PSBNb2R1bGVDYXRlZ29yeS5LZXkuT3RoZXI7CiAgICAgICAgICB9KTsKICAgICAgICAgIHZhciBjYXRlZ29yeU90aGVySWQgPSBjYXRlZ29yeU90aGVyID8gY2F0ZWdvcnlPdGhlci5faWQgOiAiIjsKICAgICAgICAgIHJldHVybiBjYXRlZ29yaWVzLm1hcChmdW5jdGlvbiAoY2F0ZWdvcnkpIHsKICAgICAgICAgICAgdmFyIGdyb3VwID0gewogICAgICAgICAgICAgIGNhdGVnb3J5OiBjYXRlZ29yeQogICAgICAgICAgICB9OwogICAgICAgICAgICBncm91cC5wcm9kdWN0cyA9IHByb2R1Y3RzLmZpbHRlcihmdW5jdGlvbiAocHJvZHVjdCkgewogICAgICAgICAgICAgIHZhciBwcm9kdWN0Q2F0ZWdvcnlJZCA9IHByb2R1Y3QuZ2V0Q2F0ZWdvcnlJZCgpOwoKICAgICAgICAgICAgICBpZiAoIXByb2R1Y3RDYXRlZ29yeUlkKSB7CiAgICAgICAgICAgICAgICBwcm9kdWN0Q2F0ZWdvcnlJZCA9IGNhdGVnb3J5T3RoZXJJZDsKICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgIHJldHVybiBwcm9kdWN0Q2F0ZWdvcnlJZCA9PT0gY2F0ZWdvcnkuX2lkOwogICAgICAgICAgICB9KS5zb3J0KGZ1bmN0aW9uIChwcm9kdWN0MSwgcHJvZHVjdDIpIHsKICAgICAgICAgICAgICByZXR1cm4gcHJvZHVjdDEuY29tcGFyZShwcm9kdWN0Mik7CiAgICAgICAgICAgIH0pOwogICAgICAgICAgICByZXR1cm4gZ3JvdXA7CiAgICAgICAgICB9KS5zb3J0KGZ1bmN0aW9uIChncm91cDEsIGdyb3VwMikgewogICAgICAgICAgICByZXR1cm4gZ3JvdXAxLmNhdGVnb3J5LmNvbXBhcmUoZ3JvdXAyLmNhdGVnb3J5KTsKICAgICAgICAgIH0pOwogICAgICAgIH0sCiAgICAgICAgaXNMb2FkaW5nOiBmdW5jdGlvbiBpc0xvYWRpbmcoKSB7CiAgICAgICAgICByZXR1cm4gY2F0ZWdvcnlTdG9yZS5zdGF0ZS5pc0xvYWRpbmcgfHwgcHJvZHVjdFN0b3JlLnN0YXRlLmlzTG9hZGluZzsKICAgICAgICB9CiAgICAgIH0sCiAgICAgIGFjdGlvbnM6IHsKICAgICAgICByZWZyZXNoOiBmdW5jdGlvbiByZWZyZXNoKCkgewogICAgICAgICAgcmV0dXJuIF9hc3luY1RvR2VuZXJhdG9yKCAvKiNfX1BVUkVfXyovcmVnZW5lcmF0b3JSdW50aW1lLm1hcmsoZnVuY3Rpb24gX2NhbGxlZTQ2KCkgewogICAgICAgICAgICByZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLndyYXAoZnVuY3Rpb24gX2NhbGxlZTQ2JChfY29udGV4dDQ2KSB7CiAgICAgICAgICAgICAgd2hpbGUgKDEpIHsKICAgICAgICAgICAgICAgIHN3aXRjaCAoX2NvbnRleHQ0Ni5wcmV2ID0gX2NvbnRleHQ0Ni5uZXh0KSB7CiAgICAgICAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICAgICAgICBfY29udGV4dDQ2Lm5leHQgPSAyOwogICAgICAgICAgICAgICAgICAgIHJldHVybiBQcm9taXNlLmFsbChbY2F0ZWdvcnlTdG9yZS5kaXNwYXRjaCgicmVmcmVzaCIpLCBwcm9kdWN0U3RvcmUuZGlzcGF0Y2goInJlZnJlc2giKV0pOwoKICAgICAgICAgICAgICAgICAgY2FzZSAyOgogICAgICAgICAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDQ2LnN0b3AoKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0sIF9jYWxsZWU0Nik7CiAgICAgICAgICB9KSkoKTsKICAgICAgICB9LAogICAgICAgIGdldFByb2R1Y3RzR3JvdXBCeUNhdGVnb3JpZXM6IGZ1bmN0aW9uIGdldFByb2R1Y3RzR3JvdXBCeUNhdGVnb3JpZXMoY29udGV4dCkgewogICAgICAgICAgdmFyIF9hcmd1bWVudHMyMSA9IGFyZ3VtZW50czsKICAgICAgICAgIHJldHVybiBfYXN5bmNUb0dlbmVyYXRvciggLyojX19QVVJFX18qL3JlZ2VuZXJhdG9yUnVudGltZS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWU0NygpIHsKICAgICAgICAgICAgdmFyIGFyZywgcHJldmVudFJlZnJlc2gsIGFzc2V0cywgZ3JvdXBzOwogICAgICAgICAgICByZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLndyYXAoZnVuY3Rpb24gX2NhbGxlZTQ3JChfY29udGV4dDQ3KSB7CiAgICAgICAgICAgICAgd2hpbGUgKDEpIHsKICAgICAgICAgICAgICAgIHN3aXRjaCAoX2NvbnRleHQ0Ny5wcmV2ID0gX2NvbnRleHQ0Ny5uZXh0KSB7CiAgICAgICAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICAgICAgICBhcmcgPSBfYXJndW1lbnRzMjEubGVuZ3RoID4gMSAmJiBfYXJndW1lbnRzMjFbMV0gIT09IHVuZGVmaW5lZCA/IF9hcmd1bWVudHMyMVsxXSA6IHsKICAgICAgICAgICAgICAgICAgICAgIHByZXZlbnRSZWZyZXNoOiBmYWxzZQogICAgICAgICAgICAgICAgICAgIH07CiAgICAgICAgICAgICAgICAgICAgcHJldmVudFJlZnJlc2ggPSBhcmcucHJldmVudFJlZnJlc2g7CgogICAgICAgICAgICAgICAgICAgIGlmICghKHByZXZlbnRSZWZyZXNoIHx8ICFwcm9kdWN0U3RvcmUuc3RhdGUuZGF0YUxvYWRlci5pc1RpbWVvdXQoKSAmJiAhY2F0ZWdvcnlTdG9yZS5zdGF0ZS5kYXRhTG9hZGVyLmlzVGltZW91dCgpKSkgewogICAgICAgICAgICAgICAgICAgICAgX2NvbnRleHQ0Ny5uZXh0ID0gNDsKICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0NDcuYWJydXB0KCJyZXR1cm4iLCBjb250ZXh0LmdldHRlcnMuZ3JvdXBzKTsKCiAgICAgICAgICAgICAgICAgIGNhc2UgNDoKICAgICAgICAgICAgICAgICAgICBfY29udGV4dDQ3Lm5leHQgPSA2OwogICAgICAgICAgICAgICAgICAgIHJldHVybiBjb250ZXh0LmRpc3BhdGNoKCJyZWZyZXNoIik7CgogICAgICAgICAgICAgICAgICBjYXNlIDY6CiAgICAgICAgICAgICAgICAgICAgYXNzZXRzID0gewogICAgICAgICAgICAgICAgICAgICAgY2F0ZWdvcmllczogY2F0ZWdvcnlTdG9yZS5zdGF0ZS5pdGVtcywKICAgICAgICAgICAgICAgICAgICAgIHByb2R1Y3RzOiBwcm9kdWN0U3RvcmUuc3RhdGUuaXRlbXMKICAgICAgICAgICAgICAgICAgICB9OwogICAgICAgICAgICAgICAgICAgIGdyb3VwcyA9IGFzc2V0cy5jYXRlZ29yaWVzLm1hcChmdW5jdGlvbiAoY2F0ZWdvcnkpIHsKICAgICAgICAgICAgICAgICAgICAgIGNhdGVnb3J5Lml0ZW1zID0gYXNzZXRzLnByb2R1Y3RzLmZpbHRlcihmdW5jdGlvbiAocHJvZHVjdCkgewogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gcHJvZHVjdC5nZXRDYXRlZ29yeUlkKCkgPT09IGNhdGVnb3J5Ll9pZDsKICAgICAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGNhdGVnb3J5OwogICAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDQ3LmFicnVwdCgicmV0dXJuIiwgZ3JvdXBzKTsKCiAgICAgICAgICAgICAgICAgIGNhc2UgOToKICAgICAgICAgICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQ0Ny5zdG9wKCk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9LCBfY2FsbGVlNDcpOwogICAgICAgICAgfSkpKCk7CiAgICAgICAgfSwKICAgICAgICBnZXRQcm9kdWN0Q2F0ZWdvcmllczogZnVuY3Rpb24gZ2V0UHJvZHVjdENhdGVnb3JpZXMoKSB7CiAgICAgICAgICByZXR1cm4gX2FzeW5jVG9HZW5lcmF0b3IoIC8qI19fUFVSRV9fKi9yZWdlbmVyYXRvclJ1bnRpbWUubWFyayhmdW5jdGlvbiBfY2FsbGVlNDgoKSB7CiAgICAgICAgICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUud3JhcChmdW5jdGlvbiBfY2FsbGVlNDgkKF9jb250ZXh0NDgpIHsKICAgICAgICAgICAgICB3aGlsZSAoMSkgewogICAgICAgICAgICAgICAgc3dpdGNoIChfY29udGV4dDQ4LnByZXYgPSBfY29udGV4dDQ4Lm5leHQpIHsKICAgICAgICAgICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDQ4LmFicnVwdCgicmV0dXJuIiwgY2F0ZWdvcnlTdG9yZS5kaXNwYXRjaCgiZ2V0SXRlbXMiKSk7CgogICAgICAgICAgICAgICAgICBjYXNlIDE6CiAgICAgICAgICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0NDguc3RvcCgpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSwgX2NhbGxlZTQ4KTsKICAgICAgICAgIH0pKSgpOwogICAgICAgIH0sCiAgICAgICAgZ2V0UHJvZHVjdENhdGVnb3J5QnlDYXRlZ29yeUlEOiBmdW5jdGlvbiBnZXRQcm9kdWN0Q2F0ZWdvcnlCeUNhdGVnb3J5SUQoY29udGV4dCkgewogICAgICAgICAgdmFyIF9hcmd1bWVudHMyMiA9IGFyZ3VtZW50czsKICAgICAgICAgIHJldHVybiBfYXN5bmNUb0dlbmVyYXRvciggLyojX19QVVJFX18qL3JlZ2VuZXJhdG9yUnVudGltZS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWU0OSgpIHsKICAgICAgICAgICAgdmFyIGFyZzsKICAgICAgICAgICAgcmV0dXJuIHJlZ2VuZXJhdG9yUnVudGltZS53cmFwKGZ1bmN0aW9uIF9jYWxsZWU0OSQoX2NvbnRleHQ0OSkgewogICAgICAgICAgICAgIHdoaWxlICgxKSB7CiAgICAgICAgICAgICAgICBzd2l0Y2ggKF9jb250ZXh0NDkucHJldiA9IF9jb250ZXh0NDkubmV4dCkgewogICAgICAgICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgICAgICAgYXJnID0gX2FyZ3VtZW50czIyLmxlbmd0aCA+IDEgJiYgX2FyZ3VtZW50czIyWzFdICE9PSB1bmRlZmluZWQgPyBfYXJndW1lbnRzMjJbMV0gOiB7CiAgICAgICAgICAgICAgICAgICAgICBpZDogaWQKICAgICAgICAgICAgICAgICAgICB9OwogICAgICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDQ5LmFicnVwdCgicmV0dXJuIiwgY2F0ZWdvcnlTdG9yZS5kaXNwYXRjaCgiZ2V0SXRlbU9mSWQiLCBhcmcpKTsKCiAgICAgICAgICAgICAgICAgIGNhc2UgMjoKICAgICAgICAgICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQ0OS5zdG9wKCk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9LCBfY2FsbGVlNDkpOwogICAgICAgICAgfSkpKCk7CiAgICAgICAgfSwKICAgICAgICBnZXRQcm9kdWN0czogZnVuY3Rpb24gZ2V0UHJvZHVjdHMoKSB7CiAgICAgICAgICByZXR1cm4gX2FzeW5jVG9HZW5lcmF0b3IoIC8qI19fUFVSRV9fKi9yZWdlbmVyYXRvclJ1bnRpbWUubWFyayhmdW5jdGlvbiBfY2FsbGVlNTAoKSB7CiAgICAgICAgICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUud3JhcChmdW5jdGlvbiBfY2FsbGVlNTAkKF9jb250ZXh0NTApIHsKICAgICAgICAgICAgICB3aGlsZSAoMSkgewogICAgICAgICAgICAgICAgc3dpdGNoIChfY29udGV4dDUwLnByZXYgPSBfY29udGV4dDUwLm5leHQpIHsKICAgICAgICAgICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDUwLmFicnVwdCgicmV0dXJuIiwgcHJvZHVjdFN0b3JlLmRpc3BhdGNoKCJnZXRJdGVtcyIpKTsKCiAgICAgICAgICAgICAgICAgIGNhc2UgMToKICAgICAgICAgICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQ1MC5zdG9wKCk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9LCBfY2FsbGVlNTApOwogICAgICAgICAgfSkpKCk7CiAgICAgICAgfSwKICAgICAgICBnZXRQcm9kdWN0QnlJRDogZnVuY3Rpb24gZ2V0UHJvZHVjdEJ5SUQoY29udGV4dCkgewogICAgICAgICAgdmFyIF9hcmd1bWVudHMyMyA9IGFyZ3VtZW50czsKICAgICAgICAgIHJldHVybiBfYXN5bmNUb0dlbmVyYXRvciggLyojX19QVVJFX18qL3JlZ2VuZXJhdG9yUnVudGltZS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWU1MSgpIHsKICAgICAgICAgICAgdmFyIGFyZzsKICAgICAgICAgICAgcmV0dXJuIHJlZ2VuZXJhdG9yUnVudGltZS53cmFwKGZ1bmN0aW9uIF9jYWxsZWU1MSQoX2NvbnRleHQ1MSkgewogICAgICAgICAgICAgIHdoaWxlICgxKSB7CiAgICAgICAgICAgICAgICBzd2l0Y2ggKF9jb250ZXh0NTEucHJldiA9IF9jb250ZXh0NTEubmV4dCkgewogICAgICAgICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgICAgICAgYXJnID0gX2FyZ3VtZW50czIzLmxlbmd0aCA+IDEgJiYgX2FyZ3VtZW50czIzWzFdICE9PSB1bmRlZmluZWQgPyBfYXJndW1lbnRzMjNbMV0gOiB7CiAgICAgICAgICAgICAgICAgICAgICBpZDogaWQsCiAgICAgICAgICAgICAgICAgICAgICBwcmV2ZW50UmVmcmVzaDogZmFsc2UKICAgICAgICAgICAgICAgICAgICB9OwogICAgICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDUxLmFicnVwdCgicmV0dXJuIiwgcHJvZHVjdFN0b3JlLmRpc3BhdGNoKCJnZXRJdGVtT2ZJZCIsIGFyZykpOwoKICAgICAgICAgICAgICAgICAgY2FzZSAyOgogICAgICAgICAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDUxLnN0b3AoKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0sIF9jYWxsZWU1MSk7CiAgICAgICAgICB9KSkoKTsKICAgICAgICB9LAogICAgICAgIGFkZFByb2R1Y3Q6IGZ1bmN0aW9uIGFkZFByb2R1Y3QoY29udGV4dCkgewogICAgICAgICAgdmFyIF9hcmd1bWVudHMyNCA9IGFyZ3VtZW50czsKICAgICAgICAgIHJldHVybiBfYXN5bmNUb0dlbmVyYXRvciggLyojX19QVVJFX18qL3JlZ2VuZXJhdG9yUnVudGltZS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWU1MigpIHsKICAgICAgICAgICAgdmFyIGFyZzsKICAgICAgICAgICAgcmV0dXJuIHJlZ2VuZXJhdG9yUnVudGltZS53cmFwKGZ1bmN0aW9uIF9jYWxsZWU1MiQoX2NvbnRleHQ1MikgewogICAgICAgICAgICAgIHdoaWxlICgxKSB7CiAgICAgICAgICAgICAgICBzd2l0Y2ggKF9jb250ZXh0NTIucHJldiA9IF9jb250ZXh0NTIubmV4dCkgewogICAgICAgICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgICAgICAgYXJnID0gX2FyZ3VtZW50czI0Lmxlbmd0aCA+IDEgJiYgX2FyZ3VtZW50czI0WzFdICE9PSB1bmRlZmluZWQgPyBfYXJndW1lbnRzMjRbMV0gOiB7CiAgICAgICAgICAgICAgICAgICAgICBkYXRhOiBkYXRhCiAgICAgICAgICAgICAgICAgICAgfTsKICAgICAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQ1Mi5hYnJ1cHQoInJldHVybiIsIHByb2R1Y3RTdG9yZS5kaXNwYXRjaCgiYWRkSXRlbSIsIGFyZykpOwoKICAgICAgICAgICAgICAgICAgY2FzZSAyOgogICAgICAgICAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDUyLnN0b3AoKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0sIF9jYWxsZWU1Mik7CiAgICAgICAgICB9KSkoKTsKICAgICAgICB9LAogICAgICAgIGRlbGV0ZVByb2R1Y3RieUlEOiBmdW5jdGlvbiBkZWxldGVQcm9kdWN0YnlJRChjb250ZXh0KSB7CiAgICAgICAgICB2YXIgX2FyZ3VtZW50czI1ID0gYXJndW1lbnRzOwogICAgICAgICAgcmV0dXJuIF9hc3luY1RvR2VuZXJhdG9yKCAvKiNfX1BVUkVfXyovcmVnZW5lcmF0b3JSdW50aW1lLm1hcmsoZnVuY3Rpb24gX2NhbGxlZTUzKCkgewogICAgICAgICAgICB2YXIgYXJnOwogICAgICAgICAgICByZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLndyYXAoZnVuY3Rpb24gX2NhbGxlZTUzJChfY29udGV4dDUzKSB7CiAgICAgICAgICAgICAgd2hpbGUgKDEpIHsKICAgICAgICAgICAgICAgIHN3aXRjaCAoX2NvbnRleHQ1My5wcmV2ID0gX2NvbnRleHQ1My5uZXh0KSB7CiAgICAgICAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICAgICAgICBhcmcgPSBfYXJndW1lbnRzMjUubGVuZ3RoID4gMSAmJiBfYXJndW1lbnRzMjVbMV0gIT09IHVuZGVmaW5lZCA/IF9hcmd1bWVudHMyNVsxXSA6IHsKICAgICAgICAgICAgICAgICAgICAgIGlkOiBpZAogICAgICAgICAgICAgICAgICAgIH07CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0NTMuYWJydXB0KCJyZXR1cm4iLCBwcm9kdWN0U3RvcmUuZGlzcGF0Y2goInJlbW92ZUl0ZW1PZklkIiwgYXJnKSk7CgogICAgICAgICAgICAgICAgICBjYXNlIDI6CiAgICAgICAgICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0NTMuc3RvcCgpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSwgX2NhbGxlZTUzKTsKICAgICAgICAgIH0pKSgpOwogICAgICAgIH0sCiAgICAgICAgdXBkYXRlVGl0bGVPZlByb2R1Y3RJZDogZnVuY3Rpb24gdXBkYXRlVGl0bGVPZlByb2R1Y3RJZChjb250ZXh0KSB7CiAgICAgICAgICB2YXIgX2FyZ3VtZW50czI2ID0gYXJndW1lbnRzOwogICAgICAgICAgcmV0dXJuIF9hc3luY1RvR2VuZXJhdG9yKCAvKiNfX1BVUkVfXyovcmVnZW5lcmF0b3JSdW50aW1lLm1hcmsoZnVuY3Rpb24gX2NhbGxlZTU0KCkgewogICAgICAgICAgICB2YXIgYXJnOwogICAgICAgICAgICByZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLndyYXAoZnVuY3Rpb24gX2NhbGxlZTU0JChfY29udGV4dDU0KSB7CiAgICAgICAgICAgICAgd2hpbGUgKDEpIHsKICAgICAgICAgICAgICAgIHN3aXRjaCAoX2NvbnRleHQ1NC5wcmV2ID0gX2NvbnRleHQ1NC5uZXh0KSB7CiAgICAgICAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICAgICAgICBhcmcgPSBfYXJndW1lbnRzMjYubGVuZ3RoID4gMSAmJiBfYXJndW1lbnRzMjZbMV0gIT09IHVuZGVmaW5lZCA/IF9hcmd1bWVudHMyNlsxXSA6IHsKICAgICAgICAgICAgICAgICAgICAgIHByb2R1Y3RJZDogcHJvZHVjdElkLAogICAgICAgICAgICAgICAgICAgICAgdGl0bGU6IHRpdGxlCiAgICAgICAgICAgICAgICAgICAgfTsKICAgICAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQ1NC5hYnJ1cHQoInJldHVybiIsIHByb2R1Y3RTdG9yZS5kaXNwYXRjaCgidXBkYXRlVGl0bGVPZklkIiwgewogICAgICAgICAgICAgICAgICAgICAgaWQ6IGFyZy5wcm9kdWN0SWQsCiAgICAgICAgICAgICAgICAgICAgICB0aXRsZTogYXJnLnRpdGxlCiAgICAgICAgICAgICAgICAgICAgfSkpOwoKICAgICAgICAgICAgICAgICAgY2FzZSAyOgogICAgICAgICAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDU0LnN0b3AoKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0sIF9jYWxsZWU1NCk7CiAgICAgICAgICB9KSkoKTsKICAgICAgICB9LAogICAgICAgIHVwZGF0ZURlc2NyaXB0aW9uT2ZQcm9kdWN0SWQ6IGZ1bmN0aW9uIHVwZGF0ZURlc2NyaXB0aW9uT2ZQcm9kdWN0SWQoY29udGV4dCkgewogICAgICAgICAgdmFyIF9hcmd1bWVudHMyNyA9IGFyZ3VtZW50czsKICAgICAgICAgIHJldHVybiBfYXN5bmNUb0dlbmVyYXRvciggLyojX19QVVJFX18qL3JlZ2VuZXJhdG9yUnVudGltZS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWU1NSgpIHsKICAgICAgICAgICAgdmFyIGFyZzsKICAgICAgICAgICAgcmV0dXJuIHJlZ2VuZXJhdG9yUnVudGltZS53cmFwKGZ1bmN0aW9uIF9jYWxsZWU1NSQoX2NvbnRleHQ1NSkgewogICAgICAgICAgICAgIHdoaWxlICgxKSB7CiAgICAgICAgICAgICAgICBzd2l0Y2ggKF9jb250ZXh0NTUucHJldiA9IF9jb250ZXh0NTUubmV4dCkgewogICAgICAgICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgICAgICAgYXJnID0gX2FyZ3VtZW50czI3Lmxlbmd0aCA+IDEgJiYgX2FyZ3VtZW50czI3WzFdICE9PSB1bmRlZmluZWQgPyBfYXJndW1lbnRzMjdbMV0gOiB7CiAgICAgICAgICAgICAgICAgICAgICBwcm9kdWN0SWQ6IHByb2R1Y3RJZCwKICAgICAgICAgICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBkZXNjcmlwdGlvbgogICAgICAgICAgICAgICAgICAgIH07CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0NTUuYWJydXB0KCJyZXR1cm4iLCBwcm9kdWN0U3RvcmUuZGlzcGF0Y2goInVwZGF0ZURlc2NyaXB0aW9uT2ZJZCIsIHsKICAgICAgICAgICAgICAgICAgICAgIGlkOiBhcmcucHJvZHVjdElkLAogICAgICAgICAgICAgICAgICAgICAgZGVzY3JpcHRpb246IGFyZy5kZXNjcmlwdGlvbgogICAgICAgICAgICAgICAgICAgIH0pKTsKCiAgICAgICAgICAgICAgICAgIGNhc2UgMjoKICAgICAgICAgICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQ1NS5zdG9wKCk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9LCBfY2FsbGVlNTUpOwogICAgICAgICAgfSkpKCk7CiAgICAgICAgfSwKICAgICAgICB1cGRhdGVCcmFuZElkT2ZQcm9kdWN0SWQ6IGZ1bmN0aW9uIHVwZGF0ZUJyYW5kSWRPZlByb2R1Y3RJZChjb250ZXh0KSB7CiAgICAgICAgICB2YXIgX2FyZ3VtZW50czI4ID0gYXJndW1lbnRzOwogICAgICAgICAgcmV0dXJuIF9hc3luY1RvR2VuZXJhdG9yKCAvKiNfX1BVUkVfXyovcmVnZW5lcmF0b3JSdW50aW1lLm1hcmsoZnVuY3Rpb24gX2NhbGxlZTU2KCkgewogICAgICAgICAgICB2YXIgYXJnOwogICAgICAgICAgICByZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLndyYXAoZnVuY3Rpb24gX2NhbGxlZTU2JChfY29udGV4dDU2KSB7CiAgICAgICAgICAgICAgd2hpbGUgKDEpIHsKICAgICAgICAgICAgICAgIHN3aXRjaCAoX2NvbnRleHQ1Ni5wcmV2ID0gX2NvbnRleHQ1Ni5uZXh0KSB7CiAgICAgICAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICAgICAgICBhcmcgPSBfYXJndW1lbnRzMjgubGVuZ3RoID4gMSAmJiBfYXJndW1lbnRzMjhbMV0gIT09IHVuZGVmaW5lZCA/IF9hcmd1bWVudHMyOFsxXSA6IHsKICAgICAgICAgICAgICAgICAgICAgIHByb2R1Y3RJZDogcHJvZHVjdElkLAogICAgICAgICAgICAgICAgICAgICAgYnJhbmRJZDogYnJhbmRJZAogICAgICAgICAgICAgICAgICAgIH07CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0NTYuYWJydXB0KCJyZXR1cm4iLCBwcm9kdWN0U3RvcmUuZGlzcGF0Y2goInVwZGF0ZUJyYW5kSWRPZklkIiwgewogICAgICAgICAgICAgICAgICAgICAgaWQ6IGFyZy5wcm9kdWN0SWQsCiAgICAgICAgICAgICAgICAgICAgICBicmFuZElkOiBhcmcuYnJhbmRJZAogICAgICAgICAgICAgICAgICAgIH0pKTsKCiAgICAgICAgICAgICAgICAgIGNhc2UgMjoKICAgICAgICAgICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQ1Ni5zdG9wKCk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9LCBfY2FsbGVlNTYpOwogICAgICAgICAgfSkpKCk7CiAgICAgICAgfSwKICAgICAgICB1cGRhdGVDYXRlZ29yeUlkT2ZQcm9kdWN0SWQ6IGZ1bmN0aW9uIHVwZGF0ZUNhdGVnb3J5SWRPZlByb2R1Y3RJZChjb250ZXh0KSB7CiAgICAgICAgICB2YXIgX2FyZ3VtZW50czI5ID0gYXJndW1lbnRzOwogICAgICAgICAgcmV0dXJuIF9hc3luY1RvR2VuZXJhdG9yKCAvKiNfX1BVUkVfXyovcmVnZW5lcmF0b3JSdW50aW1lLm1hcmsoZnVuY3Rpb24gX2NhbGxlZTU3KCkgewogICAgICAgICAgICB2YXIgYXJnOwogICAgICAgICAgICByZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLndyYXAoZnVuY3Rpb24gX2NhbGxlZTU3JChfY29udGV4dDU3KSB7CiAgICAgICAgICAgICAgd2hpbGUgKDEpIHsKICAgICAgICAgICAgICAgIHN3aXRjaCAoX2NvbnRleHQ1Ny5wcmV2ID0gX2NvbnRleHQ1Ny5uZXh0KSB7CiAgICAgICAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICAgICAgICBhcmcgPSBfYXJndW1lbnRzMjkubGVuZ3RoID4gMSAmJiBfYXJndW1lbnRzMjlbMV0gIT09IHVuZGVmaW5lZCA/IF9hcmd1bWVudHMyOVsxXSA6IHsKICAgICAgICAgICAgICAgICAgICAgIHByb2R1Y3RJZDogcHJvZHVjdElkLAogICAgICAgICAgICAgICAgICAgICAgY2F0ZWdvcnlJZDogY2F0ZWdvcnlJZAogICAgICAgICAgICAgICAgICAgIH07CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0NTcuYWJydXB0KCJyZXR1cm4iLCBwcm9kdWN0U3RvcmUuZGlzcGF0Y2goInVwZGF0ZUNhdGVnb3J5SWRPZklkIiwgewogICAgICAgICAgICAgICAgICAgICAgaWQ6IGFyZy5wcm9kdWN0SWQsCiAgICAgICAgICAgICAgICAgICAgICBjYXRlZ29yeUlkOiBhcmcuY2F0ZWdvcnlJZAogICAgICAgICAgICAgICAgICAgIH0pKTsKCiAgICAgICAgICAgICAgICAgIGNhc2UgMjoKICAgICAgICAgICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQ1Ny5zdG9wKCk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9LCBfY2FsbGVlNTcpOwogICAgICAgICAgfSkpKCk7CiAgICAgICAgfSwKICAgICAgICB1cGRhdGVBdmFpbGFiaWxpdHlPZlByb2R1Y3RJZDogZnVuY3Rpb24gdXBkYXRlQXZhaWxhYmlsaXR5T2ZQcm9kdWN0SWQoY29udGV4dCkgewogICAgICAgICAgdmFyIF9hcmd1bWVudHMzMCA9IGFyZ3VtZW50czsKICAgICAgICAgIHJldHVybiBfYXN5bmNUb0dlbmVyYXRvciggLyojX19QVVJFX18qL3JlZ2VuZXJhdG9yUnVudGltZS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWU1OCgpIHsKICAgICAgICAgICAgdmFyIGFyZzsKICAgICAgICAgICAgcmV0dXJuIHJlZ2VuZXJhdG9yUnVudGltZS53cmFwKGZ1bmN0aW9uIF9jYWxsZWU1OCQoX2NvbnRleHQ1OCkgewogICAgICAgICAgICAgIHdoaWxlICgxKSB7CiAgICAgICAgICAgICAgICBzd2l0Y2ggKF9jb250ZXh0NTgucHJldiA9IF9jb250ZXh0NTgubmV4dCkgewogICAgICAgICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgICAgICAgYXJnID0gX2FyZ3VtZW50czMwLmxlbmd0aCA+IDEgJiYgX2FyZ3VtZW50czMwWzFdICE9PSB1bmRlZmluZWQgPyBfYXJndW1lbnRzMzBbMV0gOiB7CiAgICAgICAgICAgICAgICAgICAgICBwcm9kdWN0SWQ6IHByb2R1Y3RJZCwKICAgICAgICAgICAgICAgICAgICAgIGlzQXZhaWxhYmxlOiBpc0F2YWlsYWJsZQogICAgICAgICAgICAgICAgICAgIH07CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0NTguYWJydXB0KCJyZXR1cm4iLCBwcm9kdWN0U3RvcmUuZGlzcGF0Y2goInVwZGF0ZUF2YWlsYWJpbGl0eU9mSWQiLCB7CiAgICAgICAgICAgICAgICAgICAgICBpZDogYXJnLnByb2R1Y3RJZCwKICAgICAgICAgICAgICAgICAgICAgIGlzQXZhaWxhYmxlOiBhcmcuaXNBdmFpbGFibGUKICAgICAgICAgICAgICAgICAgICB9KSk7CgogICAgICAgICAgICAgICAgICBjYXNlIDI6CiAgICAgICAgICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0NTguc3RvcCgpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSwgX2NhbGxlZTU4KTsKICAgICAgICAgIH0pKSgpOwogICAgICAgIH0sCiAgICAgICAgdXBkYXRlU2Vjb25kSGFuZE9mUHJvZHVjdElkOiBmdW5jdGlvbiB1cGRhdGVTZWNvbmRIYW5kT2ZQcm9kdWN0SWQoY29udGV4dCkgewogICAgICAgICAgdmFyIF9hcmd1bWVudHMzMSA9IGFyZ3VtZW50czsKICAgICAgICAgIHJldHVybiBfYXN5bmNUb0dlbmVyYXRvciggLyojX19QVVJFX18qL3JlZ2VuZXJhdG9yUnVudGltZS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWU1OSgpIHsKICAgICAgICAgICAgdmFyIGFyZzsKICAgICAgICAgICAgcmV0dXJuIHJlZ2VuZXJhdG9yUnVudGltZS53cmFwKGZ1bmN0aW9uIF9jYWxsZWU1OSQoX2NvbnRleHQ1OSkgewogICAgICAgICAgICAgIHdoaWxlICgxKSB7CiAgICAgICAgICAgICAgICBzd2l0Y2ggKF9jb250ZXh0NTkucHJldiA9IF9jb250ZXh0NTkubmV4dCkgewogICAgICAgICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgICAgICAgYXJnID0gX2FyZ3VtZW50czMxLmxlbmd0aCA+IDEgJiYgX2FyZ3VtZW50czMxWzFdICE9PSB1bmRlZmluZWQgPyBfYXJndW1lbnRzMzFbMV0gOiB7CiAgICAgICAgICAgICAgICAgICAgICBwcm9kdWN0SWQ6IHByb2R1Y3RJZCwKICAgICAgICAgICAgICAgICAgICAgIGlzU2Vjb25kSGFuZDogaXNTZWNvbmRIYW5kCiAgICAgICAgICAgICAgICAgICAgfTsKICAgICAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQ1OS5hYnJ1cHQoInJldHVybiIsIHByb2R1Y3RTdG9yZS5kaXNwYXRjaCgidXBkYXRlU2Vjb25kSGFuZE9mSWQiLCB7CiAgICAgICAgICAgICAgICAgICAgICBpZDogYXJnLnByb2R1Y3RJZCwKICAgICAgICAgICAgICAgICAgICAgIGlzU2Vjb25kSGFuZDogYXJnLmlzU2Vjb25kSGFuZAogICAgICAgICAgICAgICAgICAgIH0pKTsKCiAgICAgICAgICAgICAgICAgIGNhc2UgMjoKICAgICAgICAgICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQ1OS5zdG9wKCk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9LCBfY2FsbGVlNTkpOwogICAgICAgICAgfSkpKCk7CiAgICAgICAgfSwKICAgICAgICB1cGRhdGVQcmljZU9mUHJvZHVjdElkOiBmdW5jdGlvbiB1cGRhdGVQcmljZU9mUHJvZHVjdElkKGNvbnRleHQpIHsKICAgICAgICAgIHZhciBfYXJndW1lbnRzMzIgPSBhcmd1bWVudHM7CiAgICAgICAgICByZXR1cm4gX2FzeW5jVG9HZW5lcmF0b3IoIC8qI19fUFVSRV9fKi9yZWdlbmVyYXRvclJ1bnRpbWUubWFyayhmdW5jdGlvbiBfY2FsbGVlNjAoKSB7CiAgICAgICAgICAgIHZhciBhcmc7CiAgICAgICAgICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUud3JhcChmdW5jdGlvbiBfY2FsbGVlNjAkKF9jb250ZXh0NjApIHsKICAgICAgICAgICAgICB3aGlsZSAoMSkgewogICAgICAgICAgICAgICAgc3dpdGNoIChfY29udGV4dDYwLnByZXYgPSBfY29udGV4dDYwLm5leHQpIHsKICAgICAgICAgICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICAgICAgICAgIGFyZyA9IF9hcmd1bWVudHMzMi5sZW5ndGggPiAxICYmIF9hcmd1bWVudHMzMlsxXSAhPT0gdW5kZWZpbmVkID8gX2FyZ3VtZW50czMyWzFdIDogewogICAgICAgICAgICAgICAgICAgICAgcHJvZHVjdElkOiBwcm9kdWN0SWQsCiAgICAgICAgICAgICAgICAgICAgICBwcmljZTogcHJpY2UKICAgICAgICAgICAgICAgICAgICB9OwogICAgICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDYwLmFicnVwdCgicmV0dXJuIiwgcHJvZHVjdFN0b3JlLmRpc3BhdGNoKCJ1cGRhdGVQcmljZU9mSWQiLCB7CiAgICAgICAgICAgICAgICAgICAgICBpZDogYXJnLnByb2R1Y3RJZCwKICAgICAgICAgICAgICAgICAgICAgIHByaWNlOiBhcmcucHJpY2UKICAgICAgICAgICAgICAgICAgICB9KSk7CgogICAgICAgICAgICAgICAgICBjYXNlIDI6CiAgICAgICAgICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0NjAuc3RvcCgpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSwgX2NhbGxlZTYwKTsKICAgICAgICAgIH0pKSgpOwogICAgICAgIH0sCiAgICAgICAgYWRkQnVuZGxlT2ZQcm9kdWN0SWQ6IGZ1bmN0aW9uIGFkZEJ1bmRsZU9mUHJvZHVjdElkKGNvbnRleHQpIHsKICAgICAgICAgIHZhciBfYXJndW1lbnRzMzMgPSBhcmd1bWVudHM7CiAgICAgICAgICByZXR1cm4gX2FzeW5jVG9HZW5lcmF0b3IoIC8qI19fUFVSRV9fKi9yZWdlbmVyYXRvclJ1bnRpbWUubWFyayhmdW5jdGlvbiBfY2FsbGVlNjEoKSB7CiAgICAgICAgICAgIHZhciBhcmc7CiAgICAgICAgICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUud3JhcChmdW5jdGlvbiBfY2FsbGVlNjEkKF9jb250ZXh0NjEpIHsKICAgICAgICAgICAgICB3aGlsZSAoMSkgewogICAgICAgICAgICAgICAgc3dpdGNoIChfY29udGV4dDYxLnByZXYgPSBfY29udGV4dDYxLm5leHQpIHsKICAgICAgICAgICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICAgICAgICAgIGFyZyA9IF9hcmd1bWVudHMzMy5sZW5ndGggPiAxICYmIF9hcmd1bWVudHMzM1sxXSAhPT0gdW5kZWZpbmVkID8gX2FyZ3VtZW50czMzWzFdIDogewogICAgICAgICAgICAgICAgICAgICAgcHJvZHVjdElkOiBwcm9kdWN0SWQsCiAgICAgICAgICAgICAgICAgICAgICBidW5kbGU6IGJ1bmRsZQogICAgICAgICAgICAgICAgICAgIH07CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0NjEuYWJydXB0KCJyZXR1cm4iLCBwcm9kdWN0U3RvcmUuZGlzcGF0Y2goImFkZEJ1bmRsZU9mSWQiLCB7CiAgICAgICAgICAgICAgICAgICAgICBpZDogYXJnLnByb2R1Y3RJZCwKICAgICAgICAgICAgICAgICAgICAgIGJ1bmRsZTogYXJnLmJ1bmRsZQogICAgICAgICAgICAgICAgICAgIH0pKTsKCiAgICAgICAgICAgICAgICAgIGNhc2UgMjoKICAgICAgICAgICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQ2MS5zdG9wKCk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9LCBfY2FsbGVlNjEpOwogICAgICAgICAgfSkpKCk7CiAgICAgICAgfSwKICAgICAgICBkZWxldGVCdW5kbGVPZlByb2R1Y3RJZDogZnVuY3Rpb24gZGVsZXRlQnVuZGxlT2ZQcm9kdWN0SWQoY29udGV4dCkgewogICAgICAgICAgdmFyIF9hcmd1bWVudHMzNCA9IGFyZ3VtZW50czsKICAgICAgICAgIHJldHVybiBfYXN5bmNUb0dlbmVyYXRvciggLyojX19QVVJFX18qL3JlZ2VuZXJhdG9yUnVudGltZS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWU2MigpIHsKICAgICAgICAgICAgdmFyIGFyZzsKICAgICAgICAgICAgcmV0dXJuIHJlZ2VuZXJhdG9yUnVudGltZS53cmFwKGZ1bmN0aW9uIF9jYWxsZWU2MiQoX2NvbnRleHQ2MikgewogICAgICAgICAgICAgIHdoaWxlICgxKSB7CiAgICAgICAgICAgICAgICBzd2l0Y2ggKF9jb250ZXh0NjIucHJldiA9IF9jb250ZXh0NjIubmV4dCkgewogICAgICAgICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgICAgICAgYXJnID0gX2FyZ3VtZW50czM0Lmxlbmd0aCA+IDEgJiYgX2FyZ3VtZW50czM0WzFdICE9PSB1bmRlZmluZWQgPyBfYXJndW1lbnRzMzRbMV0gOiB7CiAgICAgICAgICAgICAgICAgICAgICBwcm9kdWN0SWQ6IHByb2R1Y3RJZCwKICAgICAgICAgICAgICAgICAgICAgIGJ1bmRsZTogYnVuZGxlCiAgICAgICAgICAgICAgICAgICAgfTsKICAgICAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQ2Mi5hYnJ1cHQoInJldHVybiIsIHByb2R1Y3RTdG9yZS5kaXNwYXRjaCgicmVtb3ZlQnVuZGxlT2ZJZCIsIHsKICAgICAgICAgICAgICAgICAgICAgIGlkOiBhcmcucHJvZHVjdElkLAogICAgICAgICAgICAgICAgICAgICAgYnVuZGxlOiBhcmcuYnVuZGxlCiAgICAgICAgICAgICAgICAgICAgfSkpOwoKICAgICAgICAgICAgICAgICAgY2FzZSAyOgogICAgICAgICAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDYyLnN0b3AoKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0sIF9jYWxsZWU2Mik7CiAgICAgICAgICB9KSkoKTsKICAgICAgICB9LAogICAgICAgIGFkZEdpZnRPZlByb2R1Y3RJZDogZnVuY3Rpb24gYWRkR2lmdE9mUHJvZHVjdElkKGNvbnRleHQpIHsKICAgICAgICAgIHZhciBfYXJndW1lbnRzMzUgPSBhcmd1bWVudHM7CiAgICAgICAgICByZXR1cm4gX2FzeW5jVG9HZW5lcmF0b3IoIC8qI19fUFVSRV9fKi9yZWdlbmVyYXRvclJ1bnRpbWUubWFyayhmdW5jdGlvbiBfY2FsbGVlNjMoKSB7CiAgICAgICAgICAgIHZhciBhcmc7CiAgICAgICAgICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUud3JhcChmdW5jdGlvbiBfY2FsbGVlNjMkKF9jb250ZXh0NjMpIHsKICAgICAgICAgICAgICB3aGlsZSAoMSkgewogICAgICAgICAgICAgICAgc3dpdGNoIChfY29udGV4dDYzLnByZXYgPSBfY29udGV4dDYzLm5leHQpIHsKICAgICAgICAgICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICAgICAgICAgIGFyZyA9IF9hcmd1bWVudHMzNS5sZW5ndGggPiAxICYmIF9hcmd1bWVudHMzNVsxXSAhPT0gdW5kZWZpbmVkID8gX2FyZ3VtZW50czM1WzFdIDogewogICAgICAgICAgICAgICAgICAgICAgcHJvZHVjdElkOiBwcm9kdWN0SWQsCiAgICAgICAgICAgICAgICAgICAgICBnaWZ0OiBnaWZ0CiAgICAgICAgICAgICAgICAgICAgfTsKICAgICAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQ2My5hYnJ1cHQoInJldHVybiIsIHByb2R1Y3RTdG9yZS5kaXNwYXRjaCgiYWRkR2lmdE9mSWQiLCB7CiAgICAgICAgICAgICAgICAgICAgICBpZDogYXJnLnByb2R1Y3RJZCwKICAgICAgICAgICAgICAgICAgICAgIGdpZnQ6IGFyZy5naWZ0CiAgICAgICAgICAgICAgICAgICAgfSkpOwoKICAgICAgICAgICAgICAgICAgY2FzZSAyOgogICAgICAgICAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDYzLnN0b3AoKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0sIF9jYWxsZWU2Myk7CiAgICAgICAgICB9KSkoKTsKICAgICAgICB9LAogICAgICAgIGRlbGV0ZUdpZnRPZlByb2R1Y3RJZDogZnVuY3Rpb24gZGVsZXRlR2lmdE9mUHJvZHVjdElkKGNvbnRleHQpIHsKICAgICAgICAgIHZhciBfYXJndW1lbnRzMzYgPSBhcmd1bWVudHM7CiAgICAgICAgICByZXR1cm4gX2FzeW5jVG9HZW5lcmF0b3IoIC8qI19fUFVSRV9fKi9yZWdlbmVyYXRvclJ1bnRpbWUubWFyayhmdW5jdGlvbiBfY2FsbGVlNjQoKSB7CiAgICAgICAgICAgIHZhciBhcmc7CiAgICAgICAgICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUud3JhcChmdW5jdGlvbiBfY2FsbGVlNjQkKF9jb250ZXh0NjQpIHsKICAgICAgICAgICAgICB3aGlsZSAoMSkgewogICAgICAgICAgICAgICAgc3dpdGNoIChfY29udGV4dDY0LnByZXYgPSBfY29udGV4dDY0Lm5leHQpIHsKICAgICAgICAgICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICAgICAgICAgIGFyZyA9IF9hcmd1bWVudHMzNi5sZW5ndGggPiAxICYmIF9hcmd1bWVudHMzNlsxXSAhPT0gdW5kZWZpbmVkID8gX2FyZ3VtZW50czM2WzFdIDogewogICAgICAgICAgICAgICAgICAgICAgcHJvZHVjdElkOiBwcm9kdWN0SWQsCiAgICAgICAgICAgICAgICAgICAgICBnaWZ0OiBnaWZ0CiAgICAgICAgICAgICAgICAgICAgfTsKICAgICAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQ2NC5hYnJ1cHQoInJldHVybiIsIHByb2R1Y3RTdG9yZS5kaXNwYXRjaCgicmVtb3ZlR2lmdE9mSWQiLCB7CiAgICAgICAgICAgICAgICAgICAgICBpZDogYXJnLnByb2R1Y3RJZCwKICAgICAgICAgICAgICAgICAgICAgIGdpZnQ6IGFyZy5naWZ0CiAgICAgICAgICAgICAgICAgICAgfSkpOwoKICAgICAgICAgICAgICAgICAgY2FzZSAyOgogICAgICAgICAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDY0LnN0b3AoKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0sIF9jYWxsZWU2NCk7CiAgICAgICAgICB9KSkoKTsKICAgICAgICB9LAogICAgICAgIGFkZFNwZWNpZmljYXRpb25PZlByb2R1Y3RJZDogZnVuY3Rpb24gYWRkU3BlY2lmaWNhdGlvbk9mUHJvZHVjdElkKGNvbnRleHQpIHsKICAgICAgICAgIHZhciBfYXJndW1lbnRzMzcgPSBhcmd1bWVudHM7CiAgICAgICAgICByZXR1cm4gX2FzeW5jVG9HZW5lcmF0b3IoIC8qI19fUFVSRV9fKi9yZWdlbmVyYXRvclJ1bnRpbWUubWFyayhmdW5jdGlvbiBfY2FsbGVlNjUoKSB7CiAgICAgICAgICAgIHZhciBhcmc7CiAgICAgICAgICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUud3JhcChmdW5jdGlvbiBfY2FsbGVlNjUkKF9jb250ZXh0NjUpIHsKICAgICAgICAgICAgICB3aGlsZSAoMSkgewogICAgICAgICAgICAgICAgc3dpdGNoIChfY29udGV4dDY1LnByZXYgPSBfY29udGV4dDY1Lm5leHQpIHsKICAgICAgICAgICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICAgICAgICAgIGFyZyA9IF9hcmd1bWVudHMzNy5sZW5ndGggPiAxICYmIF9hcmd1bWVudHMzN1sxXSAhPT0gdW5kZWZpbmVkID8gX2FyZ3VtZW50czM3WzFdIDogewogICAgICAgICAgICAgICAgICAgICAgcHJvZHVjdElkOiBwcm9kdWN0SWQsCiAgICAgICAgICAgICAgICAgICAgICBzcGVjaWZpY2F0aW9uOiBzcGVjaWZpY2F0aW9uCiAgICAgICAgICAgICAgICAgICAgfTsKICAgICAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQ2NS5hYnJ1cHQoInJldHVybiIsIHByb2R1Y3RTdG9yZS5kaXNwYXRjaCgiYWRkU3BlY2lmaWNhdGlvbk9mSWQiLCB7CiAgICAgICAgICAgICAgICAgICAgICBpZDogYXJnLnByb2R1Y3RJZCwKICAgICAgICAgICAgICAgICAgICAgIHNwZWNpZmljYXRpb246IGFyZy5zcGVjaWZpY2F0aW9uCiAgICAgICAgICAgICAgICAgICAgfSkpOwoKICAgICAgICAgICAgICAgICAgY2FzZSAyOgogICAgICAgICAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDY1LnN0b3AoKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0sIF9jYWxsZWU2NSk7CiAgICAgICAgICB9KSkoKTsKICAgICAgICB9LAogICAgICAgIGRlbGV0ZVNwZWNpZmljYXRpb25PZlByb2R1Y3RJZDogZnVuY3Rpb24gZGVsZXRlU3BlY2lmaWNhdGlvbk9mUHJvZHVjdElkKGNvbnRleHQpIHsKICAgICAgICAgIHZhciBfYXJndW1lbnRzMzggPSBhcmd1bWVudHM7CiAgICAgICAgICByZXR1cm4gX2FzeW5jVG9HZW5lcmF0b3IoIC8qI19fUFVSRV9fKi9yZWdlbmVyYXRvclJ1bnRpbWUubWFyayhmdW5jdGlvbiBfY2FsbGVlNjYoKSB7CiAgICAgICAgICAgIHZhciBhcmc7CiAgICAgICAgICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUud3JhcChmdW5jdGlvbiBfY2FsbGVlNjYkKF9jb250ZXh0NjYpIHsKICAgICAgICAgICAgICB3aGlsZSAoMSkgewogICAgICAgICAgICAgICAgc3dpdGNoIChfY29udGV4dDY2LnByZXYgPSBfY29udGV4dDY2Lm5leHQpIHsKICAgICAgICAgICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICAgICAgICAgIGFyZyA9IF9hcmd1bWVudHMzOC5sZW5ndGggPiAxICYmIF9hcmd1bWVudHMzOFsxXSAhPT0gdW5kZWZpbmVkID8gX2FyZ3VtZW50czM4WzFdIDogewogICAgICAgICAgICAgICAgICAgICAgcHJvZHVjdElkOiBwcm9kdWN0SWQsCiAgICAgICAgICAgICAgICAgICAgICBzcGVjaWZpY2F0aW9uOiBzcGVjaWZpY2F0aW9uCiAgICAgICAgICAgICAgICAgICAgfTsKICAgICAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQ2Ni5hYnJ1cHQoInJldHVybiIsIHByb2R1Y3RTdG9yZS5kaXNwYXRjaCgicmVtb3ZlU3BlY2lmaWNhdGlvbk9mSWQiLCB7CiAgICAgICAgICAgICAgICAgICAgICBpZDogYXJnLnByb2R1Y3RJZCwKICAgICAgICAgICAgICAgICAgICAgIHNwZWNpZmljYXRpb246IGFyZy5zcGVjaWZpY2F0aW9uCiAgICAgICAgICAgICAgICAgICAgfSkpOwoKICAgICAgICAgICAgICAgICAgY2FzZSAyOgogICAgICAgICAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDY2LnN0b3AoKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0sIF9jYWxsZWU2Nik7CiAgICAgICAgICB9KSkoKTsKICAgICAgICB9LAogICAgICAgIHVwZGF0ZVNwZWNpZmljYXRpb25zT2ZQcm9kdWN0SWQ6IGZ1bmN0aW9uIHVwZGF0ZVNwZWNpZmljYXRpb25zT2ZQcm9kdWN0SWQoY29udGV4dCkgewogICAgICAgICAgdmFyIF9hcmd1bWVudHMzOSA9IGFyZ3VtZW50czsKICAgICAgICAgIHJldHVybiBfYXN5bmNUb0dlbmVyYXRvciggLyojX19QVVJFX18qL3JlZ2VuZXJhdG9yUnVudGltZS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWU2NygpIHsKICAgICAgICAgICAgdmFyIGFyZzsKICAgICAgICAgICAgcmV0dXJuIHJlZ2VuZXJhdG9yUnVudGltZS53cmFwKGZ1bmN0aW9uIF9jYWxsZWU2NyQoX2NvbnRleHQ2NykgewogICAgICAgICAgICAgIHdoaWxlICgxKSB7CiAgICAgICAgICAgICAgICBzd2l0Y2ggKF9jb250ZXh0NjcucHJldiA9IF9jb250ZXh0NjcubmV4dCkgewogICAgICAgICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgICAgICAgYXJnID0gX2FyZ3VtZW50czM5Lmxlbmd0aCA+IDEgJiYgX2FyZ3VtZW50czM5WzFdICE9PSB1bmRlZmluZWQgPyBfYXJndW1lbnRzMzlbMV0gOiB7CiAgICAgICAgICAgICAgICAgICAgICBwcm9kdWN0SWQ6IHByb2R1Y3RJZCwKICAgICAgICAgICAgICAgICAgICAgIHNwZWNpZmljYXRpb25zOiBzcGVjaWZpY2F0aW9ucwogICAgICAgICAgICAgICAgICAgIH07CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0NjcuYWJydXB0KCJyZXR1cm4iLCBwcm9kdWN0U3RvcmUuZGlzcGF0Y2goInVwZGF0ZVNwZWNpZmljYXRpb25zT2ZJZCIsIHsKICAgICAgICAgICAgICAgICAgICAgIGlkOiBhcmcucHJvZHVjdElkLAogICAgICAgICAgICAgICAgICAgICAgc3BlY2lmaWNhdGlvbnM6IGFyZy5zcGVjaWZpY2F0aW9ucwogICAgICAgICAgICAgICAgICAgIH0pKTsKCiAgICAgICAgICAgICAgICAgIGNhc2UgMjoKICAgICAgICAgICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQ2Ny5zdG9wKCk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9LCBfY2FsbGVlNjcpOwogICAgICAgICAgfSkpKCk7CiAgICAgICAgfSwKICAgICAgICBhZGRJbWFnZU9mUHJvZHVjdElkOiBmdW5jdGlvbiBhZGRJbWFnZU9mUHJvZHVjdElkKGNvbnRleHQpIHsKICAgICAgICAgIHZhciBfYXJndW1lbnRzNDAgPSBhcmd1bWVudHM7CiAgICAgICAgICByZXR1cm4gX2FzeW5jVG9HZW5lcmF0b3IoIC8qI19fUFVSRV9fKi9yZWdlbmVyYXRvclJ1bnRpbWUubWFyayhmdW5jdGlvbiBfY2FsbGVlNjgoKSB7CiAgICAgICAgICAgIHZhciBhcmc7CiAgICAgICAgICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUud3JhcChmdW5jdGlvbiBfY2FsbGVlNjgkKF9jb250ZXh0NjgpIHsKICAgICAgICAgICAgICB3aGlsZSAoMSkgewogICAgICAgICAgICAgICAgc3dpdGNoIChfY29udGV4dDY4LnByZXYgPSBfY29udGV4dDY4Lm5leHQpIHsKICAgICAgICAgICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICAgICAgICAgIGFyZyA9IF9hcmd1bWVudHM0MC5sZW5ndGggPiAxICYmIF9hcmd1bWVudHM0MFsxXSAhPT0gdW5kZWZpbmVkID8gX2FyZ3VtZW50czQwWzFdIDogewogICAgICAgICAgICAgICAgICAgICAgcHJvZHVjdElkOiBwcm9kdWN0SWQsCiAgICAgICAgICAgICAgICAgICAgICBpbWFnZUZpbGU6IGltYWdlRmlsZQogICAgICAgICAgICAgICAgICAgIH07CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0NjguYWJydXB0KCJyZXR1cm4iLCBwcm9kdWN0U3RvcmUuZGlzcGF0Y2goImFkZEltYWdlT2ZJZCIsIHsKICAgICAgICAgICAgICAgICAgICAgIGlkOiBhcmcucHJvZHVjdElkLAogICAgICAgICAgICAgICAgICAgICAgaW1hZ2VGaWxlOiBhcmcuaW1hZ2VGaWxlCiAgICAgICAgICAgICAgICAgICAgfSkpOwoKICAgICAgICAgICAgICAgICAgY2FzZSAyOgogICAgICAgICAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDY4LnN0b3AoKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0sIF9jYWxsZWU2OCk7CiAgICAgICAgICB9KSkoKTsKICAgICAgICB9LAogICAgICAgIGRlbGV0ZUltYWdlT2ZQcm9kdWN0SWQ6IGZ1bmN0aW9uIGRlbGV0ZUltYWdlT2ZQcm9kdWN0SWQoY29udGV4dCkgewogICAgICAgICAgdmFyIF9hcmd1bWVudHM0MSA9IGFyZ3VtZW50czsKICAgICAgICAgIHJldHVybiBfYXN5bmNUb0dlbmVyYXRvciggLyojX19QVVJFX18qL3JlZ2VuZXJhdG9yUnVudGltZS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWU2OSgpIHsKICAgICAgICAgICAgdmFyIGFyZzsKICAgICAgICAgICAgcmV0dXJuIHJlZ2VuZXJhdG9yUnVudGltZS53cmFwKGZ1bmN0aW9uIF9jYWxsZWU2OSQoX2NvbnRleHQ2OSkgewogICAgICAgICAgICAgIHdoaWxlICgxKSB7CiAgICAgICAgICAgICAgICBzd2l0Y2ggKF9jb250ZXh0NjkucHJldiA9IF9jb250ZXh0NjkubmV4dCkgewogICAgICAgICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgICAgICAgYXJnID0gX2FyZ3VtZW50czQxLmxlbmd0aCA+IDEgJiYgX2FyZ3VtZW50czQxWzFdICE9PSB1bmRlZmluZWQgPyBfYXJndW1lbnRzNDFbMV0gOiB7CiAgICAgICAgICAgICAgICAgICAgICBwcm9kdWN0SWQ6IHByb2R1Y3RJZCwKICAgICAgICAgICAgICAgICAgICAgIGltYWdlOiBpbWFnZQogICAgICAgICAgICAgICAgICAgIH07CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0NjkuYWJydXB0KCJyZXR1cm4iLCBwcm9kdWN0U3RvcmUuZGlzcGF0Y2goInJlbW92ZUltYWdlT2ZJZCIsIHsKICAgICAgICAgICAgICAgICAgICAgIGlkOiBhcmcucHJvZHVjdElkLAogICAgICAgICAgICAgICAgICAgICAgaW1hZ2U6IGFyZy5pbWFnZQogICAgICAgICAgICAgICAgICAgIH0pKTsKCiAgICAgICAgICAgICAgICAgIGNhc2UgMjoKICAgICAgICAgICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQ2OS5zdG9wKCk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9LCBfY2FsbGVlNjkpOwogICAgICAgICAgfSkpKCk7CiAgICAgICAgfSwKICAgICAgICBnZXRQcm9kdWN0Q29tYm9CeUlEOiBmdW5jdGlvbiBnZXRQcm9kdWN0Q29tYm9CeUlEKGNvbnRleHQpIHsKICAgICAgICAgIHZhciBfYXJndW1lbnRzNDIgPSBhcmd1bWVudHM7CiAgICAgICAgICByZXR1cm4gX2FzeW5jVG9HZW5lcmF0b3IoIC8qI19fUFVSRV9fKi9yZWdlbmVyYXRvclJ1bnRpbWUubWFyayhmdW5jdGlvbiBfY2FsbGVlNzAoKSB7CiAgICAgICAgICAgIHZhciBhcmc7CiAgICAgICAgICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUud3JhcChmdW5jdGlvbiBfY2FsbGVlNzAkKF9jb250ZXh0NzApIHsKICAgICAgICAgICAgICB3aGlsZSAoMSkgewogICAgICAgICAgICAgICAgc3dpdGNoIChfY29udGV4dDcwLnByZXYgPSBfY29udGV4dDcwLm5leHQpIHsKICAgICAgICAgICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICAgICAgICAgIGFyZyA9IF9hcmd1bWVudHM0Mi5sZW5ndGggPiAxICYmIF9hcmd1bWVudHM0MlsxXSAhPT0gdW5kZWZpbmVkID8gX2FyZ3VtZW50czQyWzFdIDogewogICAgICAgICAgICAgICAgICAgICAgaWQ6IGlkLAogICAgICAgICAgICAgICAgICAgICAgcHJldmVudFJlZnJlc2g6IGZhbHNlCiAgICAgICAgICAgICAgICAgICAgfTsKICAgICAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQ3MC5hYnJ1cHQoInJldHVybiIsIHByb2R1Y3RTdG9yZS5kaXNwYXRjaCgiZ2V0SXRlbU9mSWQiLCBhcmcpKTsKCiAgICAgICAgICAgICAgICAgIGNhc2UgMjoKICAgICAgICAgICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQ3MC5zdG9wKCk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9LCBfY2FsbGVlNzApOwogICAgICAgICAgfSkpKCk7CiAgICAgICAgfQogICAgICB9CiAgICB9KTsKICAgIFByb2R1Y3QuQnJhbmRTdG9yZSA9IFN0b3Jlcy5icmFuZDsKICAgIFByb2R1Y3QuU3BlY2lmaWNhdGlvblN0b3JlID0gU3RvcmVzLnNwZWNpZmljYXRpb247CiAgICBQcm9kdWN0U3BlY0NvbnRlbnQuU3BlY2lmaWNhdGlvblN0b3JlID0gU3RvcmVzLnNwZWNpZmljYXRpb247CiAgICBQcm9kdWN0LlByb2R1Y3RTdG9yZSA9IHN0b3JlOwogICAgU3RvcmVzLnNwZWNpZmljYXRpb24uZGlzcGF0Y2goInJlZnJlc2giKTsKICAgIHJldHVybiBzdG9yZTsKICB9Cn07"},null]}