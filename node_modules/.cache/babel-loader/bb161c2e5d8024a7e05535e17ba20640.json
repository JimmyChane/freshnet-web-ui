{"remainingRequest":"C:\\development\\freshnet-v2\\vue\\node_modules\\babel-loader\\lib\\index.js!C:\\development\\freshnet-v2\\express\\data_structures\\Product.js","dependencies":[{"path":"C:\\development\\freshnet-v2\\express\\data_structures\\Product.js","mtime":1662650897379},{"path":"C:\\development\\freshnet-v2\\vue\\babel.config.js","mtime":1662650914175},{"path":"C:\\development\\freshnet-v2\\vue\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1662650916242},{"path":"C:\\development\\freshnet-v2\\vue\\node_modules\\babel-loader\\lib\\index.js","mtime":1662650915901}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:dmFyIF90b0NvbnN1bWFibGVBcnJheSA9IHJlcXVpcmUoIkM6XFxkZXZlbG9wbWVudFxcZnJlc2huZXQtdjJcXHZ1ZVxcbm9kZV9tb2R1bGVzXFxAYmFiZWxcXHJ1bnRpbWVcXGhlbHBlcnNcXHRvQ29uc3VtYWJsZUFycmF5LmpzIikuZGVmYXVsdDsKCnZhciBfY3JlYXRlRm9yT2ZJdGVyYXRvckhlbHBlciA9IHJlcXVpcmUoIkM6XFxkZXZlbG9wbWVudFxcZnJlc2huZXQtdjJcXHZ1ZVxcbm9kZV9tb2R1bGVzXFxAYmFiZWxcXHJ1bnRpbWVcXGhlbHBlcnNcXGNyZWF0ZUZvck9mSXRlcmF0b3JIZWxwZXIuanMiKS5kZWZhdWx0OwoKdmFyIF90eXBlb2YgPSByZXF1aXJlKCJDOlxcZGV2ZWxvcG1lbnRcXGZyZXNobmV0LXYyXFx2dWVcXG5vZGVfbW9kdWxlc1xcQGJhYmVsXFxydW50aW1lXFxoZWxwZXJzXFx0eXBlb2YuanMiKS5kZWZhdWx0OwoKdmFyIF9jbGFzc0NhbGxDaGVjayA9IHJlcXVpcmUoIkM6XFxkZXZlbG9wbWVudFxcZnJlc2huZXQtdjJcXHZ1ZVxcbm9kZV9tb2R1bGVzXFxAYmFiZWxcXHJ1bnRpbWVcXGhlbHBlcnNcXGNsYXNzQ2FsbENoZWNrLmpzIikuZGVmYXVsdDsKCnZhciBfY3JlYXRlQ2xhc3MgPSByZXF1aXJlKCJDOlxcZGV2ZWxvcG1lbnRcXGZyZXNobmV0LXYyXFx2dWVcXG5vZGVfbW9kdWxlc1xcQGJhYmVsXFxydW50aW1lXFxoZWxwZXJzXFxjcmVhdGVDbGFzcy5qcyIpLmRlZmF1bHQ7Cgp2YXIgX2NsYXNzU3RhdGljUHJpdmF0ZU1ldGhvZEdldCA9IHJlcXVpcmUoIkM6XFxkZXZlbG9wbWVudFxcZnJlc2huZXQtdjJcXHZ1ZVxcbm9kZV9tb2R1bGVzXFxAYmFiZWxcXHJ1bnRpbWVcXGhlbHBlcnNcXGNsYXNzU3RhdGljUHJpdmF0ZU1ldGhvZEdldC5qcyIpLmRlZmF1bHQ7CgpyZXF1aXJlKCJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuaW5jbHVkZXMuanMiKTsKCnJlcXVpcmUoImNvcmUtanMvbW9kdWxlcy9lcy5zdHJpbmcuaW5jbHVkZXMuanMiKTsKCnJlcXVpcmUoImNvcmUtanMvbW9kdWxlcy9lcy5yZWdleHAuZXhlYy5qcyIpOwoKcmVxdWlyZSgiY29yZS1qcy9tb2R1bGVzL2VzLnN0cmluZy5yZXBsYWNlLmpzIik7CgpyZXF1aXJlKCJjb3JlLWpzL21vZHVsZXMvZXMuc3RyaW5nLnJlcGxhY2UtYWxsLmpzIik7CgpyZXF1aXJlKCJjb3JlLWpzL21vZHVsZXMvZXMuc3RyaW5nLnRyaW0uanMiKTsKCnJlcXVpcmUoImNvcmUtanMvbW9kdWxlcy9lcy5zeW1ib2wuanMiKTsKCnJlcXVpcmUoImNvcmUtanMvbW9kdWxlcy9lcy5zeW1ib2wuZGVzY3JpcHRpb24uanMiKTsKCnJlcXVpcmUoImNvcmUtanMvbW9kdWxlcy9lcy5hcnJheS5tYXAuanMiKTsKCnJlcXVpcmUoImNvcmUtanMvbW9kdWxlcy9lcy5hcnJheS5maWx0ZXIuanMiKTsKCnJlcXVpcmUoImNvcmUtanMvbW9kdWxlcy9lcy5vYmplY3QudG8tc3RyaW5nLmpzIik7CgpyZXF1aXJlKCJjb3JlLWpzL21vZHVsZXMvZXMub2JqZWN0LmtleXMuanMiKTsKCnZhciBUZXh0ID0gcmVxdWlyZSgiLi9UZXh0LmpzIik7Cgp2YXIgSW1hZ2UgPSByZXF1aXJlKCIuL0ltYWdlLmpzIik7Cgp2YXIgUHJvZHVjdFN0b2NrID0gcmVxdWlyZSgiLi9Qcm9kdWN0U3RvY2suanMiKTsKCnZhciBQcm9kdWN0QnVuZGxlID0gcmVxdWlyZSgiLi9Qcm9kdWN0QnVuZGxlLmpzIik7Cgp2YXIgUHJvZHVjdFByaWNlID0gcmVxdWlyZSgiLi9Qcm9kdWN0UHJpY2UuanMiKTsKCnZhciBQcm9kdWN0U3BlY2lmaWNhdGlvbiA9IHJlcXVpcmUoIi4vUHJvZHVjdFNwZWNpZmljYXRpb24uanMiKTsKCnZhciB0ZXh0Q29udGFpbnMgPSBmdW5jdGlvbiB0ZXh0Q29udGFpbnModGV4dCwga2V5d29yZCkgewogIHJldHVybiB0eXBlb2YgdGV4dCA9PSAic3RyaW5nIiAmJiB0ZXh0LnRvTG93ZXJDYXNlKCkucmVwbGFjZUFsbCgiICIsICIiKS5pbmNsdWRlcyhrZXl3b3JkKTsKfTsKCnZhciBQcm9kdWN0ID0gLyojX19QVVJFX18qL2Z1bmN0aW9uICgpIHsKICAidXNlIHN0cmljdCI7CgogIGZ1bmN0aW9uIFByb2R1Y3QoKSB7CiAgICB2YXIgZGF0YSA9IGFyZ3VtZW50cy5sZW5ndGggPiAwICYmIGFyZ3VtZW50c1swXSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzBdIDogbnVsbDsKCiAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgUHJvZHVjdCk7CgogICAgdGhpcy5faWQgPSBUZXh0LnRyaW0oZGF0YS5faWQsIGRhdGEuX2lkKTsKICAgIHRoaXMudGl0bGUgPSBUZXh0LnRyaW0oZGF0YS50aXRsZSk7CiAgICB0aGlzLmRlc2NyaXB0aW9uID0gVGV4dC50cmltKGRhdGEuZGVzY3JpcHRpb24pOwogICAgdGhpcy5jYXRlZ29yeUlkID0gVGV4dC50cmltKGRhdGEuY2F0ZWdvcnlJZCk7CiAgICB0aGlzLmJyYW5kSWQgPSBUZXh0LnRyaW0oZGF0YS5icmFuZElkKTsKICAgIHRoaXMuYnVuZGxlcyA9IChBcnJheS5pc0FycmF5KGRhdGEuYnVuZGxlcykgPyBkYXRhLmJ1bmRsZXMgOiBbXSkubWFwKGZ1bmN0aW9uIChidW5kbGUpIHsKICAgICAgcmV0dXJuIFByb2R1Y3RCdW5kbGUudHJpbShidW5kbGUpOwogICAgfSk7CiAgICB0aGlzLmdpZnRzID0gKEFycmF5LmlzQXJyYXkoZGF0YS5naWZ0cykgPyBkYXRhLmdpZnRzIDogW10pLm1hcChmdW5jdGlvbiAoZ2lmdCkgewogICAgICByZXR1cm4gVGV4dC50cmltKGdpZnQpOwogICAgfSkuZmlsdGVyKGZ1bmN0aW9uIChnaWZ0KSB7CiAgICAgIHJldHVybiBnaWZ0OwogICAgfSk7CiAgICB0aGlzLnN0b2NrID0gUHJvZHVjdFN0b2NrLnRyaW0oX3R5cGVvZihkYXRhLnN0b2NrKSA9PT0gIm9iamVjdCIgPyBkYXRhLnN0b2NrIDoge30pOwoKICAgIF9jbGFzc1N0YXRpY1ByaXZhdGVNZXRob2RHZXQoUHJvZHVjdCwgUHJvZHVjdCwgX3RyaW1JbWFnZSkuY2FsbChQcm9kdWN0LCB0aGlzLCBkYXRhKTsKCiAgICBfY2xhc3NTdGF0aWNQcml2YXRlTWV0aG9kR2V0KFByb2R1Y3QsIFByb2R1Y3QsIF90cmltU3BlY2lmaWNhdGlvbikuY2FsbChQcm9kdWN0LCB0aGlzLCBkYXRhKTsKCiAgICBfY2xhc3NTdGF0aWNQcml2YXRlTWV0aG9kR2V0KFByb2R1Y3QsIFByb2R1Y3QsIF90cmltUHJpY2UpLmNhbGwoUHJvZHVjdCwgdGhpcywgZGF0YSk7CiAgfQoKICBfY3JlYXRlQ2xhc3MoUHJvZHVjdCwgbnVsbCwgW3sKICAgIGtleTogInNlYXJjaCIsCiAgICB2YWx1ZTogZnVuY3Rpb24gc2VhcmNoKGl0ZW0sIHNlYXJjaGVzKSB7CiAgICAgIHZhciBjb3VudCA9IDA7CiAgICAgIHZhciB0aXRsZSA9IGl0ZW0udGl0bGUsCiAgICAgICAgICBkZXNjcmlwdGlvbiA9IGl0ZW0uZGVzY3JpcHRpb24sCiAgICAgICAgICBicmFuZCA9IGl0ZW0uYnJhbmQsCiAgICAgICAgICBjYXRlZ29yeSA9IGl0ZW0uY2F0ZWdvcnksCiAgICAgICAgICBzcGVjaWZpY2F0aW9ucyA9IGl0ZW0uc3BlY2lmaWNhdGlvbnM7CgogICAgICB2YXIgX2l0ZXJhdG9yID0gX2NyZWF0ZUZvck9mSXRlcmF0b3JIZWxwZXIoc2VhcmNoZXMpLAogICAgICAgICAgX3N0ZXA7CgogICAgICB0cnkgewogICAgICAgIGZvciAoX2l0ZXJhdG9yLnMoKTsgIShfc3RlcCA9IF9pdGVyYXRvci5uKCkpLmRvbmU7KSB7CiAgICAgICAgICB2YXIga2V5d29yZCA9IF9zdGVwLnZhbHVlOwogICAgICAgICAgY291bnQgKz0gdGV4dENvbnRhaW5zKHRpdGxlLCBrZXl3b3JkKSA/IDEgOiAwOwogICAgICAgICAgY291bnQgKz0gdGV4dENvbnRhaW5zKGRlc2NyaXB0aW9uLCBrZXl3b3JkKSA/IDEgOiAwOwogICAgICAgICAgY291bnQgKz0gYnJhbmQgJiYgdGV4dENvbnRhaW5zKGJyYW5kLnRpdGxlLCBrZXl3b3JkKSA/IDEgOiAwOwogICAgICAgICAgY291bnQgKz0gY2F0ZWdvcnkgJiYgdGV4dENvbnRhaW5zKGNhdGVnb3J5LnRpdGxlLCBrZXl3b3JkKSA/IDEgOiAwOwoKICAgICAgICAgIHZhciBfaXRlcmF0b3IyID0gX2NyZWF0ZUZvck9mSXRlcmF0b3JIZWxwZXIoc3BlY2lmaWNhdGlvbnMpLAogICAgICAgICAgICAgIF9zdGVwMjsKCiAgICAgICAgICB0cnkgewogICAgICAgICAgICBmb3IgKF9pdGVyYXRvcjIucygpOyAhKF9zdGVwMiA9IF9pdGVyYXRvcjIubigpKS5kb25lOykgewogICAgICAgICAgICAgIHZhciBzcGVjQ29udGVudCA9IF9zdGVwMi52YWx1ZTsKICAgICAgICAgICAgICB2YXIgdHlwZSA9IHNwZWNDb250ZW50LnR5cGUsCiAgICAgICAgICAgICAgICAgIGNvbnRlbnQgPSBzcGVjQ29udGVudC5jb250ZW50OwogICAgICAgICAgICAgIGNvdW50ICs9IHR5cGUgJiYgdGV4dENvbnRhaW5zKHR5cGUudGl0bGUsIGtleXdvcmQpID8gMSA6IDA7CiAgICAgICAgICAgICAgY291bnQgKz0gdGV4dENvbnRhaW5zKGNvbnRlbnQsIGtleXdvcmQpID8gMSA6IDA7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0gY2F0Y2ggKGVycikgewogICAgICAgICAgICBfaXRlcmF0b3IyLmUoZXJyKTsKICAgICAgICAgIH0gZmluYWxseSB7CiAgICAgICAgICAgIF9pdGVyYXRvcjIuZigpOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfSBjYXRjaCAoZXJyKSB7CiAgICAgICAgX2l0ZXJhdG9yLmUoZXJyKTsKICAgICAgfSBmaW5hbGx5IHsKICAgICAgICBfaXRlcmF0b3IuZigpOwogICAgICB9CgogICAgICByZXR1cm4gewogICAgICAgIGl0ZW06IGl0ZW0sCiAgICAgICAgbWF0Y2hDb3VudDogY291bnQKICAgICAgfTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJ0cmltIiwKICAgIHZhbHVlOiBmdW5jdGlvbiB0cmltKGRhdGEpIHsKICAgICAgcmV0dXJuIG5ldyBQcm9kdWN0KGRhdGEpOwogICAgfQogIH1dKTsKCiAgcmV0dXJuIFByb2R1Y3Q7Cn0oKTsKCmZ1bmN0aW9uIF90cmltU3BlY2lmaWNhdGlvbihpdGVtLCBkYXRhKSB7CiAgaXRlbS5zcGVjaWZpY2F0aW9ucyA9IChBcnJheS5pc0FycmF5KGRhdGEuc3BlY2lmaWNhdGlvbnMpID8gZGF0YS5zcGVjaWZpY2F0aW9ucyA6IFtdKS5tYXAoZnVuY3Rpb24gKHNwZWNpZmljYXRpb24pIHsKICAgIHJldHVybiBQcm9kdWN0U3BlY2lmaWNhdGlvbi50cmltKHNwZWNpZmljYXRpb24pOwogIH0pOwoKICBpZiAoX3R5cGVvZihkYXRhLnNwZWNpZmljYXRpb24pID09PSAib2JqZWN0IiAmJiBkYXRhLnNwZWNpZmljYXRpb24pIHsKICAgIHZhciBfaXRlbSRzcGVjaWZpY2F0aW9uczsKCiAgICAoX2l0ZW0kc3BlY2lmaWNhdGlvbnMgPSBpdGVtLnNwZWNpZmljYXRpb25zKS51bnNoaWZ0LmFwcGx5KF9pdGVtJHNwZWNpZmljYXRpb25zLCBfdG9Db25zdW1hYmxlQXJyYXkoT2JqZWN0LmtleXMoZGF0YS5zcGVjaWZpY2F0aW9uKS5tYXAoZnVuY3Rpb24gKHR5cGUpIHsKICAgICAgcmV0dXJuIHsKICAgICAgICB0eXBlOiB0eXBlLAogICAgICAgIGNvbnRlbnQ6IGRhdGEuc3BlY2lmaWNhdGlvblt0eXBlXQogICAgICB9OwogICAgfSkubWFwKGZ1bmN0aW9uIChzcGVjKSB7CiAgICAgIHJldHVybiBQcm9kdWN0U3BlY2lmaWNhdGlvbi50cmltKHNwZWMpOwogICAgfSkpKTsKICB9Cn0KCmZ1bmN0aW9uIF90cmltSW1hZ2UoaXRlbSwgZGF0YSkgewogIGl0ZW0uaW1hZ2VzID0gKEFycmF5LmlzQXJyYXkoZGF0YS5pbWFnZXMpID8gZGF0YS5pbWFnZXMgOiBbXSkubWFwKGZ1bmN0aW9uIChpbWFnZSkgewogICAgcmV0dXJuIEltYWdlLnRyaW0oaW1hZ2UpOwogIH0pLmZpbHRlcihmdW5jdGlvbiAoaW1hZ2UpIHsKICAgIHJldHVybiBpbWFnZTsKICB9KTsKICB2YXIgZGF0YUltYWdlID0gX3R5cGVvZihkYXRhLmltYWdlKSA9PT0gIm9iamVjdCIgPyBJbWFnZS50cmltKGRhdGEuaW1hZ2UpIDogdW5kZWZpbmVkOwoKICBpZiAoZGF0YUltYWdlKSB7CiAgICBpdGVtLmltYWdlcy51bnNoaWZ0KGRhdGFJbWFnZSk7CiAgfQp9CgpmdW5jdGlvbiBfdHJpbVByaWNlKGl0ZW0sIGRhdGEpIHsKICB2YXIgX3JlZiA9IGRhdGEuc3RvY2sgPyBkYXRhLnN0b2NrIDoge30sCiAgICAgIF9yZWYkcHJpY2VzID0gX3JlZi5wcmljZXMsCiAgICAgIHByaWNlcyA9IF9yZWYkcHJpY2VzID09PSB2b2lkIDAgPyBbXSA6IF9yZWYkcHJpY2VzOwoKICBwcmljZXMgPSBwcmljZXMuZmlsdGVyKGZ1bmN0aW9uIChwcmljZSkgewogICAgcmV0dXJuIHByaWNlICYmIChwcmljZS5ub3JtYWwgfHwgcHJpY2UucHJvbW90aW9uKTsKICB9KTsKCiAgaWYgKGRhdGEucHJpY2UpIHsKICAgIGl0ZW0ucHJpY2UgPSBQcm9kdWN0UHJpY2UudHJpbShkYXRhLnByaWNlKTsKICAgIHJldHVybjsKICB9CgogIGlmIChwcmljZXMubGVuZ3RoID09PSAwKSB7CiAgICBpdGVtLnByaWNlID0gbnVsbDsKICB9IGVsc2UgaWYgKHByaWNlcy5sZW5ndGggPT09IDEpIHsKICAgIGl0ZW0ucHJpY2UgPSBQcm9kdWN0UHJpY2UudHJpbShwcmljZXNbMF0pOwogIH0gZWxzZSB7CiAgICBpdGVtLnByaWNlID0gUHJvZHVjdFByaWNlLnRyaW0ocHJpY2VzW3ByaWNlcy5sZW5ndGggLSAxXSk7CiAgfQp9Cgptb2R1bGUuZXhwb3J0cyA9IFByb2R1Y3Q7"},{"version":3,"sources":["C:/development/freshnet-v2/express/data_structures/Product.js"],"names":["Text","require","Image","ProductStock","ProductBundle","ProductPrice","ProductSpecification","textContains","text","keyword","toLowerCase","replaceAll","includes","Product","data","_id","trim","title","description","categoryId","brandId","bundles","Array","isArray","map","bundle","gifts","gift","filter","stock","item","searches","count","brand","category","specifications","specContent","type","content","matchCount","specification","unshift","Object","keys","spec","images","image","dataImage","undefined","prices","price","normal","promotion","length","module","exports"],"mappings":"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","sourcesContent":["const Text = require(\"./Text.js\");\r\nconst Image = require(\"./Image.js\");\r\nconst ProductStock = require(\"./ProductStock.js\");\r\nconst ProductBundle = require(\"./ProductBundle.js\");\r\nconst ProductPrice = require(\"./ProductPrice.js\");\r\nconst ProductSpecification = require(\"./ProductSpecification.js\");\r\n\r\nconst textContains = (text, keyword) => {\r\n   return (\r\n      typeof text == \"string\" &&\r\n      text.toLowerCase().replaceAll(\" \", \"\").includes(keyword)\r\n   );\r\n};\r\n\r\nclass Product {\r\n   static search(item, searches) {\r\n      let count = 0;\r\n      let { title, description, brand, category, specifications } = item;\r\n\r\n      for (const keyword of searches) {\r\n         count += textContains(title, keyword) ? 1 : 0;\r\n         count += textContains(description, keyword) ? 1 : 0;\r\n         count += brand && textContains(brand.title, keyword) ? 1 : 0;\r\n         count += category && textContains(category.title, keyword) ? 1 : 0;\r\n         for (const specContent of specifications) {\r\n            let { type, content } = specContent;\r\n            count += type && textContains(type.title, keyword) ? 1 : 0;\r\n            count += textContains(content, keyword) ? 1 : 0;\r\n         }\r\n      }\r\n\r\n      return { item, matchCount: count };\r\n   }\r\n\r\n   static #trimSpecification(item, data) {\r\n      item.specifications = (\r\n         Array.isArray(data.specifications) ? data.specifications : []\r\n      ).map((specification) => ProductSpecification.trim(specification));\r\n\r\n      if (typeof data.specification === \"object\" && data.specification) {\r\n         item.specifications.unshift(\r\n            ...Object.keys(data.specification)\r\n               .map((type) => ({ type, content: data.specification[type] }))\r\n               .map((spec) => ProductSpecification.trim(spec))\r\n         );\r\n      }\r\n   }\r\n   static #trimImage(item, data) {\r\n      item.images = (Array.isArray(data.images) ? data.images : [])\r\n         .map((image) => Image.trim(image))\r\n         .filter((image) => image);\r\n\r\n      let dataImage =\r\n         typeof data.image === \"object\" ? Image.trim(data.image) : undefined;\r\n      if (dataImage) {\r\n         item.images.unshift(dataImage);\r\n      }\r\n   }\r\n   static #trimPrice(item, data) {\r\n      let { prices = [] } = data.stock ? data.stock : {};\r\n      prices = prices.filter(\r\n         (price) => price && (price.normal || price.promotion)\r\n      );\r\n\r\n      if (data.price) {\r\n         item.price = ProductPrice.trim(data.price);\r\n         return;\r\n      }\r\n\r\n      if (prices.length === 0) {\r\n         item.price = null;\r\n      } else if (prices.length === 1) {\r\n         item.price = ProductPrice.trim(prices[0]);\r\n      } else {\r\n         item.price = ProductPrice.trim(prices[prices.length - 1]);\r\n      }\r\n   }\r\n   static trim(data) {\r\n      return new Product(data);\r\n   }\r\n\r\n   constructor(data = null) {\r\n      this._id = Text.trim(data._id, data._id);\r\n      this.title = Text.trim(data.title);\r\n      this.description = Text.trim(data.description);\r\n      this.categoryId = Text.trim(data.categoryId);\r\n      this.brandId = Text.trim(data.brandId);\r\n      this.bundles = (Array.isArray(data.bundles) ? data.bundles : []).map(\r\n         (bundle) => ProductBundle.trim(bundle)\r\n      );\r\n      this.gifts = (Array.isArray(data.gifts) ? data.gifts : [])\r\n         .map((gift) => Text.trim(gift))\r\n         .filter((gift) => gift);\r\n      this.stock = ProductStock.trim(\r\n         typeof data.stock === \"object\" ? data.stock : {}\r\n      );\r\n\r\n      Product.#trimImage(this, data);\r\n      Product.#trimSpecification(this, data);\r\n      Product.#trimPrice(this, data);\r\n   }\r\n}\r\n\r\nmodule.exports = Product;\r\n"]}]}