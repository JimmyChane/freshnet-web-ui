{"remainingRequest":"C:\\dev\\freshnet-vue\\node_modules\\babel-loader\\lib\\index.js!C:\\dev\\freshnet-vue\\src\\stores\\store.product.js","dependencies":[{"path":"C:\\dev\\freshnet-vue\\src\\stores\\store.product.js","mtime":1668340139939},{"path":"C:\\dev\\freshnet-vue\\babel.config.js","mtime":1662650914175},{"path":"C:\\dev\\freshnet-vue\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1662650916242},{"path":"C:\\dev\\freshnet-vue\\node_modules\\babel-loader\\lib\\index.js","mtime":1662650915901}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IF9jcmVhdGVGb3JPZkl0ZXJhdG9ySGVscGVyIGZyb20gIkM6XFxkZXZcXGZyZXNobmV0LXZ1ZVxcbm9kZV9tb2R1bGVzXFxAYmFiZWxcXHJ1bnRpbWVcXGhlbHBlcnNcXGVzbVxcY3JlYXRlRm9yT2ZJdGVyYXRvckhlbHBlci5qcyI7CmltcG9ydCBfYXN5bmNUb0dlbmVyYXRvciBmcm9tICJDOlxcZGV2XFxmcmVzaG5ldC12dWVcXG5vZGVfbW9kdWxlc1xcQGJhYmVsXFxydW50aW1lXFxoZWxwZXJzXFxlc21cXGFzeW5jVG9HZW5lcmF0b3IuanMiOwppbXBvcnQgInJlZ2VuZXJhdG9yLXJ1bnRpbWUvcnVudGltZS5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLm9iamVjdC50by1zdHJpbmcuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5zdHJpbmcuaXRlcmF0b3IuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy93ZWIuZG9tLWNvbGxlY3Rpb25zLml0ZXJhdG9yLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkubWFwLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuZmluZC5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLmFycmF5LmZpbHRlci5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLnN5bWJvbC5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLnN5bWJvbC5kZXNjcmlwdGlvbi5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLnN0cmluZy50cmltLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuZnVuY3Rpb24ubmFtZS5qcyI7CmltcG9ydCBQcm9kdWN0IGZyb20gIi4uL2l0ZW1zL1Byb2R1Y3QuanMiOwppbXBvcnQgUHJvZHVjdFNwZWNDb250ZW50IGZyb20gIi4uL2l0ZW1zL1Byb2R1Y3RTcGVjQ29udGVudC5qcyI7CmltcG9ydCBJbWFnZSBmcm9tICIuLi9pdGVtcy9JbWFnZS5qcyI7CmltcG9ydCBEYXRhTG9hZGVyIGZyb20gIi4vdG9vbHMvRGF0YUxvYWRlciI7CmltcG9ydCBDb2xsZWN0aW9uVXBkYXRlciBmcm9tICIuL3Rvb2xzL0NvbGxlY3Rpb25VcGRhdGVyIjsKaW1wb3J0IFByb2Nlc3NvciBmcm9tICIuL3Rvb2xzL1Byb2Nlc3Nvci5qcyI7CmltcG9ydCBNb2R1bGVCdW5kbGUgZnJvbSAiLi4vLi4vLi4vZXhwcmVzcy9kYXRhX3N0cnVjdHVyZXMvUHJvZHVjdEJ1bmRsZS5qcyI7CmltcG9ydCBNb2R1bGVQcmljZSBmcm9tICIuLi8uLi8uLi9leHByZXNzL2RhdGFfc3RydWN0dXJlcy9Qcm9kdWN0UHJpY2UuanMiOwppbXBvcnQgQ2F0ZWdvcnkgZnJvbSAiQC9pdGVtcy9DYXRlZ29yeS5qcyI7CmltcG9ydCBWdWV4IGZyb20gInZ1ZXgiOwppbXBvcnQgQXBpSG9zdCBmcm9tICJAL2hvc3QvQXBpSG9zdC5qcyI7CmltcG9ydCBVIGZyb20gIkAvVS5qcyI7CmV4cG9ydCBkZWZhdWx0IHsKICBpbml0OiBmdW5jdGlvbiBpbml0KFN0b3JlcykgewogICAgdmFyIGNhdGVnb3J5U3RvcmUgPSBTdG9yZXMuY2F0ZWdvcnk7CiAgICB2YXIgcHJvZHVjdFN0b3JlID0gbmV3IFZ1ZXguU3RvcmUoewogICAgICBzdGF0ZTogewogICAgICAgIGxhc3RNb2RpZmllZDogMCwKICAgICAgICBkYXRhTG9hZGVyOiBuZXcgRGF0YUxvYWRlcih7CiAgICAgICAgICB0aW1lb3V0OiAxMDAwICogNjAgKiAxMAogICAgICAgIH0pIC8vIDEwbWluCiAgICAgICAgLnByb2Nlc3NvcihmdW5jdGlvbiAoKSB7CiAgICAgICAgICByZXR1cm4gcHJvZHVjdFN0b3JlLnN0YXRlLnByb2Nlc3NvcjsKICAgICAgICB9KS5sb2FkRGF0YSggLyojX19QVVJFX18qL19hc3luY1RvR2VuZXJhdG9yKCAvKiNfX1BVUkVfXyovcmVnZW5lcmF0b3JSdW50aW1lLm1hcmsoZnVuY3Rpb24gX2NhbGxlZSgpIHsKICAgICAgICAgIHZhciBhcGksIGVycm9yLCBjb250ZW50czsKICAgICAgICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUud3JhcChmdW5jdGlvbiBfY2FsbGVlJChfY29udGV4dCkgewogICAgICAgICAgICB3aGlsZSAoMSkgewogICAgICAgICAgICAgIHN3aXRjaCAoX2NvbnRleHQucHJldiA9IF9jb250ZXh0Lm5leHQpIHsKICAgICAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICAgICAgX2NvbnRleHQubmV4dCA9IDI7CiAgICAgICAgICAgICAgICAgIHJldHVybiBBcGlIb3N0LnJlcXVlc3QoKS51cmwoInByb2R1Y3R2Mi9saXN0LyIpLnNlbmQoKTsKCiAgICAgICAgICAgICAgICBjYXNlIDI6CiAgICAgICAgICAgICAgICAgIGFwaSA9IF9jb250ZXh0LnNlbnQ7CiAgICAgICAgICAgICAgICAgIGVycm9yID0gYXBpLmdldEVycm9yKCk7CiAgICAgICAgICAgICAgICAgIGNvbnRlbnRzID0gYXBpLmdldENvbnRlbnQoKTsKCiAgICAgICAgICAgICAgICAgIGlmICghZXJyb3IpIHsKICAgICAgICAgICAgICAgICAgICBfY29udGV4dC5uZXh0ID0gNzsKICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKGVycm9yKTsKCiAgICAgICAgICAgICAgICBjYXNlIDc6CiAgICAgICAgICAgICAgICAgIGlmIChBcnJheS5pc0FycmF5KGNvbnRlbnRzKSkgewogICAgICAgICAgICAgICAgICAgIF9jb250ZXh0Lm5leHQgPSA5OwogICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoImNvbnRlbnQgaXMgbm90IGFycmF5Iik7CgogICAgICAgICAgICAgICAgY2FzZSA5OgogICAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQuYWJydXB0KCJyZXR1cm4iLCBQcm9taXNlLmFsbChjb250ZW50cy5tYXAoZnVuY3Rpb24gKGNvbnRlbnQpIHsKICAgICAgICAgICAgICAgICAgICByZXR1cm4gbmV3IFByb2R1Y3QoU3RvcmVzKS5mcm9tRGF0YShjb250ZW50KTsKICAgICAgICAgICAgICAgICAgfSkpKTsKCiAgICAgICAgICAgICAgICBjYXNlIDEwOgogICAgICAgICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0LnN0b3AoKTsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAgIH0sIF9jYWxsZWUpOwogICAgICAgIH0pKSkuc2V0RGF0YShmdW5jdGlvbiAoZGF0YSkgewogICAgICAgICAgcHJvZHVjdFN0b3JlLmNvbW1pdCgiaXRlbXMiLCBBcnJheS5pc0FycmF5KGRhdGEpID8gZGF0YSA6IFtdKTsKICAgICAgICAgIHByb2R1Y3RTdG9yZS5jb21taXQoImxhc3RNb2RpZmllZCIsIERhdGUubm93KCkpOwogICAgICAgIH0pLmdldERhdGEoZnVuY3Rpb24gKCkgewogICAgICAgICAgcmV0dXJuIHByb2R1Y3RTdG9yZS5nZXR0ZXJzLml0ZW1zOwogICAgICAgIH0pLAogICAgICAgIGl0ZW1zOiBbXSwKICAgICAgICBwcm9jZXNzb3I6IG5ldyBQcm9jZXNzb3IoKQogICAgICB9LAogICAgICBtdXRhdGlvbnM6IHsKICAgICAgICBsYXN0TW9kaWZpZWQ6IGZ1bmN0aW9uIGxhc3RNb2RpZmllZChzdGF0ZSwgdGltZSkgewogICAgICAgICAgcmV0dXJuIHN0YXRlLmxhc3RNb2RpZmllZCA9IHRpbWU7CiAgICAgICAgfSwKICAgICAgICBpdGVtczogZnVuY3Rpb24gaXRlbXMoc3RhdGUsIF9pdGVtcykgewogICAgICAgICAgcmV0dXJuIHN0YXRlLml0ZW1zID0gX2l0ZW1zOwogICAgICAgIH0KICAgICAgfSwKICAgICAgZ2V0dGVyczogewogICAgICAgIGxhc3RNb2RpZmllZDogZnVuY3Rpb24gbGFzdE1vZGlmaWVkKHN0YXRlKSB7CiAgICAgICAgICByZXR1cm4gc3RhdGUubGFzdE1vZGlmaWVkOwogICAgICAgIH0sCiAgICAgICAgaXNMb2FkaW5nOiBmdW5jdGlvbiBpc0xvYWRpbmcoc3RhdGUpIHsKICAgICAgICAgIHJldHVybiBzdGF0ZS5wcm9jZXNzb3IuaXNMb2FkaW5nKCk7CiAgICAgICAgfSwKICAgICAgICBpdGVtczogZnVuY3Rpb24gaXRlbXMoc3RhdGUpIHsKICAgICAgICAgIHJldHVybiBzdGF0ZS5pdGVtczsKICAgICAgICB9CiAgICAgIH0sCiAgICAgIGFjdGlvbnM6IHsKICAgICAgICByZWZyZXNoOiBmdW5jdGlvbiByZWZyZXNoKGNvbnRleHQpIHsKICAgICAgICAgIHJldHVybiBfYXN5bmNUb0dlbmVyYXRvciggLyojX19QVVJFX18qL3JlZ2VuZXJhdG9yUnVudGltZS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWUzKCkgewogICAgICAgICAgICByZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLndyYXAoZnVuY3Rpb24gX2NhbGxlZTMkKF9jb250ZXh0MykgewogICAgICAgICAgICAgIHdoaWxlICgxKSB7CiAgICAgICAgICAgICAgICBzd2l0Y2ggKF9jb250ZXh0My5wcmV2ID0gX2NvbnRleHQzLm5leHQpIHsKICAgICAgICAgICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICAgICAgICAgIF9jb250ZXh0My5uZXh0ID0gMjsKICAgICAgICAgICAgICAgICAgICByZXR1cm4gY29udGV4dC5zdGF0ZS5wcm9jZXNzb3IuYWNxdWlyZSgicmVmcmVzaCIsIC8qI19fUFVSRV9fKi9fYXN5bmNUb0dlbmVyYXRvciggLyojX19QVVJFX18qL3JlZ2VuZXJhdG9yUnVudGltZS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWUyKCkgewogICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHJlZ2VuZXJhdG9yUnVudGltZS53cmFwKGZ1bmN0aW9uIF9jYWxsZWUyJChfY29udGV4dDIpIHsKICAgICAgICAgICAgICAgICAgICAgICAgd2hpbGUgKDEpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICBzd2l0Y2ggKF9jb250ZXh0Mi5wcmV2ID0gX2NvbnRleHQyLm5leHQpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29udGV4dC5zdGF0ZS5kYXRhTG9hZGVyLmRvVGltZW91dCgpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfY29udGV4dDIubmV4dCA9IDM7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBjb250ZXh0LmRpc3BhdGNoKCJnZXRJdGVtcyIpOwoKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgMzoKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDIuc3RvcCgpOwogICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgfSwgX2NhbGxlZTIpOwogICAgICAgICAgICAgICAgICAgIH0pKSk7CgogICAgICAgICAgICAgICAgICBjYXNlIDI6CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0My5hYnJ1cHQoInJldHVybiIsIF9jb250ZXh0My5zZW50KTsKCiAgICAgICAgICAgICAgICAgIGNhc2UgMzoKICAgICAgICAgICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQzLnN0b3AoKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0sIF9jYWxsZWUzKTsKICAgICAgICAgIH0pKSgpOwogICAgICAgIH0sCiAgICAgICAgZ2V0SXRlbXM6IGZ1bmN0aW9uIGdldEl0ZW1zKGNvbnRleHQpIHsKICAgICAgICAgIHJldHVybiBfYXN5bmNUb0dlbmVyYXRvciggLyojX19QVVJFX18qL3JlZ2VuZXJhdG9yUnVudGltZS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWU1KCkgewogICAgICAgICAgICByZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLndyYXAoZnVuY3Rpb24gX2NhbGxlZTUkKF9jb250ZXh0NSkgewogICAgICAgICAgICAgIHdoaWxlICgxKSB7CiAgICAgICAgICAgICAgICBzd2l0Y2ggKF9jb250ZXh0NS5wcmV2ID0gX2NvbnRleHQ1Lm5leHQpIHsKICAgICAgICAgICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDUuYWJydXB0KCJyZXR1cm4iLCBjb250ZXh0LnN0YXRlLnByb2Nlc3Nvci5hY3F1aXJlKCJnZXRJdGVtcyIsIC8qI19fUFVSRV9fKi9fYXN5bmNUb0dlbmVyYXRvciggLyojX19QVVJFX18qL3JlZ2VuZXJhdG9yUnVudGltZS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWU0KCkgewogICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHJlZ2VuZXJhdG9yUnVudGltZS53cmFwKGZ1bmN0aW9uIF9jYWxsZWU0JChfY29udGV4dDQpIHsKICAgICAgICAgICAgICAgICAgICAgICAgd2hpbGUgKDEpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICBzd2l0Y2ggKF9jb250ZXh0NC5wcmV2ID0gX2NvbnRleHQ0Lm5leHQpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0NC5hYnJ1cHQoInJldHVybiIsIGNvbnRleHQuc3RhdGUuZGF0YUxvYWRlci5kYXRhKCkpOwoKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgMToKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDQuc3RvcCgpOwogICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgfSwgX2NhbGxlZTQpOwogICAgICAgICAgICAgICAgICAgIH0pKSkpOwoKICAgICAgICAgICAgICAgICAgY2FzZSAxOgogICAgICAgICAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDUuc3RvcCgpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSwgX2NhbGxlZTUpOwogICAgICAgICAgfSkpKCk7CiAgICAgICAgfSwKICAgICAgICBnZXRJdGVtT2ZJZDogZnVuY3Rpb24gZ2V0SXRlbU9mSWQoY29udGV4dCkgewogICAgICAgICAgdmFyIF9hcmd1bWVudHMgPSBhcmd1bWVudHM7CiAgICAgICAgICByZXR1cm4gX2FzeW5jVG9HZW5lcmF0b3IoIC8qI19fUFVSRV9fKi9yZWdlbmVyYXRvclJ1bnRpbWUubWFyayhmdW5jdGlvbiBfY2FsbGVlNygpIHsKICAgICAgICAgICAgdmFyIGlkOwogICAgICAgICAgICByZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLndyYXAoZnVuY3Rpb24gX2NhbGxlZTckKF9jb250ZXh0NykgewogICAgICAgICAgICAgIHdoaWxlICgxKSB7CiAgICAgICAgICAgICAgICBzd2l0Y2ggKF9jb250ZXh0Ny5wcmV2ID0gX2NvbnRleHQ3Lm5leHQpIHsKICAgICAgICAgICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICAgICAgICAgIGlkID0gX2FyZ3VtZW50cy5sZW5ndGggPiAxICYmIF9hcmd1bWVudHNbMV0gIT09IHVuZGVmaW5lZCA/IF9hcmd1bWVudHNbMV0gOiAiIjsKICAgICAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQ3LmFicnVwdCgicmV0dXJuIiwgY29udGV4dC5zdGF0ZS5wcm9jZXNzb3IuYWNxdWlyZSgiZ2V0SXRlbU9mSWQiLCAvKiNfX1BVUkVfXyovX2FzeW5jVG9HZW5lcmF0b3IoIC8qI19fUFVSRV9fKi9yZWdlbmVyYXRvclJ1bnRpbWUubWFyayhmdW5jdGlvbiBfY2FsbGVlNigpIHsKICAgICAgICAgICAgICAgICAgICAgIHZhciBpdGVtcywgaXRlbTsKICAgICAgICAgICAgICAgICAgICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUud3JhcChmdW5jdGlvbiBfY2FsbGVlNiQoX2NvbnRleHQ2KSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHdoaWxlICgxKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgc3dpdGNoIChfY29udGV4dDYucHJldiA9IF9jb250ZXh0Ni5uZXh0KSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9jb250ZXh0Ni5uZXh0ID0gMjsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGNvbnRleHQuZGlzcGF0Y2goImdldEl0ZW1zIik7CgogICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAyOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpdGVtcyA9IF9jb250ZXh0Ni5zZW50OwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpdGVtID0gaXRlbXMuZmluZChmdW5jdGlvbiAoaXRlbSkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBpdGVtLmlkID09PSBpZDsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7CgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoaXRlbSkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9jb250ZXh0Ni5uZXh0ID0gOTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgX2NvbnRleHQ2Lm5leHQgPSA3OwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gY29udGV4dC5kaXNwYXRjaCgicmVmcmVzaEl0ZW1zIik7CgogICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSA3OgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpdGVtcyA9IF9jb250ZXh0Ni5zZW50OwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpdGVtID0gaXRlbXMuZmluZChmdW5jdGlvbiAoaXRlbSkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBpdGVtLmlkID09PSBpZDsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7CgogICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSA5OgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQ2LmFicnVwdCgicmV0dXJuIiwgaXRlbSk7CgogICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAxMDoKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDYuc3RvcCgpOwogICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgfSwgX2NhbGxlZTYpOwogICAgICAgICAgICAgICAgICAgIH0pKSkpOwoKICAgICAgICAgICAgICAgICAgY2FzZSAyOgogICAgICAgICAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDcuc3RvcCgpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSwgX2NhbGxlZTcpOwogICAgICAgICAgfSkpKCk7CiAgICAgICAgfSwKICAgICAgICBnZXRHcm91cHNCeUNhdGVnb3J5OiBmdW5jdGlvbiBnZXRHcm91cHNCeUNhdGVnb3J5KGNvbnRleHQpIHsKICAgICAgICAgIHJldHVybiBfYXN5bmNUb0dlbmVyYXRvciggLyojX19QVVJFX18qL3JlZ2VuZXJhdG9yUnVudGltZS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWU4KCkgewogICAgICAgICAgICB2YXIgaXRlbXMsIGNhdGVnb3J5T3RoZXIsIGdyb3VwcywgX2l0ZXJhdG9yLCBfc3RlcCwgX2xvb3A7CgogICAgICAgICAgICByZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLndyYXAoZnVuY3Rpb24gX2NhbGxlZTgkKF9jb250ZXh0OSkgewogICAgICAgICAgICAgIHdoaWxlICgxKSB7CiAgICAgICAgICAgICAgICBzd2l0Y2ggKF9jb250ZXh0OS5wcmV2ID0gX2NvbnRleHQ5Lm5leHQpIHsKICAgICAgICAgICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICAgICAgICAgIF9jb250ZXh0OS5uZXh0ID0gMjsKICAgICAgICAgICAgICAgICAgICByZXR1cm4gY29udGV4dC5kaXNwYXRjaCgiZ2V0SXRlbXMiKTsKCiAgICAgICAgICAgICAgICAgIGNhc2UgMjoKICAgICAgICAgICAgICAgICAgICBpdGVtcyA9IF9jb250ZXh0OS5zZW50OwogICAgICAgICAgICAgICAgICAgIF9jb250ZXh0OS5uZXh0ID0gNTsKICAgICAgICAgICAgICAgICAgICByZXR1cm4gY2F0ZWdvcnlTdG9yZS5kaXNwYXRjaCgiZ2V0SXRlbU9mS2V5IiwgQ2F0ZWdvcnkuS2V5Lk90aGVyKTsKCiAgICAgICAgICAgICAgICAgIGNhc2UgNToKICAgICAgICAgICAgICAgICAgICBjYXRlZ29yeU90aGVyID0gX2NvbnRleHQ5LnNlbnQ7CiAgICAgICAgICAgICAgICAgICAgZ3JvdXBzID0gW107CiAgICAgICAgICAgICAgICAgICAgX2l0ZXJhdG9yID0gX2NyZWF0ZUZvck9mSXRlcmF0b3JIZWxwZXIoaXRlbXMpOwogICAgICAgICAgICAgICAgICAgIF9jb250ZXh0OS5wcmV2ID0gODsKICAgICAgICAgICAgICAgICAgICBfbG9vcCA9IC8qI19fUFVSRV9fKi9yZWdlbmVyYXRvclJ1bnRpbWUubWFyayhmdW5jdGlvbiBfbG9vcCgpIHsKICAgICAgICAgICAgICAgICAgICAgIHZhciBpdGVtLCBjYXRlZ29yeSwgY2F0ZWdvcnlJZCwgZ3JvdXA7CiAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLndyYXAoZnVuY3Rpb24gX2xvb3AkKF9jb250ZXh0OCkgewogICAgICAgICAgICAgICAgICAgICAgICB3aGlsZSAoMSkgewogICAgICAgICAgICAgICAgICAgICAgICAgIHN3aXRjaCAoX2NvbnRleHQ4LnByZXYgPSBfY29udGV4dDgubmV4dCkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpdGVtID0gX3N0ZXAudmFsdWU7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9jb250ZXh0OC5uZXh0ID0gMzsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGl0ZW0uZmV0Y2hDYXRlZ29yeSgpOwoKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgMzoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2F0ZWdvcnkgPSBfY29udGV4dDguc2VudDsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFjYXRlZ29yeSkgY2F0ZWdvcnkgPSBjYXRlZ29yeU90aGVyOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXRlZ29yeUlkID0gY2F0ZWdvcnkgPyBjYXRlZ29yeS5pZCA6ICIiOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBncm91cCA9IGdyb3Vwcy5maW5kKGZ1bmN0aW9uIChncm91cCkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBncm91cC5jYXRlZ29yeS5pZCA9PT0gY2F0ZWdvcnlJZDsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7CgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoIWdyb3VwKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZ3JvdXBzLnB1c2goZ3JvdXAgPSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXRlZ29yeTogY2F0ZWdvcnksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpdGVtczogW10KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZ3JvdXAuaXRlbXMucHVzaChpdGVtKTsKCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDk6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQ4LnN0b3AoKTsKICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgIH0sIF9sb29wKTsKICAgICAgICAgICAgICAgICAgICB9KTsKCiAgICAgICAgICAgICAgICAgICAgX2l0ZXJhdG9yLnMoKTsKCiAgICAgICAgICAgICAgICAgIGNhc2UgMTE6CiAgICAgICAgICAgICAgICAgICAgaWYgKChfc3RlcCA9IF9pdGVyYXRvci5uKCkpLmRvbmUpIHsKICAgICAgICAgICAgICAgICAgICAgIF9jb250ZXh0OS5uZXh0ID0gMTU7CiAgICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDkuZGVsZWdhdGVZaWVsZChfbG9vcCgpLCAidDAiLCAxMyk7CgogICAgICAgICAgICAgICAgICBjYXNlIDEzOgogICAgICAgICAgICAgICAgICAgIF9jb250ZXh0OS5uZXh0ID0gMTE7CiAgICAgICAgICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgICAgICAgICBjYXNlIDE1OgogICAgICAgICAgICAgICAgICAgIF9jb250ZXh0OS5uZXh0ID0gMjA7CiAgICAgICAgICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgICAgICAgICBjYXNlIDE3OgogICAgICAgICAgICAgICAgICAgIF9jb250ZXh0OS5wcmV2ID0gMTc7CiAgICAgICAgICAgICAgICAgICAgX2NvbnRleHQ5LnQxID0gX2NvbnRleHQ5WyJjYXRjaCJdKDgpOwoKICAgICAgICAgICAgICAgICAgICBfaXRlcmF0b3IuZShfY29udGV4dDkudDEpOwoKICAgICAgICAgICAgICAgICAgY2FzZSAyMDoKICAgICAgICAgICAgICAgICAgICBfY29udGV4dDkucHJldiA9IDIwOwoKICAgICAgICAgICAgICAgICAgICBfaXRlcmF0b3IuZigpOwoKICAgICAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQ5LmZpbmlzaCgyMCk7CgogICAgICAgICAgICAgICAgICBjYXNlIDIzOgogICAgICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDkuYWJydXB0KCJyZXR1cm4iLCBncm91cHMpOwoKICAgICAgICAgICAgICAgICAgY2FzZSAyNDoKICAgICAgICAgICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQ5LnN0b3AoKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0sIF9jYWxsZWU4LCBudWxsLCBbWzgsIDE3LCAyMCwgMjNdXSk7CiAgICAgICAgICB9KSkoKTsKICAgICAgICB9LAogICAgICAgIGdldEdyb3Vwc0J5QnJhbmQ6IGZ1bmN0aW9uIGdldEdyb3Vwc0J5QnJhbmQoY29udGV4dCkgewogICAgICAgICAgcmV0dXJuIF9hc3luY1RvR2VuZXJhdG9yKCAvKiNfX1BVUkVfXyovcmVnZW5lcmF0b3JSdW50aW1lLm1hcmsoZnVuY3Rpb24gX2NhbGxlZTkoKSB7CiAgICAgICAgICAgIHZhciBpdGVtcywgZ3JvdXBzLCBfaXRlcmF0b3IyLCBfc3RlcDIsIF9sb29wMjsKCiAgICAgICAgICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUud3JhcChmdW5jdGlvbiBfY2FsbGVlOSQoX2NvbnRleHQxMSkgewogICAgICAgICAgICAgIHdoaWxlICgxKSB7CiAgICAgICAgICAgICAgICBzd2l0Y2ggKF9jb250ZXh0MTEucHJldiA9IF9jb250ZXh0MTEubmV4dCkgewogICAgICAgICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgICAgICAgX2NvbnRleHQxMS5uZXh0ID0gMjsKICAgICAgICAgICAgICAgICAgICByZXR1cm4gY29udGV4dC5kaXNwYXRjaCgiZ2V0SXRlbXMiKTsKCiAgICAgICAgICAgICAgICAgIGNhc2UgMjoKICAgICAgICAgICAgICAgICAgICBpdGVtcyA9IF9jb250ZXh0MTEuc2VudDsKICAgICAgICAgICAgICAgICAgICBncm91cHMgPSBbXTsKICAgICAgICAgICAgICAgICAgICBfaXRlcmF0b3IyID0gX2NyZWF0ZUZvck9mSXRlcmF0b3JIZWxwZXIoaXRlbXMpOwogICAgICAgICAgICAgICAgICAgIF9jb250ZXh0MTEucHJldiA9IDU7CiAgICAgICAgICAgICAgICAgICAgX2xvb3AyID0gLyojX19QVVJFX18qL3JlZ2VuZXJhdG9yUnVudGltZS5tYXJrKGZ1bmN0aW9uIF9sb29wMigpIHsKICAgICAgICAgICAgICAgICAgICAgIHZhciBpdGVtLCBncm91cCwgYnJhbmQ7CiAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLndyYXAoZnVuY3Rpb24gX2xvb3AyJChfY29udGV4dDEwKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHdoaWxlICgxKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgc3dpdGNoIChfY29udGV4dDEwLnByZXYgPSBfY29udGV4dDEwLm5leHQpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaXRlbSA9IF9zdGVwMi52YWx1ZTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZ3JvdXAgPSBncm91cHMuZmluZChmdW5jdGlvbiAoZ3JvdXApIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgYnJhbmRJZCA9IGdyb3VwLmJyYW5kID8gZ3JvdXAuYnJhbmQuaWQgOiAiIjsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gYnJhbmRJZCA9PT0gaXRlbS5icmFuZElkOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgX2NvbnRleHQxMC5uZXh0ID0gNDsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGl0ZW0uZmV0Y2hCcmFuZCgpOwoKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgNDoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJhbmQgPSBfY29udGV4dDEwLnNlbnQ7CgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoIWdyb3VwKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZ3JvdXBzLnB1c2goZ3JvdXAgPSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmFuZDogYnJhbmQsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpdGVtczogW10KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZ3JvdXAuaXRlbXMucHVzaChpdGVtKTsKCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDc6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQxMC5zdG9wKCk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICB9LCBfbG9vcDIpOwogICAgICAgICAgICAgICAgICAgIH0pOwoKICAgICAgICAgICAgICAgICAgICBfaXRlcmF0b3IyLnMoKTsKCiAgICAgICAgICAgICAgICAgIGNhc2UgODoKICAgICAgICAgICAgICAgICAgICBpZiAoKF9zdGVwMiA9IF9pdGVyYXRvcjIubigpKS5kb25lKSB7CiAgICAgICAgICAgICAgICAgICAgICBfY29udGV4dDExLm5leHQgPSAxMjsKICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0MTEuZGVsZWdhdGVZaWVsZChfbG9vcDIoKSwgInQwIiwgMTApOwoKICAgICAgICAgICAgICAgICAgY2FzZSAxMDoKICAgICAgICAgICAgICAgICAgICBfY29udGV4dDExLm5leHQgPSA4OwogICAgICAgICAgICAgICAgICAgIGJyZWFrOwoKICAgICAgICAgICAgICAgICAgY2FzZSAxMjoKICAgICAgICAgICAgICAgICAgICBfY29udGV4dDExLm5leHQgPSAxNzsKICAgICAgICAgICAgICAgICAgICBicmVhazsKCiAgICAgICAgICAgICAgICAgIGNhc2UgMTQ6CiAgICAgICAgICAgICAgICAgICAgX2NvbnRleHQxMS5wcmV2ID0gMTQ7CiAgICAgICAgICAgICAgICAgICAgX2NvbnRleHQxMS50MSA9IF9jb250ZXh0MTFbImNhdGNoIl0oNSk7CgogICAgICAgICAgICAgICAgICAgIF9pdGVyYXRvcjIuZShfY29udGV4dDExLnQxKTsKCiAgICAgICAgICAgICAgICAgIGNhc2UgMTc6CiAgICAgICAgICAgICAgICAgICAgX2NvbnRleHQxMS5wcmV2ID0gMTc7CgogICAgICAgICAgICAgICAgICAgIF9pdGVyYXRvcjIuZigpOwoKICAgICAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQxMS5maW5pc2goMTcpOwoKICAgICAgICAgICAgICAgICAgY2FzZSAyMDoKICAgICAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQxMS5hYnJ1cHQoInJldHVybiIsIGdyb3Vwcyk7CgogICAgICAgICAgICAgICAgICBjYXNlIDIxOgogICAgICAgICAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDExLnN0b3AoKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0sIF9jYWxsZWU5LCBudWxsLCBbWzUsIDE0LCAxNywgMjBdXSk7CiAgICAgICAgICB9KSkoKTsKICAgICAgICB9LAogICAgICAgIGFkZEl0ZW06IGZ1bmN0aW9uIGFkZEl0ZW0oY29udGV4dCkgewogICAgICAgICAgdmFyIF9hcmd1bWVudHMyID0gYXJndW1lbnRzOwogICAgICAgICAgcmV0dXJuIF9hc3luY1RvR2VuZXJhdG9yKCAvKiNfX1BVUkVfXyovcmVnZW5lcmF0b3JSdW50aW1lLm1hcmsoZnVuY3Rpb24gX2NhbGxlZTExKCkgewogICAgICAgICAgICB2YXIgYXJnOwogICAgICAgICAgICByZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLndyYXAoZnVuY3Rpb24gX2NhbGxlZTExJChfY29udGV4dDEzKSB7CiAgICAgICAgICAgICAgd2hpbGUgKDEpIHsKICAgICAgICAgICAgICAgIHN3aXRjaCAoX2NvbnRleHQxMy5wcmV2ID0gX2NvbnRleHQxMy5uZXh0KSB7CiAgICAgICAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICAgICAgICBhcmcgPSBfYXJndW1lbnRzMi5sZW5ndGggPiAxICYmIF9hcmd1bWVudHMyWzFdICE9PSB1bmRlZmluZWQgPyBfYXJndW1lbnRzMlsxXSA6IHsKICAgICAgICAgICAgICAgICAgICAgIGRhdGE6IGRhdGEKICAgICAgICAgICAgICAgICAgICB9OwogICAgICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDEzLmFicnVwdCgicmV0dXJuIiwgY29udGV4dC5zdGF0ZS5wcm9jZXNzb3IuYWNxdWlyZSgiYWRkSXRlbSIsIC8qI19fUFVSRV9fKi9fYXN5bmNUb0dlbmVyYXRvciggLyojX19QVVJFX18qL3JlZ2VuZXJhdG9yUnVudGltZS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWUxMCgpIHsKICAgICAgICAgICAgICAgICAgICAgIHZhciBkYXRhLCBhcGksIGVycm9yLCBjb250ZW50LCBwcm9kdWN0TmV3LCBpdGVtOwogICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHJlZ2VuZXJhdG9yUnVudGltZS53cmFwKGZ1bmN0aW9uIF9jYWxsZWUxMCQoX2NvbnRleHQxMikgewogICAgICAgICAgICAgICAgICAgICAgICB3aGlsZSAoMSkgewogICAgICAgICAgICAgICAgICAgICAgICAgIHN3aXRjaCAoX2NvbnRleHQxMi5wcmV2ID0gX2NvbnRleHQxMi5uZXh0KSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRhdGEgPSBhcmcuZGF0YTsKCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChkYXRhKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgX2NvbnRleHQxMi5uZXh0ID0gMzsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCJkYXRhIG5vdCB2YWxpZCIpOwoKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgMzoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgX2NvbnRleHQxMi5uZXh0ID0gNTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIEFwaUhvc3QucmVxdWVzdCgpLlBPU1QoKS51cmwoInByb2R1Y3R2Mi8iKS5ib2R5KHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb250ZW50OiBkYXRhCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pLnNlbmQoKTsKCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDU6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFwaSA9IF9jb250ZXh0MTIuc2VudDsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZXJyb3IgPSBhcGkuZ2V0RXJyb3IoKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29udGVudCA9IGFwaS5nZXRDb250ZW50KCk7CgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoIWVycm9yKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgX2NvbnRleHQxMi5uZXh0ID0gMTA7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihlcnJvcik7CgogICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAxMDoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcHJvZHVjdE5ldyA9IG5ldyBQcm9kdWN0KFN0b3JlcykuZnJvbURhdGEoY29udGVudCk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGl0ZW0gPSBuZXcgQ29sbGVjdGlvblVwZGF0ZXIoY29udGV4dCkub25JZChmdW5jdGlvbiAoaXRlbSkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBpdGVtLmlkOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KS5nZXRJdGVtKHByb2R1Y3ROZXcpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQxMi5hYnJ1cHQoInJldHVybiIsIGl0ZW0pOwoKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgMTM6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQxMi5zdG9wKCk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICB9LCBfY2FsbGVlMTApOwogICAgICAgICAgICAgICAgICAgIH0pKSkuY2F0Y2goZnVuY3Rpb24gKGVycm9yKSB7CiAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmVycm9yKGVycm9yKTsKICAgICAgICAgICAgICAgICAgICAgIHRocm93IGVycm9yOwogICAgICAgICAgICAgICAgICAgIH0pKTsKCiAgICAgICAgICAgICAgICAgIGNhc2UgMjoKICAgICAgICAgICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQxMy5zdG9wKCk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9LCBfY2FsbGVlMTEpOwogICAgICAgICAgfSkpKCk7CiAgICAgICAgfSwKICAgICAgICByZW1vdmVJdGVtT2ZJZDogZnVuY3Rpb24gcmVtb3ZlSXRlbU9mSWQoY29udGV4dCkgewogICAgICAgICAgdmFyIF9hcmd1bWVudHMzID0gYXJndW1lbnRzOwogICAgICAgICAgcmV0dXJuIF9hc3luY1RvR2VuZXJhdG9yKCAvKiNfX1BVUkVfXyovcmVnZW5lcmF0b3JSdW50aW1lLm1hcmsoZnVuY3Rpb24gX2NhbGxlZTEzKCkgewogICAgICAgICAgICB2YXIgYXJnOwogICAgICAgICAgICByZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLndyYXAoZnVuY3Rpb24gX2NhbGxlZTEzJChfY29udGV4dDE1KSB7CiAgICAgICAgICAgICAgd2hpbGUgKDEpIHsKICAgICAgICAgICAgICAgIHN3aXRjaCAoX2NvbnRleHQxNS5wcmV2ID0gX2NvbnRleHQxNS5uZXh0KSB7CiAgICAgICAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICAgICAgICBhcmcgPSBfYXJndW1lbnRzMy5sZW5ndGggPiAxICYmIF9hcmd1bWVudHMzWzFdICE9PSB1bmRlZmluZWQgPyBfYXJndW1lbnRzM1sxXSA6IHsKICAgICAgICAgICAgICAgICAgICAgIGlkOiBpZAogICAgICAgICAgICAgICAgICAgIH07CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0MTUuYWJydXB0KCJyZXR1cm4iLCBjb250ZXh0LnN0YXRlLnByb2Nlc3Nvci5hY3F1aXJlKCJyZW1vdmVJdGVtT2ZJZCIsIC8qI19fUFVSRV9fKi9fYXN5bmNUb0dlbmVyYXRvciggLyojX19QVVJFX18qL3JlZ2VuZXJhdG9yUnVudGltZS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWUxMigpIHsKICAgICAgICAgICAgICAgICAgICAgIHZhciBpZCwgYXBpLCBlcnJvciwgaXRlbXM7CiAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLndyYXAoZnVuY3Rpb24gX2NhbGxlZTEyJChfY29udGV4dDE0KSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHdoaWxlICgxKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgc3dpdGNoIChfY29udGV4dDE0LnByZXYgPSBfY29udGV4dDE0Lm5leHQpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWQgPSBhcmcuaWQ7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9jb250ZXh0MTQubmV4dCA9IDM7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBBcGlIb3N0LnJlcXVlc3QoKS5ERUxFVEUoKS51cmwoInByb2R1Y3R2Mi9pZC8iLmNvbmNhdChpZCkpLmJvZHkoewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlkOiBpZAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KS5zZW5kKCk7CgogICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAzOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhcGkgPSBfY29udGV4dDE0LnNlbnQ7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVycm9yID0gYXBpLmdldEVycm9yKCk7CgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoIWVycm9yKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgX2NvbnRleHQxNC5uZXh0ID0gNzsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKGVycm9yKTsKCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDc6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGl0ZW1zID0gY29udGV4dC5zdGF0ZS5pdGVtcy5maWx0ZXIoZnVuY3Rpb24gKGl0ZW0pIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gaXRlbS5pZCAhPT0gaWQ7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb250ZXh0LmNvbW1pdCgiaXRlbXMiLCBpdGVtcyk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRleHQuY29tbWl0KCJsYXN0TW9kaWZpZWQiLCBEYXRlLm5vdygpKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0MTQuYWJydXB0KCJyZXR1cm4iLCB0cnVlKTsKCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDExOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0MTQuc3RvcCgpOwogICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgfSwgX2NhbGxlZTEyKTsKICAgICAgICAgICAgICAgICAgICB9KSkpKTsKCiAgICAgICAgICAgICAgICAgIGNhc2UgMjoKICAgICAgICAgICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQxNS5zdG9wKCk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9LCBfY2FsbGVlMTMpOwogICAgICAgICAgfSkpKCk7CiAgICAgICAgfSwKICAgICAgICBvblVwZGF0ZUl0ZW06IGZ1bmN0aW9uIG9uVXBkYXRlSXRlbShjb250ZXh0KSB7CiAgICAgICAgICB2YXIgX2FyZ3VtZW50czQgPSBhcmd1bWVudHM7CiAgICAgICAgICByZXR1cm4gX2FzeW5jVG9HZW5lcmF0b3IoIC8qI19fUFVSRV9fKi9yZWdlbmVyYXRvclJ1bnRpbWUubWFyayhmdW5jdGlvbiBfY2FsbGVlMTUoKSB7CiAgICAgICAgICAgIHZhciBhcmc7CiAgICAgICAgICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUud3JhcChmdW5jdGlvbiBfY2FsbGVlMTUkKF9jb250ZXh0MTcpIHsKICAgICAgICAgICAgICB3aGlsZSAoMSkgewogICAgICAgICAgICAgICAgc3dpdGNoIChfY29udGV4dDE3LnByZXYgPSBfY29udGV4dDE3Lm5leHQpIHsKICAgICAgICAgICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICAgICAgICAgIGFyZyA9IF9hcmd1bWVudHM0Lmxlbmd0aCA+IDEgJiYgX2FyZ3VtZW50czRbMV0gIT09IHVuZGVmaW5lZCA/IF9hcmd1bWVudHM0WzFdIDogewogICAgICAgICAgICAgICAgICAgICAgaWQ6IGlkLAogICAgICAgICAgICAgICAgICAgICAgY2FsbGJhY2s6IGNhbGxiYWNrCiAgICAgICAgICAgICAgICAgICAgfTsKICAgICAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQxNy5hYnJ1cHQoInJldHVybiIsIGNvbnRleHQuc3RhdGUucHJvY2Vzc29yLmFjcXVpcmUoIm9uVXBkYXRlSXRlbSIsIC8qI19fUFVSRV9fKi9fYXN5bmNUb0dlbmVyYXRvciggLyojX19QVVJFX18qL3JlZ2VuZXJhdG9yUnVudGltZS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWUxNCgpIHsKICAgICAgICAgICAgICAgICAgICAgIHZhciBpZCwgY2FsbGJhY2ssIGl0ZW07CiAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLndyYXAoZnVuY3Rpb24gX2NhbGxlZTE0JChfY29udGV4dDE2KSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHdoaWxlICgxKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgc3dpdGNoIChfY29udGV4dDE2LnByZXYgPSBfY29udGV4dDE2Lm5leHQpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWQgPSBhcmcuaWQsIGNhbGxiYWNrID0gYXJnLmNhbGxiYWNrOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfY29udGV4dDE2Lm5leHQgPSAzOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gY29udGV4dC5kaXNwYXRjaCgiZ2V0SXRlbU9mSWQiLCBpZCk7CgogICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAzOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpdGVtID0gX2NvbnRleHQxNi5zZW50OwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoaXRlbSkgY2FsbGJhY2soaXRlbSk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDE2LmFicnVwdCgicmV0dXJuIiwgaXRlbSk7CgogICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSA2OgogICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0MTYuc3RvcCgpOwogICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgfSwgX2NhbGxlZTE0KTsKICAgICAgICAgICAgICAgICAgICB9KSkpKTsKCiAgICAgICAgICAgICAgICAgIGNhc2UgMjoKICAgICAgICAgICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQxNy5zdG9wKCk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9LCBfY2FsbGVlMTUpOwogICAgICAgICAgfSkpKCk7CiAgICAgICAgfSwKICAgICAgICB1cGRhdGVUaXRsZU9mSWQ6IGZ1bmN0aW9uIHVwZGF0ZVRpdGxlT2ZJZChjb250ZXh0KSB7CiAgICAgICAgICB2YXIgX2FyZ3VtZW50czUgPSBhcmd1bWVudHM7CiAgICAgICAgICByZXR1cm4gX2FzeW5jVG9HZW5lcmF0b3IoIC8qI19fUFVSRV9fKi9yZWdlbmVyYXRvclJ1bnRpbWUubWFyayhmdW5jdGlvbiBfY2FsbGVlMTcoKSB7CiAgICAgICAgICAgIHZhciBhcmc7CiAgICAgICAgICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUud3JhcChmdW5jdGlvbiBfY2FsbGVlMTckKF9jb250ZXh0MTkpIHsKICAgICAgICAgICAgICB3aGlsZSAoMSkgewogICAgICAgICAgICAgICAgc3dpdGNoIChfY29udGV4dDE5LnByZXYgPSBfY29udGV4dDE5Lm5leHQpIHsKICAgICAgICAgICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICAgICAgICAgIGFyZyA9IF9hcmd1bWVudHM1Lmxlbmd0aCA+IDEgJiYgX2FyZ3VtZW50czVbMV0gIT09IHVuZGVmaW5lZCA/IF9hcmd1bWVudHM1WzFdIDogewogICAgICAgICAgICAgICAgICAgICAgaWQ6IGlkLAogICAgICAgICAgICAgICAgICAgICAgdGl0bGU6IHRpdGxlCiAgICAgICAgICAgICAgICAgICAgfTsKICAgICAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQxOS5hYnJ1cHQoInJldHVybiIsIGNvbnRleHQuc3RhdGUucHJvY2Vzc29yLmFjcXVpcmUoInVwZGF0ZVRpdGxlT2ZJZCIsIC8qI19fUFVSRV9fKi9fYXN5bmNUb0dlbmVyYXRvciggLyojX19QVVJFX18qL3JlZ2VuZXJhdG9yUnVudGltZS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWUxNigpIHsKICAgICAgICAgICAgICAgICAgICAgIHZhciBpZCwgdGl0bGUsIGFwaSwgZXJyb3IsIGNvbnRlbnQsIGl0ZW07CiAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLndyYXAoZnVuY3Rpb24gX2NhbGxlZTE2JChfY29udGV4dDE4KSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHdoaWxlICgxKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgc3dpdGNoIChfY29udGV4dDE4LnByZXYgPSBfY29udGV4dDE4Lm5leHQpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWQgPSBhcmcuaWQsIHRpdGxlID0gYXJnLnRpdGxlOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfY29udGV4dDE4Lm5leHQgPSAzOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gQXBpSG9zdC5yZXF1ZXN0KCkuUFVUKCkudXJsKCJwcm9kdWN0djIvdGl0bGUvIikuYm9keSh7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29udGVudDogewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcHJvZHVjdElkOiBpZCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRpdGxlOiB0aXRsZQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSkuc2VuZCgpOwoKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgMzoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYXBpID0gX2NvbnRleHQxOC5zZW50OwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlcnJvciA9IGFwaS5nZXRFcnJvcigpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb250ZW50ID0gYXBpLmdldENvbnRlbnQoKTsKCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICghZXJyb3IpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfY29udGV4dDE4Lm5leHQgPSA4OwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoZXJyb3IpOwoKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgODoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgX2NvbnRleHQxOC5uZXh0ID0gMTA7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBjb250ZXh0LmRpc3BhdGNoKCJvblVwZGF0ZUl0ZW0iLCB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWQ6IGNvbnRlbnQucHJvZHVjdElkLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhbGxiYWNrOiBmdW5jdGlvbiBjYWxsYmFjayhpdGVtKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpdGVtLnRpdGxlID0gVS5vcHRTdHJpbmcoY29udGVudC50aXRsZSk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTsKCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDEwOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpdGVtID0gX2NvbnRleHQxOC5zZW50OwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQxOC5hYnJ1cHQoInJldHVybiIsIGl0ZW0pOwoKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgMTI6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQxOC5zdG9wKCk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICB9LCBfY2FsbGVlMTYpOwogICAgICAgICAgICAgICAgICAgIH0pKSkpOwoKICAgICAgICAgICAgICAgICAgY2FzZSAyOgogICAgICAgICAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDE5LnN0b3AoKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0sIF9jYWxsZWUxNyk7CiAgICAgICAgICB9KSkoKTsKICAgICAgICB9LAogICAgICAgIHVwZGF0ZURlc2NyaXB0aW9uT2ZJZDogZnVuY3Rpb24gdXBkYXRlRGVzY3JpcHRpb25PZklkKGNvbnRleHQpIHsKICAgICAgICAgIHZhciBfYXJndW1lbnRzNiA9IGFyZ3VtZW50czsKICAgICAgICAgIHJldHVybiBfYXN5bmNUb0dlbmVyYXRvciggLyojX19QVVJFX18qL3JlZ2VuZXJhdG9yUnVudGltZS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWUxOSgpIHsKICAgICAgICAgICAgdmFyIGFyZzsKICAgICAgICAgICAgcmV0dXJuIHJlZ2VuZXJhdG9yUnVudGltZS53cmFwKGZ1bmN0aW9uIF9jYWxsZWUxOSQoX2NvbnRleHQyMSkgewogICAgICAgICAgICAgIHdoaWxlICgxKSB7CiAgICAgICAgICAgICAgICBzd2l0Y2ggKF9jb250ZXh0MjEucHJldiA9IF9jb250ZXh0MjEubmV4dCkgewogICAgICAgICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgICAgICAgYXJnID0gX2FyZ3VtZW50czYubGVuZ3RoID4gMSAmJiBfYXJndW1lbnRzNlsxXSAhPT0gdW5kZWZpbmVkID8gX2FyZ3VtZW50czZbMV0gOiB7CiAgICAgICAgICAgICAgICAgICAgICBpZDogaWQsCiAgICAgICAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogZGVzY3JpcHRpb24KICAgICAgICAgICAgICAgICAgICB9OwogICAgICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDIxLmFicnVwdCgicmV0dXJuIiwgY29udGV4dC5zdGF0ZS5wcm9jZXNzb3IuYWNxdWlyZSgidXBkYXRlRGVzY3JpcHRpb25PZklkIiwgLyojX19QVVJFX18qL19hc3luY1RvR2VuZXJhdG9yKCAvKiNfX1BVUkVfXyovcmVnZW5lcmF0b3JSdW50aW1lLm1hcmsoZnVuY3Rpb24gX2NhbGxlZTE4KCkgewogICAgICAgICAgICAgICAgICAgICAgdmFyIGlkLCBkZXNjcmlwdGlvbiwgYXBpLCBlcnJvciwgY29udGVudCwgaXRlbTsKICAgICAgICAgICAgICAgICAgICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUud3JhcChmdW5jdGlvbiBfY2FsbGVlMTgkKF9jb250ZXh0MjApIHsKICAgICAgICAgICAgICAgICAgICAgICAgd2hpbGUgKDEpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICBzd2l0Y2ggKF9jb250ZXh0MjAucHJldiA9IF9jb250ZXh0MjAubmV4dCkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZCA9IGFyZy5pZCwgZGVzY3JpcHRpb24gPSBhcmcuZGVzY3JpcHRpb247CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9jb250ZXh0MjAubmV4dCA9IDM7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBBcGlIb3N0LnJlcXVlc3QoKS5QVVQoKS51cmwoInByb2R1Y3R2Mi9kZXNjcmlwdGlvbi8iKS5ib2R5KHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb250ZW50OiB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwcm9kdWN0SWQ6IGlkLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVzY3JpcHRpb246IGRlc2NyaXB0aW9uCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KS5zZW5kKCk7CgogICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAzOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhcGkgPSBfY29udGV4dDIwLnNlbnQ7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVycm9yID0gYXBpLmdldEVycm9yKCk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRlbnQgPSBhcGkuZ2V0Q29udGVudCgpOwoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFlcnJvcikgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9jb250ZXh0MjAubmV4dCA9IDg7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihlcnJvcik7CgogICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSA4OgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfY29udGV4dDIwLm5leHQgPSAxMDsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGNvbnRleHQuZGlzcGF0Y2goIm9uVXBkYXRlSXRlbSIsIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZDogY29udGVudC5wcm9kdWN0SWQsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FsbGJhY2s6IGZ1bmN0aW9uIGNhbGxiYWNrKGl0ZW0pIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGl0ZW0uZGVzY3JpcHRpb24gPSBVLmlzU3RyaW5nKGNvbnRlbnQuZGVzY3JpcHRpb24pID8gY29udGVudC5kZXNjcmlwdGlvbi50cmltKCkgOiAiIjsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pOwoKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgMTA6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGl0ZW0gPSBfY29udGV4dDIwLnNlbnQ7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDIwLmFicnVwdCgicmV0dXJuIiwgaXRlbSk7CgogICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAxMjoKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDIwLnN0b3AoKTsKICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgIH0sIF9jYWxsZWUxOCk7CiAgICAgICAgICAgICAgICAgICAgfSkpKSk7CgogICAgICAgICAgICAgICAgICBjYXNlIDI6CiAgICAgICAgICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0MjEuc3RvcCgpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSwgX2NhbGxlZTE5KTsKICAgICAgICAgIH0pKSgpOwogICAgICAgIH0sCiAgICAgICAgdXBkYXRlQnJhbmRJZE9mSWQ6IGZ1bmN0aW9uIHVwZGF0ZUJyYW5kSWRPZklkKGNvbnRleHQpIHsKICAgICAgICAgIHZhciBfYXJndW1lbnRzNyA9IGFyZ3VtZW50czsKICAgICAgICAgIHJldHVybiBfYXN5bmNUb0dlbmVyYXRvciggLyojX19QVVJFX18qL3JlZ2VuZXJhdG9yUnVudGltZS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWUyMSgpIHsKICAgICAgICAgICAgdmFyIGFyZzsKICAgICAgICAgICAgcmV0dXJuIHJlZ2VuZXJhdG9yUnVudGltZS53cmFwKGZ1bmN0aW9uIF9jYWxsZWUyMSQoX2NvbnRleHQyMykgewogICAgICAgICAgICAgIHdoaWxlICgxKSB7CiAgICAgICAgICAgICAgICBzd2l0Y2ggKF9jb250ZXh0MjMucHJldiA9IF9jb250ZXh0MjMubmV4dCkgewogICAgICAgICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgICAgICAgYXJnID0gX2FyZ3VtZW50czcubGVuZ3RoID4gMSAmJiBfYXJndW1lbnRzN1sxXSAhPT0gdW5kZWZpbmVkID8gX2FyZ3VtZW50czdbMV0gOiB7CiAgICAgICAgICAgICAgICAgICAgICBpZDogaWQsCiAgICAgICAgICAgICAgICAgICAgICBicmFuZElkOiBicmFuZElkCiAgICAgICAgICAgICAgICAgICAgfTsKICAgICAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQyMy5hYnJ1cHQoInJldHVybiIsIGNvbnRleHQuc3RhdGUucHJvY2Vzc29yLmFjcXVpcmUoInVwZGF0ZUJyYW5kSWRPZklkIiwgLyojX19QVVJFX18qL19hc3luY1RvR2VuZXJhdG9yKCAvKiNfX1BVUkVfXyovcmVnZW5lcmF0b3JSdW50aW1lLm1hcmsoZnVuY3Rpb24gX2NhbGxlZTIwKCkgewogICAgICAgICAgICAgICAgICAgICAgdmFyIGlkLCBicmFuZElkLCBhcGksIGVycm9yLCBjb250ZW50LCBpdGVtOwogICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHJlZ2VuZXJhdG9yUnVudGltZS53cmFwKGZ1bmN0aW9uIF9jYWxsZWUyMCQoX2NvbnRleHQyMikgewogICAgICAgICAgICAgICAgICAgICAgICB3aGlsZSAoMSkgewogICAgICAgICAgICAgICAgICAgICAgICAgIHN3aXRjaCAoX2NvbnRleHQyMi5wcmV2ID0gX2NvbnRleHQyMi5uZXh0KSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlkID0gYXJnLmlkLCBicmFuZElkID0gYXJnLmJyYW5kSWQ7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9jb250ZXh0MjIubmV4dCA9IDM7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBBcGlIb3N0LnJlcXVlc3QoKS5QVVQoKS51cmwoInByb2R1Y3R2Mi9icmFuZElkLyIpLmJvZHkoewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRlbnQ6IHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHByb2R1Y3RJZDogaWQsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmFuZElkOiBicmFuZElkCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KS5zZW5kKCk7CgogICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAzOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhcGkgPSBfY29udGV4dDIyLnNlbnQ7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVycm9yID0gYXBpLmdldEVycm9yKCk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRlbnQgPSBhcGkuZ2V0Q29udGVudCgpOwoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFlcnJvcikgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9jb250ZXh0MjIubmV4dCA9IDg7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihlcnJvcik7CgogICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSA4OgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfY29udGV4dDIyLm5leHQgPSAxMDsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGNvbnRleHQuZGlzcGF0Y2goIm9uVXBkYXRlSXRlbSIsIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZDogY29udGVudC5wcm9kdWN0SWQsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FsbGJhY2s6IGZ1bmN0aW9uIGNhbGxiYWNrKGl0ZW0pIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBpdGVtLnNldEJyYW5kSWQoY29udGVudC5icmFuZElkKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pOwoKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgMTA6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGl0ZW0gPSBfY29udGV4dDIyLnNlbnQ7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDIyLmFicnVwdCgicmV0dXJuIiwgaXRlbSk7CgogICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAxMjoKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDIyLnN0b3AoKTsKICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgIH0sIF9jYWxsZWUyMCk7CiAgICAgICAgICAgICAgICAgICAgfSkpKSk7CgogICAgICAgICAgICAgICAgICBjYXNlIDI6CiAgICAgICAgICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0MjMuc3RvcCgpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSwgX2NhbGxlZTIxKTsKICAgICAgICAgIH0pKSgpOwogICAgICAgIH0sCiAgICAgICAgdXBkYXRlQ2F0ZWdvcnlJZE9mSWQ6IGZ1bmN0aW9uIHVwZGF0ZUNhdGVnb3J5SWRPZklkKGNvbnRleHQpIHsKICAgICAgICAgIHZhciBfYXJndW1lbnRzOCA9IGFyZ3VtZW50czsKICAgICAgICAgIHJldHVybiBfYXN5bmNUb0dlbmVyYXRvciggLyojX19QVVJFX18qL3JlZ2VuZXJhdG9yUnVudGltZS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWUyMygpIHsKICAgICAgICAgICAgdmFyIGFyZzsKICAgICAgICAgICAgcmV0dXJuIHJlZ2VuZXJhdG9yUnVudGltZS53cmFwKGZ1bmN0aW9uIF9jYWxsZWUyMyQoX2NvbnRleHQyNSkgewogICAgICAgICAgICAgIHdoaWxlICgxKSB7CiAgICAgICAgICAgICAgICBzd2l0Y2ggKF9jb250ZXh0MjUucHJldiA9IF9jb250ZXh0MjUubmV4dCkgewogICAgICAgICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgICAgICAgYXJnID0gX2FyZ3VtZW50czgubGVuZ3RoID4gMSAmJiBfYXJndW1lbnRzOFsxXSAhPT0gdW5kZWZpbmVkID8gX2FyZ3VtZW50czhbMV0gOiB7CiAgICAgICAgICAgICAgICAgICAgICBpZDogaWQsCiAgICAgICAgICAgICAgICAgICAgICBjYXRlZ29yeUlkOiBjYXRlZ29yeUlkCiAgICAgICAgICAgICAgICAgICAgfTsKICAgICAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQyNS5hYnJ1cHQoInJldHVybiIsIGNvbnRleHQuc3RhdGUucHJvY2Vzc29yLmFjcXVpcmUoInVwZGF0ZUNhdGVnb3J5SWRPZklkIiwgLyojX19QVVJFX18qL19hc3luY1RvR2VuZXJhdG9yKCAvKiNfX1BVUkVfXyovcmVnZW5lcmF0b3JSdW50aW1lLm1hcmsoZnVuY3Rpb24gX2NhbGxlZTIyKCkgewogICAgICAgICAgICAgICAgICAgICAgdmFyIGlkLCBjYXRlZ29yeUlkLCBhcGksIGVycm9yLCBjb250ZW50LCBpdGVtOwogICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHJlZ2VuZXJhdG9yUnVudGltZS53cmFwKGZ1bmN0aW9uIF9jYWxsZWUyMiQoX2NvbnRleHQyNCkgewogICAgICAgICAgICAgICAgICAgICAgICB3aGlsZSAoMSkgewogICAgICAgICAgICAgICAgICAgICAgICAgIHN3aXRjaCAoX2NvbnRleHQyNC5wcmV2ID0gX2NvbnRleHQyNC5uZXh0KSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlkID0gYXJnLmlkLCBjYXRlZ29yeUlkID0gYXJnLmNhdGVnb3J5SWQ7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9jb250ZXh0MjQubmV4dCA9IDM7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBBcGlIb3N0LnJlcXVlc3QoKS5QVVQoKS51cmwoInByb2R1Y3R2Mi9jYXRlZ29yeUlkLyIpLmJvZHkoewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRlbnQ6IHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHByb2R1Y3RJZDogaWQsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXRlZ29yeUlkOiBjYXRlZ29yeUlkCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KS5zZW5kKCk7CgogICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAzOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhcGkgPSBfY29udGV4dDI0LnNlbnQ7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVycm9yID0gYXBpLmdldEVycm9yKCk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRlbnQgPSBhcGkuZ2V0Q29udGVudCgpOwoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFlcnJvcikgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9jb250ZXh0MjQubmV4dCA9IDg7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihlcnJvcik7CgogICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSA4OgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfY29udGV4dDI0Lm5leHQgPSAxMDsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGNvbnRleHQuZGlzcGF0Y2goIm9uVXBkYXRlSXRlbSIsIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZDogY29udGVudC5wcm9kdWN0SWQsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FsbGJhY2s6IGZ1bmN0aW9uIGNhbGxiYWNrKGl0ZW0pIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBpdGVtLnNldENhdGVnb3J5SWQoY29udGVudC5jYXRlZ29yeUlkKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pOwoKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgMTA6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGl0ZW0gPSBfY29udGV4dDI0LnNlbnQ7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDI0LmFicnVwdCgicmV0dXJuIiwgaXRlbSk7CgogICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAxMjoKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDI0LnN0b3AoKTsKICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgIH0sIF9jYWxsZWUyMik7CiAgICAgICAgICAgICAgICAgICAgfSkpKSk7CgogICAgICAgICAgICAgICAgICBjYXNlIDI6CiAgICAgICAgICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0MjUuc3RvcCgpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSwgX2NhbGxlZTIzKTsKICAgICAgICAgIH0pKSgpOwogICAgICAgIH0sCiAgICAgICAgdXBkYXRlQXZhaWxhYmlsaXR5T2ZJZDogZnVuY3Rpb24gdXBkYXRlQXZhaWxhYmlsaXR5T2ZJZChjb250ZXh0KSB7CiAgICAgICAgICB2YXIgX2FyZ3VtZW50czkgPSBhcmd1bWVudHM7CiAgICAgICAgICByZXR1cm4gX2FzeW5jVG9HZW5lcmF0b3IoIC8qI19fUFVSRV9fKi9yZWdlbmVyYXRvclJ1bnRpbWUubWFyayhmdW5jdGlvbiBfY2FsbGVlMjUoKSB7CiAgICAgICAgICAgIHZhciBhcmc7CiAgICAgICAgICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUud3JhcChmdW5jdGlvbiBfY2FsbGVlMjUkKF9jb250ZXh0MjcpIHsKICAgICAgICAgICAgICB3aGlsZSAoMSkgewogICAgICAgICAgICAgICAgc3dpdGNoIChfY29udGV4dDI3LnByZXYgPSBfY29udGV4dDI3Lm5leHQpIHsKICAgICAgICAgICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICAgICAgICAgIGFyZyA9IF9hcmd1bWVudHM5Lmxlbmd0aCA+IDEgJiYgX2FyZ3VtZW50czlbMV0gIT09IHVuZGVmaW5lZCA/IF9hcmd1bWVudHM5WzFdIDogewogICAgICAgICAgICAgICAgICAgICAgaWQ6IGlkLAogICAgICAgICAgICAgICAgICAgICAgaXNBdmFpbGFibGU6IGlzQXZhaWxhYmxlCiAgICAgICAgICAgICAgICAgICAgfTsKICAgICAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQyNy5hYnJ1cHQoInJldHVybiIsIGNvbnRleHQuc3RhdGUucHJvY2Vzc29yLmFjcXVpcmUoInVwZGF0ZUF2YWlsYWJpbGl0eU9mSWQiLCAvKiNfX1BVUkVfXyovX2FzeW5jVG9HZW5lcmF0b3IoIC8qI19fUFVSRV9fKi9yZWdlbmVyYXRvclJ1bnRpbWUubWFyayhmdW5jdGlvbiBfY2FsbGVlMjQoKSB7CiAgICAgICAgICAgICAgICAgICAgICB2YXIgaWQsIGlzQXZhaWxhYmxlLCBhcGksIGVycm9yLCBjb250ZW50LCBpdGVtOwogICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHJlZ2VuZXJhdG9yUnVudGltZS53cmFwKGZ1bmN0aW9uIF9jYWxsZWUyNCQoX2NvbnRleHQyNikgewogICAgICAgICAgICAgICAgICAgICAgICB3aGlsZSAoMSkgewogICAgICAgICAgICAgICAgICAgICAgICAgIHN3aXRjaCAoX2NvbnRleHQyNi5wcmV2ID0gX2NvbnRleHQyNi5uZXh0KSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlkID0gYXJnLmlkLCBpc0F2YWlsYWJsZSA9IGFyZy5pc0F2YWlsYWJsZTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgX2NvbnRleHQyNi5uZXh0ID0gMzsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIEFwaUhvc3QucmVxdWVzdCgpLlBVVCgpLnVybCgicHJvZHVjdHYyL2lzQXZhaWxhYmxlLyIpLmJvZHkoewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRlbnQ6IHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHByb2R1Y3RJZDogaWQsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpc0F2YWlsYWJsZTogaXNBdmFpbGFibGUKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pLnNlbmQoKTsKCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDM6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFwaSA9IF9jb250ZXh0MjYuc2VudDsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZXJyb3IgPSBhcGkuZ2V0RXJyb3IoKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29udGVudCA9IGFwaS5nZXRDb250ZW50KCk7CgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoIWVycm9yKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgX2NvbnRleHQyNi5uZXh0ID0gODsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKGVycm9yKTsKCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDg6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9jb250ZXh0MjYubmV4dCA9IDEwOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gY29udGV4dC5kaXNwYXRjaCgib25VcGRhdGVJdGVtIiwgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlkOiBjb250ZW50LnByb2R1Y3RJZCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYWxsYmFjazogZnVuY3Rpb24gY2FsbGJhY2soaXRlbSkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaXRlbS5zdG9jay5pc0F2YWlsYWJsZSA9IGNvbnRlbnQuaXNBdmFpbGFibGU7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTsKCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDEwOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpdGVtID0gX2NvbnRleHQyNi5zZW50OwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQyNi5hYnJ1cHQoInJldHVybiIsIGl0ZW0pOwoKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgMTI6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQyNi5zdG9wKCk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICB9LCBfY2FsbGVlMjQpOwogICAgICAgICAgICAgICAgICAgIH0pKSkpOwoKICAgICAgICAgICAgICAgICAgY2FzZSAyOgogICAgICAgICAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDI3LnN0b3AoKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0sIF9jYWxsZWUyNSk7CiAgICAgICAgICB9KSkoKTsKICAgICAgICB9LAogICAgICAgIHVwZGF0ZVNlY29uZEhhbmRPZklkOiBmdW5jdGlvbiB1cGRhdGVTZWNvbmRIYW5kT2ZJZChjb250ZXh0KSB7CiAgICAgICAgICB2YXIgX2FyZ3VtZW50czEwID0gYXJndW1lbnRzOwogICAgICAgICAgcmV0dXJuIF9hc3luY1RvR2VuZXJhdG9yKCAvKiNfX1BVUkVfXyovcmVnZW5lcmF0b3JSdW50aW1lLm1hcmsoZnVuY3Rpb24gX2NhbGxlZTI3KCkgewogICAgICAgICAgICB2YXIgYXJnOwogICAgICAgICAgICByZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLndyYXAoZnVuY3Rpb24gX2NhbGxlZTI3JChfY29udGV4dDI5KSB7CiAgICAgICAgICAgICAgd2hpbGUgKDEpIHsKICAgICAgICAgICAgICAgIHN3aXRjaCAoX2NvbnRleHQyOS5wcmV2ID0gX2NvbnRleHQyOS5uZXh0KSB7CiAgICAgICAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICAgICAgICBhcmcgPSBfYXJndW1lbnRzMTAubGVuZ3RoID4gMSAmJiBfYXJndW1lbnRzMTBbMV0gIT09IHVuZGVmaW5lZCA/IF9hcmd1bWVudHMxMFsxXSA6IHsKICAgICAgICAgICAgICAgICAgICAgIGlkOiBpZCwKICAgICAgICAgICAgICAgICAgICAgIGlzU2Vjb25kSGFuZDogaXNTZWNvbmRIYW5kCiAgICAgICAgICAgICAgICAgICAgfTsKICAgICAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQyOS5hYnJ1cHQoInJldHVybiIsIGNvbnRleHQuc3RhdGUucHJvY2Vzc29yLmFjcXVpcmUoInVwZGF0ZVNlY29uZEhhbmRPZklkIiwgLyojX19QVVJFX18qL19hc3luY1RvR2VuZXJhdG9yKCAvKiNfX1BVUkVfXyovcmVnZW5lcmF0b3JSdW50aW1lLm1hcmsoZnVuY3Rpb24gX2NhbGxlZTI2KCkgewogICAgICAgICAgICAgICAgICAgICAgdmFyIGlkLCBpc1NlY29uZEhhbmQsIGFwaSwgZXJyb3IsIGNvbnRlbnQsIGl0ZW07CiAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLndyYXAoZnVuY3Rpb24gX2NhbGxlZTI2JChfY29udGV4dDI4KSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHdoaWxlICgxKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgc3dpdGNoIChfY29udGV4dDI4LnByZXYgPSBfY29udGV4dDI4Lm5leHQpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWQgPSBhcmcuaWQsIGlzU2Vjb25kSGFuZCA9IGFyZy5pc1NlY29uZEhhbmQ7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9jb250ZXh0MjgubmV4dCA9IDM7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBBcGlIb3N0LnJlcXVlc3QoKS5QVVQoKS51cmwoInByb2R1Y3R2Mi9pc1NlY29uZEhhbmQvIikuYm9keSh7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29udGVudDogewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcHJvZHVjdElkOiBpZCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlzU2Vjb25kSGFuZDogaXNTZWNvbmRIYW5kCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KS5zZW5kKCk7CgogICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAzOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhcGkgPSBfY29udGV4dDI4LnNlbnQ7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVycm9yID0gYXBpLmdldEVycm9yKCk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRlbnQgPSBhcGkuZ2V0Q29udGVudCgpOwoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFlcnJvcikgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9jb250ZXh0MjgubmV4dCA9IDg7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihlcnJvcik7CgogICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSA4OgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfY29udGV4dDI4Lm5leHQgPSAxMDsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGNvbnRleHQuZGlzcGF0Y2goIm9uVXBkYXRlSXRlbSIsIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZDogY29udGVudC5wcm9kdWN0SWQsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FsbGJhY2s6IGZ1bmN0aW9uIGNhbGxiYWNrKGl0ZW0pIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGl0ZW0uc3RvY2suaXNTZWNvbmRIYW5kID0gY29udGVudC5pc1NlY29uZEhhbmQ7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTsKCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDEwOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpdGVtID0gX2NvbnRleHQyOC5zZW50OwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQyOC5hYnJ1cHQoInJldHVybiIsIGl0ZW0pOwoKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgMTI6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQyOC5zdG9wKCk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICB9LCBfY2FsbGVlMjYpOwogICAgICAgICAgICAgICAgICAgIH0pKSkpOwoKICAgICAgICAgICAgICAgICAgY2FzZSAyOgogICAgICAgICAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDI5LnN0b3AoKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0sIF9jYWxsZWUyNyk7CiAgICAgICAgICB9KSkoKTsKICAgICAgICB9LAogICAgICAgIHVwZGF0ZVByaWNlT2ZJZDogZnVuY3Rpb24gdXBkYXRlUHJpY2VPZklkKGNvbnRleHQpIHsKICAgICAgICAgIHZhciBfYXJndW1lbnRzMTEgPSBhcmd1bWVudHM7CiAgICAgICAgICByZXR1cm4gX2FzeW5jVG9HZW5lcmF0b3IoIC8qI19fUFVSRV9fKi9yZWdlbmVyYXRvclJ1bnRpbWUubWFyayhmdW5jdGlvbiBfY2FsbGVlMjkoKSB7CiAgICAgICAgICAgIHZhciBhcmc7CiAgICAgICAgICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUud3JhcChmdW5jdGlvbiBfY2FsbGVlMjkkKF9jb250ZXh0MzEpIHsKICAgICAgICAgICAgICB3aGlsZSAoMSkgewogICAgICAgICAgICAgICAgc3dpdGNoIChfY29udGV4dDMxLnByZXYgPSBfY29udGV4dDMxLm5leHQpIHsKICAgICAgICAgICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICAgICAgICAgIGFyZyA9IF9hcmd1bWVudHMxMS5sZW5ndGggPiAxICYmIF9hcmd1bWVudHMxMVsxXSAhPT0gdW5kZWZpbmVkID8gX2FyZ3VtZW50czExWzFdIDogewogICAgICAgICAgICAgICAgICAgICAgaWQ6IGlkLAogICAgICAgICAgICAgICAgICAgICAgcHJpY2U6IHByaWNlCiAgICAgICAgICAgICAgICAgICAgfTsKICAgICAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQzMS5hYnJ1cHQoInJldHVybiIsIGNvbnRleHQuc3RhdGUucHJvY2Vzc29yLmFjcXVpcmUoInVwZGF0ZVByaWNlT2ZJZCIsIC8qI19fUFVSRV9fKi9fYXN5bmNUb0dlbmVyYXRvciggLyojX19QVVJFX18qL3JlZ2VuZXJhdG9yUnVudGltZS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWUyOCgpIHsKICAgICAgICAgICAgICAgICAgICAgIHZhciBpZCwgcHJpY2UsIGFwaSwgZXJyb3IsIGNvbnRlbnQsIGl0ZW07CiAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLndyYXAoZnVuY3Rpb24gX2NhbGxlZTI4JChfY29udGV4dDMwKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHdoaWxlICgxKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgc3dpdGNoIChfY29udGV4dDMwLnByZXYgPSBfY29udGV4dDMwLm5leHQpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWQgPSBhcmcuaWQsIHByaWNlID0gYXJnLnByaWNlOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwcmljZSA9IE1vZHVsZVByaWNlLnRyaW0ocHJpY2UpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfY29udGV4dDMwLm5leHQgPSA0OwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gQXBpSG9zdC5yZXF1ZXN0KCkuUFVUKCkudXJsKCJwcm9kdWN0djIvcHJpY2UvIikuYm9keSh7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29udGVudDogewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcHJvZHVjdElkOiBpZCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHByaWNlOiBwcmljZQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSkuc2VuZCgpOwoKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgNDoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYXBpID0gX2NvbnRleHQzMC5zZW50OwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlcnJvciA9IGFwaS5nZXRFcnJvcigpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb250ZW50ID0gYXBpLmdldENvbnRlbnQoKTsKCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICghZXJyb3IpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfY29udGV4dDMwLm5leHQgPSA5OwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoZXJyb3IpOwoKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgOToKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgX2NvbnRleHQzMC5uZXh0ID0gMTE7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBjb250ZXh0LmRpc3BhdGNoKCJvblVwZGF0ZUl0ZW0iLCB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWQ6IGNvbnRlbnQucHJvZHVjdElkLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhbGxiYWNrOiBmdW5jdGlvbiBjYWxsYmFjayhpdGVtKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpdGVtLnNldFByaWNlKHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbm9ybWFsOiBjb250ZW50LnByaWNlLm5vcm1hbCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcHJvbW90aW9uOiBjb250ZW50LnByaWNlLnByb21vdGlvbgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTsKCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDExOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpdGVtID0gX2NvbnRleHQzMC5zZW50OwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQzMC5hYnJ1cHQoInJldHVybiIsIGl0ZW0pOwoKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgMTM6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQzMC5zdG9wKCk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICB9LCBfY2FsbGVlMjgpOwogICAgICAgICAgICAgICAgICAgIH0pKSkpOwoKICAgICAgICAgICAgICAgICAgY2FzZSAyOgogICAgICAgICAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDMxLnN0b3AoKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0sIF9jYWxsZWUyOSk7CiAgICAgICAgICB9KSkoKTsKICAgICAgICB9LAogICAgICAgIGFkZEJ1bmRsZU9mSWQ6IGZ1bmN0aW9uIGFkZEJ1bmRsZU9mSWQoY29udGV4dCkgewogICAgICAgICAgdmFyIF9hcmd1bWVudHMxMiA9IGFyZ3VtZW50czsKICAgICAgICAgIHJldHVybiBfYXN5bmNUb0dlbmVyYXRvciggLyojX19QVVJFX18qL3JlZ2VuZXJhdG9yUnVudGltZS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWUzMSgpIHsKICAgICAgICAgICAgdmFyIGFyZzsKICAgICAgICAgICAgcmV0dXJuIHJlZ2VuZXJhdG9yUnVudGltZS53cmFwKGZ1bmN0aW9uIF9jYWxsZWUzMSQoX2NvbnRleHQzMykgewogICAgICAgICAgICAgIHdoaWxlICgxKSB7CiAgICAgICAgICAgICAgICBzd2l0Y2ggKF9jb250ZXh0MzMucHJldiA9IF9jb250ZXh0MzMubmV4dCkgewogICAgICAgICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgICAgICAgYXJnID0gX2FyZ3VtZW50czEyLmxlbmd0aCA+IDEgJiYgX2FyZ3VtZW50czEyWzFdICE9PSB1bmRlZmluZWQgPyBfYXJndW1lbnRzMTJbMV0gOiB7CiAgICAgICAgICAgICAgICAgICAgICBpZDogaWQsCiAgICAgICAgICAgICAgICAgICAgICBidW5kbGU6IGJ1bmRsZQogICAgICAgICAgICAgICAgICAgIH07CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0MzMuYWJydXB0KCJyZXR1cm4iLCBjb250ZXh0LnN0YXRlLnByb2Nlc3Nvci5hY3F1aXJlKCJhZGRCdW5kbGVPZklkIiwgLyojX19QVVJFX18qL19hc3luY1RvR2VuZXJhdG9yKCAvKiNfX1BVUkVfXyovcmVnZW5lcmF0b3JSdW50aW1lLm1hcmsoZnVuY3Rpb24gX2NhbGxlZTMwKCkgewogICAgICAgICAgICAgICAgICAgICAgdmFyIGlkLCBidW5kbGUsIGFwaSwgZXJyb3IsIGNvbnRlbnQsIGl0ZW07CiAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLndyYXAoZnVuY3Rpb24gX2NhbGxlZTMwJChfY29udGV4dDMyKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHdoaWxlICgxKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgc3dpdGNoIChfY29udGV4dDMyLnByZXYgPSBfY29udGV4dDMyLm5leHQpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWQgPSBhcmcuaWQsIGJ1bmRsZSA9IGFyZy5idW5kbGU7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9jb250ZXh0MzIubmV4dCA9IDM7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBBcGlIb3N0LnJlcXVlc3QoKS5QT1NUKCkudXJsKCJwcm9kdWN0djIvYnVuZGxlLyIpLmJvZHkoewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRlbnQ6IHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHByb2R1Y3RJZDogaWQsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBidW5kbGU6IGJ1bmRsZQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSkuc2VuZCgpOwoKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgMzoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYXBpID0gX2NvbnRleHQzMi5zZW50OwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlcnJvciA9IGFwaS5nZXRFcnJvcigpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb250ZW50ID0gYXBpLmdldENvbnRlbnQoKTsKCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICghZXJyb3IpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfY29udGV4dDMyLm5leHQgPSA4OwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoZXJyb3IpOwoKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgODoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgX2NvbnRleHQzMi5uZXh0ID0gMTA7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBjb250ZXh0LmRpc3BhdGNoKCJvblVwZGF0ZUl0ZW0iLCB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWQ6IGNvbnRlbnQucHJvZHVjdElkLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhbGxiYWNrOiBmdW5jdGlvbiBjYWxsYmFjayhpdGVtKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpdGVtLmFkZEJ1bmRsZShNb2R1bGVCdW5kbGUudHJpbShjb250ZW50LmJ1bmRsZSkpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7CgogICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAxMDoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaXRlbSA9IF9jb250ZXh0MzIuc2VudDsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0MzIuYWJydXB0KCJyZXR1cm4iLCBpdGVtKTsKCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDEyOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0MzIuc3RvcCgpOwogICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgfSwgX2NhbGxlZTMwKTsKICAgICAgICAgICAgICAgICAgICB9KSkpKTsKCiAgICAgICAgICAgICAgICAgIGNhc2UgMjoKICAgICAgICAgICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQzMy5zdG9wKCk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9LCBfY2FsbGVlMzEpOwogICAgICAgICAgfSkpKCk7CiAgICAgICAgfSwKICAgICAgICByZW1vdmVCdW5kbGVPZklkOiBmdW5jdGlvbiByZW1vdmVCdW5kbGVPZklkKGNvbnRleHQpIHsKICAgICAgICAgIHZhciBfYXJndW1lbnRzMTMgPSBhcmd1bWVudHM7CiAgICAgICAgICByZXR1cm4gX2FzeW5jVG9HZW5lcmF0b3IoIC8qI19fUFVSRV9fKi9yZWdlbmVyYXRvclJ1bnRpbWUubWFyayhmdW5jdGlvbiBfY2FsbGVlMzMoKSB7CiAgICAgICAgICAgIHZhciBhcmc7CiAgICAgICAgICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUud3JhcChmdW5jdGlvbiBfY2FsbGVlMzMkKF9jb250ZXh0MzUpIHsKICAgICAgICAgICAgICB3aGlsZSAoMSkgewogICAgICAgICAgICAgICAgc3dpdGNoIChfY29udGV4dDM1LnByZXYgPSBfY29udGV4dDM1Lm5leHQpIHsKICAgICAgICAgICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICAgICAgICAgIGFyZyA9IF9hcmd1bWVudHMxMy5sZW5ndGggPiAxICYmIF9hcmd1bWVudHMxM1sxXSAhPT0gdW5kZWZpbmVkID8gX2FyZ3VtZW50czEzWzFdIDogewogICAgICAgICAgICAgICAgICAgICAgaWQ6IGlkLAogICAgICAgICAgICAgICAgICAgICAgYnVuZGxlOiBidW5kbGUKICAgICAgICAgICAgICAgICAgICB9OwogICAgICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDM1LmFicnVwdCgicmV0dXJuIiwgY29udGV4dC5zdGF0ZS5wcm9jZXNzb3IuYWNxdWlyZSgicmVtb3ZlQnVuZGxlT2ZJZCIsIC8qI19fUFVSRV9fKi9fYXN5bmNUb0dlbmVyYXRvciggLyojX19QVVJFX18qL3JlZ2VuZXJhdG9yUnVudGltZS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWUzMigpIHsKICAgICAgICAgICAgICAgICAgICAgIHZhciBpZCwgYnVuZGxlLCBhcGksIGVycm9yLCBjb250ZW50LCBpdGVtOwogICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHJlZ2VuZXJhdG9yUnVudGltZS53cmFwKGZ1bmN0aW9uIF9jYWxsZWUzMiQoX2NvbnRleHQzNCkgewogICAgICAgICAgICAgICAgICAgICAgICB3aGlsZSAoMSkgewogICAgICAgICAgICAgICAgICAgICAgICAgIHN3aXRjaCAoX2NvbnRleHQzNC5wcmV2ID0gX2NvbnRleHQzNC5uZXh0KSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlkID0gYXJnLmlkLCBidW5kbGUgPSBhcmcuYnVuZGxlOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfY29udGV4dDM0Lm5leHQgPSAzOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gQXBpSG9zdC5yZXF1ZXN0KCkuREVMRVRFKCkudXJsKCJwcm9kdWN0djIvYnVuZGxlLyIpLmJvZHkoewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRlbnQ6IHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHByb2R1Y3RJZDogaWQsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBidW5kbGU6IE1vZHVsZUJ1bmRsZS50cmltKGJ1bmRsZSkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pLnNlbmQoKTsKCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDM6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFwaSA9IF9jb250ZXh0MzQuc2VudDsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZXJyb3IgPSBhcGkuZ2V0RXJyb3IoKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29udGVudCA9IGFwaS5nZXRDb250ZW50KCk7CgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoIWVycm9yKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgX2NvbnRleHQzNC5uZXh0ID0gODsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKGVycm9yKTsKCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDg6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9jb250ZXh0MzQubmV4dCA9IDEwOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gY29udGV4dC5kaXNwYXRjaCgib25VcGRhdGVJdGVtIiwgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlkOiBjb250ZW50LnByb2R1Y3RJZCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYWxsYmFjazogZnVuY3Rpb24gY2FsbGJhY2soaXRlbSkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGl0ZW0ucmVtb3ZlQnVuZGxlKGNvbnRlbnQuYnVuZGxlKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pOwoKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgMTA6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGl0ZW0gPSBfY29udGV4dDM0LnNlbnQ7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDM0LmFicnVwdCgicmV0dXJuIiwgaXRlbSk7CgogICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAxMjoKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDM0LnN0b3AoKTsKICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgIH0sIF9jYWxsZWUzMik7CiAgICAgICAgICAgICAgICAgICAgfSkpKSk7CgogICAgICAgICAgICAgICAgICBjYXNlIDI6CiAgICAgICAgICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0MzUuc3RvcCgpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSwgX2NhbGxlZTMzKTsKICAgICAgICAgIH0pKSgpOwogICAgICAgIH0sCiAgICAgICAgYWRkR2lmdE9mSWQ6IGZ1bmN0aW9uIGFkZEdpZnRPZklkKGNvbnRleHQpIHsKICAgICAgICAgIHZhciBfYXJndW1lbnRzMTQgPSBhcmd1bWVudHM7CiAgICAgICAgICByZXR1cm4gX2FzeW5jVG9HZW5lcmF0b3IoIC8qI19fUFVSRV9fKi9yZWdlbmVyYXRvclJ1bnRpbWUubWFyayhmdW5jdGlvbiBfY2FsbGVlMzUoKSB7CiAgICAgICAgICAgIHZhciBhcmc7CiAgICAgICAgICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUud3JhcChmdW5jdGlvbiBfY2FsbGVlMzUkKF9jb250ZXh0MzcpIHsKICAgICAgICAgICAgICB3aGlsZSAoMSkgewogICAgICAgICAgICAgICAgc3dpdGNoIChfY29udGV4dDM3LnByZXYgPSBfY29udGV4dDM3Lm5leHQpIHsKICAgICAgICAgICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICAgICAgICAgIGFyZyA9IF9hcmd1bWVudHMxNC5sZW5ndGggPiAxICYmIF9hcmd1bWVudHMxNFsxXSAhPT0gdW5kZWZpbmVkID8gX2FyZ3VtZW50czE0WzFdIDogewogICAgICAgICAgICAgICAgICAgICAgaWQ6IGlkLAogICAgICAgICAgICAgICAgICAgICAgZ2lmdDogZ2lmdAogICAgICAgICAgICAgICAgICAgIH07CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0MzcuYWJydXB0KCJyZXR1cm4iLCBjb250ZXh0LnN0YXRlLnByb2Nlc3Nvci5hY3F1aXJlKCJhZGRHaWZ0T2ZJZCIsIC8qI19fUFVSRV9fKi9fYXN5bmNUb0dlbmVyYXRvciggLyojX19QVVJFX18qL3JlZ2VuZXJhdG9yUnVudGltZS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWUzNCgpIHsKICAgICAgICAgICAgICAgICAgICAgIHZhciBpZCwgZ2lmdCwgYXBpLCBlcnJvciwgY29udGVudCwgaXRlbTsKICAgICAgICAgICAgICAgICAgICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUud3JhcChmdW5jdGlvbiBfY2FsbGVlMzQkKF9jb250ZXh0MzYpIHsKICAgICAgICAgICAgICAgICAgICAgICAgd2hpbGUgKDEpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICBzd2l0Y2ggKF9jb250ZXh0MzYucHJldiA9IF9jb250ZXh0MzYubmV4dCkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZCA9IGFyZy5pZCwgZ2lmdCA9IGFyZy5naWZ0OwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfY29udGV4dDM2Lm5leHQgPSAzOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gQXBpSG9zdC5yZXF1ZXN0KCkuUE9TVCgpLnVybCgicHJvZHVjdHYyL2dpZnQvIikuYm9keSh7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29udGVudDogewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcHJvZHVjdElkOiBpZCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGdpZnQ6IGdpZnQKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pLnNlbmQoKTsKCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDM6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFwaSA9IF9jb250ZXh0MzYuc2VudDsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZXJyb3IgPSBhcGkuZ2V0RXJyb3IoKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29udGVudCA9IGFwaS5nZXRDb250ZW50KCk7CgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoIWVycm9yKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgX2NvbnRleHQzNi5uZXh0ID0gODsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKGVycm9yKTsKCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDg6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9jb250ZXh0MzYubmV4dCA9IDEwOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gY29udGV4dC5kaXNwYXRjaCgib25VcGRhdGVJdGVtIiwgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlkOiBjb250ZW50LnByb2R1Y3RJZCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYWxsYmFjazogZnVuY3Rpb24gY2FsbGJhY2soaXRlbSkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGl0ZW0uYWRkR2lmdChjb250ZW50LmdpZnQpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7CgogICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAxMDoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaXRlbSA9IF9jb250ZXh0MzYuc2VudDsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0MzYuYWJydXB0KCJyZXR1cm4iLCBpdGVtKTsKCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDEyOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0MzYuc3RvcCgpOwogICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgfSwgX2NhbGxlZTM0KTsKICAgICAgICAgICAgICAgICAgICB9KSkpKTsKCiAgICAgICAgICAgICAgICAgIGNhc2UgMjoKICAgICAgICAgICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQzNy5zdG9wKCk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9LCBfY2FsbGVlMzUpOwogICAgICAgICAgfSkpKCk7CiAgICAgICAgfSwKICAgICAgICByZW1vdmVHaWZ0T2ZJZDogZnVuY3Rpb24gcmVtb3ZlR2lmdE9mSWQoY29udGV4dCkgewogICAgICAgICAgdmFyIF9hcmd1bWVudHMxNSA9IGFyZ3VtZW50czsKICAgICAgICAgIHJldHVybiBfYXN5bmNUb0dlbmVyYXRvciggLyojX19QVVJFX18qL3JlZ2VuZXJhdG9yUnVudGltZS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWUzNygpIHsKICAgICAgICAgICAgdmFyIGFyZzsKICAgICAgICAgICAgcmV0dXJuIHJlZ2VuZXJhdG9yUnVudGltZS53cmFwKGZ1bmN0aW9uIF9jYWxsZWUzNyQoX2NvbnRleHQzOSkgewogICAgICAgICAgICAgIHdoaWxlICgxKSB7CiAgICAgICAgICAgICAgICBzd2l0Y2ggKF9jb250ZXh0MzkucHJldiA9IF9jb250ZXh0MzkubmV4dCkgewogICAgICAgICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgICAgICAgYXJnID0gX2FyZ3VtZW50czE1Lmxlbmd0aCA+IDEgJiYgX2FyZ3VtZW50czE1WzFdICE9PSB1bmRlZmluZWQgPyBfYXJndW1lbnRzMTVbMV0gOiB7CiAgICAgICAgICAgICAgICAgICAgICBpZDogaWQsCiAgICAgICAgICAgICAgICAgICAgICBnaWZ0OiBnaWZ0CiAgICAgICAgICAgICAgICAgICAgfTsKICAgICAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQzOS5hYnJ1cHQoInJldHVybiIsIGNvbnRleHQuc3RhdGUucHJvY2Vzc29yLmFjcXVpcmUoInJlbW92ZUdpZnRPZklkIiwgLyojX19QVVJFX18qL19hc3luY1RvR2VuZXJhdG9yKCAvKiNfX1BVUkVfXyovcmVnZW5lcmF0b3JSdW50aW1lLm1hcmsoZnVuY3Rpb24gX2NhbGxlZTM2KCkgewogICAgICAgICAgICAgICAgICAgICAgdmFyIGlkLCBnaWZ0LCBhcGksIGVycm9yLCBjb250ZW50LCBpdGVtOwogICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHJlZ2VuZXJhdG9yUnVudGltZS53cmFwKGZ1bmN0aW9uIF9jYWxsZWUzNiQoX2NvbnRleHQzOCkgewogICAgICAgICAgICAgICAgICAgICAgICB3aGlsZSAoMSkgewogICAgICAgICAgICAgICAgICAgICAgICAgIHN3aXRjaCAoX2NvbnRleHQzOC5wcmV2ID0gX2NvbnRleHQzOC5uZXh0KSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlkID0gYXJnLmlkLCBnaWZ0ID0gYXJnLmdpZnQ7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9jb250ZXh0MzgubmV4dCA9IDM7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBBcGlIb3N0LnJlcXVlc3QoKS5ERUxFVEUoKS51cmwoInByb2R1Y3R2Mi9naWZ0LyIpLmJvZHkoewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRlbnQ6IHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHByb2R1Y3RJZDogaWQsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBnaWZ0OiBnaWZ0CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KS5zZW5kKCk7CgogICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAzOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhcGkgPSBfY29udGV4dDM4LnNlbnQ7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVycm9yID0gYXBpLmdldEVycm9yKCk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRlbnQgPSBhcGkuZ2V0Q29udGVudCgpOwoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFlcnJvcikgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9jb250ZXh0MzgubmV4dCA9IDg7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihlcnJvcik7CgogICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSA4OgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfY29udGV4dDM4Lm5leHQgPSAxMDsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGNvbnRleHQuZGlzcGF0Y2goIm9uVXBkYXRlSXRlbSIsIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZDogY29udGVudC5wcm9kdWN0SWQsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FsbGJhY2s6IGZ1bmN0aW9uIGNhbGxiYWNrKGl0ZW0pIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBpdGVtLnJlbW92ZUdpZnQoY29udGVudC5naWZ0KTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pOwoKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgMTA6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGl0ZW0gPSBfY29udGV4dDM4LnNlbnQ7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDM4LmFicnVwdCgicmV0dXJuIiwgaXRlbSk7CgogICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAxMjoKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDM4LnN0b3AoKTsKICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgIH0sIF9jYWxsZWUzNik7CiAgICAgICAgICAgICAgICAgICAgfSkpKSk7CgogICAgICAgICAgICAgICAgICBjYXNlIDI6CiAgICAgICAgICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0Mzkuc3RvcCgpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSwgX2NhbGxlZTM3KTsKICAgICAgICAgIH0pKSgpOwogICAgICAgIH0sCiAgICAgICAgYWRkU3BlY2lmaWNhdGlvbk9mSWQ6IGZ1bmN0aW9uIGFkZFNwZWNpZmljYXRpb25PZklkKGNvbnRleHQpIHsKICAgICAgICAgIHZhciBfYXJndW1lbnRzMTYgPSBhcmd1bWVudHM7CiAgICAgICAgICByZXR1cm4gX2FzeW5jVG9HZW5lcmF0b3IoIC8qI19fUFVSRV9fKi9yZWdlbmVyYXRvclJ1bnRpbWUubWFyayhmdW5jdGlvbiBfY2FsbGVlMzkoKSB7CiAgICAgICAgICAgIHZhciBhcmc7CiAgICAgICAgICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUud3JhcChmdW5jdGlvbiBfY2FsbGVlMzkkKF9jb250ZXh0NDEpIHsKICAgICAgICAgICAgICB3aGlsZSAoMSkgewogICAgICAgICAgICAgICAgc3dpdGNoIChfY29udGV4dDQxLnByZXYgPSBfY29udGV4dDQxLm5leHQpIHsKICAgICAgICAgICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICAgICAgICAgIGFyZyA9IF9hcmd1bWVudHMxNi5sZW5ndGggPiAxICYmIF9hcmd1bWVudHMxNlsxXSAhPT0gdW5kZWZpbmVkID8gX2FyZ3VtZW50czE2WzFdIDogewogICAgICAgICAgICAgICAgICAgICAgaWQ6IGlkLAogICAgICAgICAgICAgICAgICAgICAgc3BlY2lmaWNhdGlvbjogc3BlY2lmaWNhdGlvbgogICAgICAgICAgICAgICAgICAgIH07CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0NDEuYWJydXB0KCJyZXR1cm4iLCBjb250ZXh0LnN0YXRlLnByb2Nlc3Nvci5hY3F1aXJlKCJhZGRTcGVjaWZpY2F0aW9uT2ZJZCIsIC8qI19fUFVSRV9fKi9fYXN5bmNUb0dlbmVyYXRvciggLyojX19QVVJFX18qL3JlZ2VuZXJhdG9yUnVudGltZS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWUzOCgpIHsKICAgICAgICAgICAgICAgICAgICAgIHZhciBpZCwgc3BlY2lmaWNhdGlvbiwgYXBpLCBlcnJvciwgY29udGVudCwgaXRlbTsKICAgICAgICAgICAgICAgICAgICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUud3JhcChmdW5jdGlvbiBfY2FsbGVlMzgkKF9jb250ZXh0NDApIHsKICAgICAgICAgICAgICAgICAgICAgICAgd2hpbGUgKDEpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICBzd2l0Y2ggKF9jb250ZXh0NDAucHJldiA9IF9jb250ZXh0NDAubmV4dCkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZCA9IGFyZy5pZCwgc3BlY2lmaWNhdGlvbiA9IGFyZy5zcGVjaWZpY2F0aW9uOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfY29udGV4dDQwLm5leHQgPSAzOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gQXBpSG9zdC5yZXF1ZXN0KCkuUE9TVCgpLnVybCgicHJvZHVjdHYyL3NwZWNpZmljYXRpb24vIikuYm9keSh7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29udGVudDogewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcHJvZHVjdElkOiBpZCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNwZWNpZmljYXRpb246IHNwZWNpZmljYXRpb24KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pLnNlbmQoKTsKCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDM6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFwaSA9IF9jb250ZXh0NDAuc2VudDsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZXJyb3IgPSBhcGkuZ2V0RXJyb3IoKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29udGVudCA9IGFwaS5nZXRDb250ZW50KCk7CgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoIWVycm9yKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgX2NvbnRleHQ0MC5uZXh0ID0gODsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKGVycm9yKTsKCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDg6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9jb250ZXh0NDAubmV4dCA9IDEwOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gY29udGV4dC5kaXNwYXRjaCgib25VcGRhdGVJdGVtIiwgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlkOiBjb250ZW50LnByb2R1Y3RJZCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYWxsYmFjazogZnVuY3Rpb24gY2FsbGJhY2soaXRlbSkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaXRlbS5hZGRTcGVjaWZpY2F0aW9uKGNvbnRlbnQuc3BlY2lmaWNhdGlvbik7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTsKCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDEwOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpdGVtID0gX2NvbnRleHQ0MC5zZW50OwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQ0MC5hYnJ1cHQoInJldHVybiIsIGl0ZW0pOwoKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgMTI6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQ0MC5zdG9wKCk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICB9LCBfY2FsbGVlMzgpOwogICAgICAgICAgICAgICAgICAgIH0pKSkpOwoKICAgICAgICAgICAgICAgICAgY2FzZSAyOgogICAgICAgICAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDQxLnN0b3AoKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0sIF9jYWxsZWUzOSk7CiAgICAgICAgICB9KSkoKTsKICAgICAgICB9LAogICAgICAgIHJlbW92ZVNwZWNpZmljYXRpb25PZklkOiBmdW5jdGlvbiByZW1vdmVTcGVjaWZpY2F0aW9uT2ZJZChjb250ZXh0KSB7CiAgICAgICAgICB2YXIgX2FyZ3VtZW50czE3ID0gYXJndW1lbnRzOwogICAgICAgICAgcmV0dXJuIF9hc3luY1RvR2VuZXJhdG9yKCAvKiNfX1BVUkVfXyovcmVnZW5lcmF0b3JSdW50aW1lLm1hcmsoZnVuY3Rpb24gX2NhbGxlZTQxKCkgewogICAgICAgICAgICB2YXIgYXJnOwogICAgICAgICAgICByZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLndyYXAoZnVuY3Rpb24gX2NhbGxlZTQxJChfY29udGV4dDQzKSB7CiAgICAgICAgICAgICAgd2hpbGUgKDEpIHsKICAgICAgICAgICAgICAgIHN3aXRjaCAoX2NvbnRleHQ0My5wcmV2ID0gX2NvbnRleHQ0My5uZXh0KSB7CiAgICAgICAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICAgICAgICBhcmcgPSBfYXJndW1lbnRzMTcubGVuZ3RoID4gMSAmJiBfYXJndW1lbnRzMTdbMV0gIT09IHVuZGVmaW5lZCA/IF9hcmd1bWVudHMxN1sxXSA6IHsKICAgICAgICAgICAgICAgICAgICAgIGlkOiBpZCwKICAgICAgICAgICAgICAgICAgICAgIHNwZWNpZmljYXRpb246IHNwZWNpZmljYXRpb24KICAgICAgICAgICAgICAgICAgICB9OwogICAgICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDQzLmFicnVwdCgicmV0dXJuIiwgY29udGV4dC5zdGF0ZS5wcm9jZXNzb3IuYWNxdWlyZSgicmVtb3ZlU3BlY2lmaWNhdGlvbk9mSWQiLCAvKiNfX1BVUkVfXyovX2FzeW5jVG9HZW5lcmF0b3IoIC8qI19fUFVSRV9fKi9yZWdlbmVyYXRvclJ1bnRpbWUubWFyayhmdW5jdGlvbiBfY2FsbGVlNDAoKSB7CiAgICAgICAgICAgICAgICAgICAgICB2YXIgaWQsIHNwZWNpZmljYXRpb24sIGFwaSwgZXJyb3IsIGNvbnRlbnQsIGl0ZW07CiAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLndyYXAoZnVuY3Rpb24gX2NhbGxlZTQwJChfY29udGV4dDQyKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHdoaWxlICgxKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgc3dpdGNoIChfY29udGV4dDQyLnByZXYgPSBfY29udGV4dDQyLm5leHQpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWQgPSBhcmcuaWQsIHNwZWNpZmljYXRpb24gPSBhcmcuc3BlY2lmaWNhdGlvbjsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3BlY2lmaWNhdGlvbiA9IHNwZWNpZmljYXRpb24gaW5zdGFuY2VvZiBQcm9kdWN0U3BlY0NvbnRlbnQgPyBzcGVjaWZpY2F0aW9uLnRvRGF0YSgpIDogc3BlY2lmaWNhdGlvbjsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3BlY2lmaWNhdGlvbi50eXBlID0gc3BlY2lmaWNhdGlvbi5rZXk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9jb250ZXh0NDIubmV4dCA9IDU7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBBcGlIb3N0LnJlcXVlc3QoKS5ERUxFVEUoKS51cmwoInByb2R1Y3R2Mi9zcGVjaWZpY2F0aW9uLyIpLmJvZHkoewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRlbnQ6IHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHByb2R1Y3RJZDogaWQsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzcGVjaWZpY2F0aW9uOiBzcGVjaWZpY2F0aW9uCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KS5zZW5kKCk7CgogICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSA1OgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhcGkgPSBfY29udGV4dDQyLnNlbnQ7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVycm9yID0gYXBpLmdldEVycm9yKCk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRlbnQgPSBhcGkuZ2V0Q29udGVudCgpOwoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFlcnJvcikgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9jb250ZXh0NDIubmV4dCA9IDEwOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoZXJyb3IpOwoKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgMTA6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9jb250ZXh0NDIubmV4dCA9IDEyOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gY29udGV4dC5kaXNwYXRjaCgib25VcGRhdGVJdGVtIiwgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlkOiBjb250ZW50LnByb2R1Y3RJZCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYWxsYmFjazogZnVuY3Rpb24gY2FsbGJhY2soaXRlbSkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaXRlbS5yZW1vdmVTcGVjaWZpY2F0aW9uKGNvbnRlbnQuc3BlY2lmaWNhdGlvbik7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTsKCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDEyOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpdGVtID0gX2NvbnRleHQ0Mi5zZW50OwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQ0Mi5hYnJ1cHQoInJldHVybiIsIGl0ZW0pOwoKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgMTQ6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQ0Mi5zdG9wKCk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICB9LCBfY2FsbGVlNDApOwogICAgICAgICAgICAgICAgICAgIH0pKSkpOwoKICAgICAgICAgICAgICAgICAgY2FzZSAyOgogICAgICAgICAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDQzLnN0b3AoKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0sIF9jYWxsZWU0MSk7CiAgICAgICAgICB9KSkoKTsKICAgICAgICB9LAogICAgICAgIHVwZGF0ZVNwZWNpZmljYXRpb25zT2ZJZDogZnVuY3Rpb24gdXBkYXRlU3BlY2lmaWNhdGlvbnNPZklkKGNvbnRleHQpIHsKICAgICAgICAgIHZhciBfYXJndW1lbnRzMTggPSBhcmd1bWVudHM7CiAgICAgICAgICByZXR1cm4gX2FzeW5jVG9HZW5lcmF0b3IoIC8qI19fUFVSRV9fKi9yZWdlbmVyYXRvclJ1bnRpbWUubWFyayhmdW5jdGlvbiBfY2FsbGVlNDMoKSB7CiAgICAgICAgICAgIHZhciBhcmc7CiAgICAgICAgICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUud3JhcChmdW5jdGlvbiBfY2FsbGVlNDMkKF9jb250ZXh0NDUpIHsKICAgICAgICAgICAgICB3aGlsZSAoMSkgewogICAgICAgICAgICAgICAgc3dpdGNoIChfY29udGV4dDQ1LnByZXYgPSBfY29udGV4dDQ1Lm5leHQpIHsKICAgICAgICAgICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICAgICAgICAgIGFyZyA9IF9hcmd1bWVudHMxOC5sZW5ndGggPiAxICYmIF9hcmd1bWVudHMxOFsxXSAhPT0gdW5kZWZpbmVkID8gX2FyZ3VtZW50czE4WzFdIDogewogICAgICAgICAgICAgICAgICAgICAgaWQ6IGlkLAogICAgICAgICAgICAgICAgICAgICAgc3BlY2lmaWNhdGlvbnM6IHNwZWNpZmljYXRpb25zCiAgICAgICAgICAgICAgICAgICAgfTsKICAgICAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQ0NS5hYnJ1cHQoInJldHVybiIsIGNvbnRleHQuc3RhdGUucHJvY2Vzc29yLmFjcXVpcmUoInVwZGF0ZVNwZWNpZmljYXRpb25zT2ZJZCIsIC8qI19fUFVSRV9fKi9fYXN5bmNUb0dlbmVyYXRvciggLyojX19QVVJFX18qL3JlZ2VuZXJhdG9yUnVudGltZS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWU0MigpIHsKICAgICAgICAgICAgICAgICAgICAgIHZhciBpZCwgc3BlY2lmaWNhdGlvbnMsIGFwaSwgZXJyb3IsIGNvbnRlbnQsIGl0ZW07CiAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLndyYXAoZnVuY3Rpb24gX2NhbGxlZTQyJChfY29udGV4dDQ0KSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHdoaWxlICgxKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgc3dpdGNoIChfY29udGV4dDQ0LnByZXYgPSBfY29udGV4dDQ0Lm5leHQpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWQgPSBhcmcuaWQsIHNwZWNpZmljYXRpb25zID0gYXJnLnNwZWNpZmljYXRpb25zOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfY29udGV4dDQ0Lm5leHQgPSAzOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gQXBpSG9zdC5yZXF1ZXN0KCkuUFVUKCkudXJsKCJwcm9kdWN0djIvc3BlY2lmaWNhdGlvbi9saXN0IikuYm9keSh7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29udGVudDogewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcHJvZHVjdElkOiBpZCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNwZWNpZmljYXRpb25zOiBzcGVjaWZpY2F0aW9ucwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSkuc2VuZCgpOwoKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgMzoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYXBpID0gX2NvbnRleHQ0NC5zZW50OwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlcnJvciA9IGFwaS5nZXRFcnJvcigpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb250ZW50ID0gYXBpLmdldENvbnRlbnQoKTsKCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICghZXJyb3IpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfY29udGV4dDQ0Lm5leHQgPSA4OwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoZXJyb3IpOwoKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgODoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgX2NvbnRleHQ0NC5uZXh0ID0gMTA7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBjb250ZXh0LmRpc3BhdGNoKCJvblVwZGF0ZUl0ZW0iLCB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWQ6IGNvbnRlbnQucHJvZHVjdElkLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhbGxiYWNrOiBmdW5jdGlvbiBjYWxsYmFjayhpdGVtKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpdGVtLnNldFNwZWNpZmljYXRpb25zKGNvbnRlbnQuc3BlY2lmaWNhdGlvbnMpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7CgogICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAxMDoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaXRlbSA9IF9jb250ZXh0NDQuc2VudDsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0NDQuYWJydXB0KCJyZXR1cm4iLCBpdGVtKTsKCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDEyOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0NDQuc3RvcCgpOwogICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgfSwgX2NhbGxlZTQyKTsKICAgICAgICAgICAgICAgICAgICB9KSkpKTsKCiAgICAgICAgICAgICAgICAgIGNhc2UgMjoKICAgICAgICAgICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQ0NS5zdG9wKCk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9LCBfY2FsbGVlNDMpOwogICAgICAgICAgfSkpKCk7CiAgICAgICAgfSwKICAgICAgICBhZGRJbWFnZU9mSWQ6IGZ1bmN0aW9uIGFkZEltYWdlT2ZJZChjb250ZXh0KSB7CiAgICAgICAgICB2YXIgX2FyZ3VtZW50czE5ID0gYXJndW1lbnRzOwogICAgICAgICAgcmV0dXJuIF9hc3luY1RvR2VuZXJhdG9yKCAvKiNfX1BVUkVfXyovcmVnZW5lcmF0b3JSdW50aW1lLm1hcmsoZnVuY3Rpb24gX2NhbGxlZTQ1KCkgewogICAgICAgICAgICB2YXIgYXJnOwogICAgICAgICAgICByZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLndyYXAoZnVuY3Rpb24gX2NhbGxlZTQ1JChfY29udGV4dDQ3KSB7CiAgICAgICAgICAgICAgd2hpbGUgKDEpIHsKICAgICAgICAgICAgICAgIHN3aXRjaCAoX2NvbnRleHQ0Ny5wcmV2ID0gX2NvbnRleHQ0Ny5uZXh0KSB7CiAgICAgICAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICAgICAgICBhcmcgPSBfYXJndW1lbnRzMTkubGVuZ3RoID4gMSAmJiBfYXJndW1lbnRzMTlbMV0gIT09IHVuZGVmaW5lZCA/IF9hcmd1bWVudHMxOVsxXSA6IHsKICAgICAgICAgICAgICAgICAgICAgIGlkOiBpZCwKICAgICAgICAgICAgICAgICAgICAgIGltYWdlRmlsZTogaW1hZ2VGaWxlCiAgICAgICAgICAgICAgICAgICAgfTsKICAgICAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQ0Ny5hYnJ1cHQoInJldHVybiIsIGNvbnRleHQuc3RhdGUucHJvY2Vzc29yLmFjcXVpcmUoImFkZEltYWdlT2ZJZCIsIC8qI19fUFVSRV9fKi9fYXN5bmNUb0dlbmVyYXRvciggLyojX19QVVJFX18qL3JlZ2VuZXJhdG9yUnVudGltZS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWU0NCgpIHsKICAgICAgICAgICAgICAgICAgICAgIHZhciBpZCwgaW1hZ2VGaWxlLCBpbWFnZUZpbGVGb3JtLCBhcGksIGNvbnRlbnQsIGl0ZW07CiAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLndyYXAoZnVuY3Rpb24gX2NhbGxlZTQ0JChfY29udGV4dDQ2KSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHdoaWxlICgxKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgc3dpdGNoIChfY29udGV4dDQ2LnByZXYgPSBfY29udGV4dDQ2Lm5leHQpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWQgPSBhcmcuaWQsIGltYWdlRmlsZSA9IGFyZy5pbWFnZUZpbGU7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGltYWdlRmlsZUZvcm0gPSBuZXcgRm9ybURhdGEoKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaW1hZ2VGaWxlRm9ybS5hcHBlbmQoaW1hZ2VGaWxlLm5hbWUsIGltYWdlRmlsZSk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9jb250ZXh0NDYubmV4dCA9IDU7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBBcGlIb3N0LmZldGNoKHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBtZXRob2Q6ICJQT1NUIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB1cmw6ICJwcm9kdWN0djIvaWQvIi5jb25jYXQoaWQsICIvaW1hZ2UvIiksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYm9keTogaW1hZ2VGaWxlRm9ybQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTsKCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDU6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFwaSA9IF9jb250ZXh0NDYuc2VudDsKCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICghYXBpLmVycm9yKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgX2NvbnRleHQ0Ni5uZXh0ID0gODsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKGFwaS5lcnJvcik7CgogICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSA4OgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb250ZW50ID0gYXBpLmNvbnRlbnQ7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9jb250ZXh0NDYubmV4dCA9IDExOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gY29udGV4dC5kaXNwYXRjaCgib25VcGRhdGVJdGVtIiwgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlkOiBjb250ZW50LnByb2R1Y3RJZCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYWxsYmFjazogZnVuY3Rpb24gY2FsbGJhY2soaXRlbSkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaXRlbS5hZGRJbWFnZXMoY29udGVudC5pbWFnZXMpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7CgogICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAxMToKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaXRlbSA9IF9jb250ZXh0NDYuc2VudDsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0NDYuYWJydXB0KCJyZXR1cm4iLCBpdGVtKTsKCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDEzOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0NDYuc3RvcCgpOwogICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgfSwgX2NhbGxlZTQ0KTsKICAgICAgICAgICAgICAgICAgICB9KSkpKTsKCiAgICAgICAgICAgICAgICAgIGNhc2UgMjoKICAgICAgICAgICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQ0Ny5zdG9wKCk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9LCBfY2FsbGVlNDUpOwogICAgICAgICAgfSkpKCk7CiAgICAgICAgfSwKICAgICAgICByZW1vdmVJbWFnZU9mSWQ6IGZ1bmN0aW9uIHJlbW92ZUltYWdlT2ZJZChjb250ZXh0KSB7CiAgICAgICAgICB2YXIgX2FyZ3VtZW50czIwID0gYXJndW1lbnRzOwogICAgICAgICAgcmV0dXJuIF9hc3luY1RvR2VuZXJhdG9yKCAvKiNfX1BVUkVfXyovcmVnZW5lcmF0b3JSdW50aW1lLm1hcmsoZnVuY3Rpb24gX2NhbGxlZTQ3KCkgewogICAgICAgICAgICB2YXIgYXJnOwogICAgICAgICAgICByZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLndyYXAoZnVuY3Rpb24gX2NhbGxlZTQ3JChfY29udGV4dDQ5KSB7CiAgICAgICAgICAgICAgd2hpbGUgKDEpIHsKICAgICAgICAgICAgICAgIHN3aXRjaCAoX2NvbnRleHQ0OS5wcmV2ID0gX2NvbnRleHQ0OS5uZXh0KSB7CiAgICAgICAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICAgICAgICBhcmcgPSBfYXJndW1lbnRzMjAubGVuZ3RoID4gMSAmJiBfYXJndW1lbnRzMjBbMV0gIT09IHVuZGVmaW5lZCA/IF9hcmd1bWVudHMyMFsxXSA6IHsKICAgICAgICAgICAgICAgICAgICAgIGlkOiBpZCwKICAgICAgICAgICAgICAgICAgICAgIGltYWdlOiBpbWFnZQogICAgICAgICAgICAgICAgICAgIH07CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0NDkuYWJydXB0KCJyZXR1cm4iLCBjb250ZXh0LnN0YXRlLnByb2Nlc3Nvci5hY3F1aXJlKCJyZW1vdmVJbWFnZU9mSWQiLCAvKiNfX1BVUkVfXyovX2FzeW5jVG9HZW5lcmF0b3IoIC8qI19fUFVSRV9fKi9yZWdlbmVyYXRvclJ1bnRpbWUubWFyayhmdW5jdGlvbiBfY2FsbGVlNDYoKSB7CiAgICAgICAgICAgICAgICAgICAgICB2YXIgaWQsIGltYWdlLCBhcGksIGVycm9yLCBjb250ZW50LCBpdGVtOwogICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHJlZ2VuZXJhdG9yUnVudGltZS53cmFwKGZ1bmN0aW9uIF9jYWxsZWU0NiQoX2NvbnRleHQ0OCkgewogICAgICAgICAgICAgICAgICAgICAgICB3aGlsZSAoMSkgewogICAgICAgICAgICAgICAgICAgICAgICAgIHN3aXRjaCAoX2NvbnRleHQ0OC5wcmV2ID0gX2NvbnRleHQ0OC5uZXh0KSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlkID0gYXJnLmlkLCBpbWFnZSA9IGFyZy5pbWFnZTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaW1hZ2UgPSBpbWFnZSBpbnN0YW5jZW9mIEltYWdlID8gaW1hZ2UudG9EYXRhKCkgOiBpbWFnZTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgX2NvbnRleHQ0OC5uZXh0ID0gNDsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIEFwaUhvc3QucmVxdWVzdCgpLkRFTEVURSgpLnVybCgicHJvZHVjdHYyL2lkLyIuY29uY2F0KGlkLCAiL2ltYWdlLyIpKS5ib2R5KHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb250ZW50OiB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpbWFnZTogaW1hZ2UKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pLnNlbmQoKTsKCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDQ6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFwaSA9IF9jb250ZXh0NDguc2VudDsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZXJyb3IgPSBhcGkuZ2V0RXJyb3IoKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29udGVudCA9IGFwaS5nZXRDb250ZW50KCk7CgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoIWVycm9yKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgX2NvbnRleHQ0OC5uZXh0ID0gOTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKGVycm9yKTsKCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDk6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9jb250ZXh0NDgubmV4dCA9IDExOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gY29udGV4dC5kaXNwYXRjaCgib25VcGRhdGVJdGVtIiwgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlkOiBjb250ZW50LnByb2R1Y3RJZCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYWxsYmFjazogZnVuY3Rpb24gY2FsbGJhY2soaXRlbSkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaXRlbS5yZW1vdmVJbWFnZShjb250ZW50LmltYWdlKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pOwoKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgMTE6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGl0ZW0gPSBfY29udGV4dDQ4LnNlbnQ7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDQ4LmFicnVwdCgicmV0dXJuIiwgaXRlbSk7CgogICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAxMzoKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDQ4LnN0b3AoKTsKICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgIH0sIF9jYWxsZWU0Nik7CiAgICAgICAgICAgICAgICAgICAgfSkpKSk7CgogICAgICAgICAgICAgICAgICBjYXNlIDI6CiAgICAgICAgICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0NDkuc3RvcCgpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSwgX2NhbGxlZTQ3KTsKICAgICAgICAgIH0pKSgpOwogICAgICAgIH0KICAgICAgfQogICAgfSk7CiAgICByZXR1cm4gcHJvZHVjdFN0b3JlOwogIH0KfTs="},{"version":3,"sources":["C:/dev/freshnet-vue/src/stores/store.product.js"],"names":["Product","ProductSpecContent","Image","DataLoader","CollectionUpdater","Processor","ModuleBundle","ModulePrice","Category","Vuex","ApiHost","U","init","Stores","categoryStore","category","productStore","Store","state","lastModified","dataLoader","timeout","processor","loadData","request","url","send","api","error","getError","contents","getContent","Error","Array","isArray","Promise","all","map","content","fromData","setData","data","commit","Date","now","getData","getters","items","mutations","time","isLoading","actions","refresh","context","acquire","doTimeout","dispatch","getItems","getItemOfId","id","item","find","getGroupsByCategory","Key","Other","categoryOther","groups","fetchCategory","categoryId","group","push","getGroupsByBrand","brandId","brand","fetchBrand","addItem","arg","POST","body","productNew","onId","getItem","catch","console","removeItemOfId","DELETE","filter","onUpdateItem","callback","updateTitleOfId","title","PUT","productId","optString","updateDescriptionOfId","description","isString","trim","updateBrandIdOfId","setBrandId","updateCategoryIdOfId","setCategoryId","updateAvailabilityOfId","isAvailable","stock","updateSecondHandOfId","isSecondHand","updatePriceOfId","price","setPrice","normal","promotion","addBundleOfId","bundle","addBundle","removeBundleOfId","removeBundle","addGiftOfId","gift","addGift","removeGiftOfId","removeGift","addSpecificationOfId","specification","addSpecification","removeSpecificationOfId","toData","type","key","removeSpecification","updateSpecificationsOfId","specifications","setSpecifications","addImageOfId","imageFile","imageFileForm","FormData","append","name","fetch","method","addImages","images","removeImageOfId","image","removeImage"],"mappings":"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","sourcesContent":["import Product from \"../items/Product.js\";\r\nimport ProductSpecContent from \"../items/ProductSpecContent.js\";\r\nimport Image from \"../items/Image.js\";\r\n\r\nimport DataLoader from \"./tools/DataLoader\";\r\nimport CollectionUpdater from \"./tools/CollectionUpdater\";\r\nimport Processor from \"./tools/Processor.js\";\r\n\r\nimport ModuleBundle from \"../../../express/data_structures/ProductBundle.js\";\r\nimport ModulePrice from \"../../../express/data_structures/ProductPrice.js\";\r\nimport Category from \"@/items/Category.js\";\r\n\r\nimport Vuex from \"vuex\";\r\nimport ApiHost from \"@/host/ApiHost.js\";\r\nimport U from \"@/U.js\";\r\n\r\nexport default {\r\n\tinit(Stores) {\r\n\t\tconst categoryStore = Stores.category;\r\n\r\n\t\tconst productStore = new Vuex.Store({\r\n\t\t\tstate: {\r\n\t\t\t\tlastModified: 0,\r\n\t\t\t\tdataLoader: new DataLoader({ timeout: 1000 * 60 * 10 }) // 10min\r\n\t\t\t\t\t.processor(() => productStore.state.processor)\r\n\t\t\t\t\t.loadData(async () => {\r\n\t\t\t\t\t\tconst api = await ApiHost.request().url(\"productv2/list/\").send();\r\n\t\t\t\t\t\tconst error = api.getError();\r\n\t\t\t\t\t\tconst contents = api.getContent();\r\n\t\t\t\t\t\tif (error) throw new Error(error);\r\n\t\t\t\t\t\tif (!Array.isArray(contents))\r\n\t\t\t\t\t\t\tthrow new Error(\"content is not array\");\r\n\t\t\t\t\t\treturn Promise.all(\r\n\t\t\t\t\t\t\tcontents.map((content) => new Product(Stores).fromData(content)),\r\n\t\t\t\t\t\t);\r\n\t\t\t\t\t})\r\n\t\t\t\t\t.setData((data) => {\r\n\t\t\t\t\t\tproductStore.commit(\"items\", Array.isArray(data) ? data : []);\r\n\t\t\t\t\t\tproductStore.commit(\"lastModified\", Date.now());\r\n\t\t\t\t\t})\r\n\t\t\t\t\t.getData(() => productStore.getters.items),\r\n\t\t\t\titems: [],\r\n\t\t\t\tprocessor: new Processor(),\r\n\t\t\t},\r\n\t\t\tmutations: {\r\n\t\t\t\tlastModified: (state, time) => (state.lastModified = time),\r\n\t\t\t\titems: (state, items) => (state.items = items),\r\n\t\t\t},\r\n\t\t\tgetters: {\r\n\t\t\t\tlastModified: (state) => state.lastModified,\r\n\t\t\t\tisLoading: (state) => state.processor.isLoading(),\r\n\t\t\t\titems: (state) => state.items,\r\n\t\t\t},\r\n\t\t\tactions: {\r\n\t\t\t\tasync refresh(context) {\r\n\t\t\t\t\treturn await context.state.processor.acquire(\"refresh\", async () => {\r\n\t\t\t\t\t\tcontext.state.dataLoader.doTimeout();\r\n\t\t\t\t\t\tawait context.dispatch(\"getItems\");\r\n\t\t\t\t\t});\r\n\t\t\t\t},\r\n\r\n\t\t\t\tasync getItems(context) {\r\n\t\t\t\t\treturn context.state.processor.acquire(\"getItems\", async () => {\r\n\t\t\t\t\t\treturn context.state.dataLoader.data();\r\n\t\t\t\t\t});\r\n\t\t\t\t},\r\n\t\t\t\tasync getItemOfId(context, id = \"\") {\r\n\t\t\t\t\treturn context.state.processor.acquire(\"getItemOfId\", async () => {\r\n\t\t\t\t\t\tlet items = await context.dispatch(\"getItems\");\r\n\t\t\t\t\t\tlet item = items.find((item) => item.id === id);\r\n\t\t\t\t\t\tif (!item) {\r\n\t\t\t\t\t\t\titems = await context.dispatch(\"refreshItems\");\r\n\t\t\t\t\t\t\titem = items.find((item) => item.id === id);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\treturn item;\r\n\t\t\t\t\t});\r\n\t\t\t\t},\r\n\r\n\t\t\t\tasync getGroupsByCategory(context) {\r\n\t\t\t\t\tconst items = await context.dispatch(\"getItems\");\r\n\r\n\t\t\t\t\tconst categoryOther = await categoryStore.dispatch(\r\n\t\t\t\t\t\t\"getItemOfKey\",\r\n\t\t\t\t\t\tCategory.Key.Other,\r\n\t\t\t\t\t);\r\n\r\n\t\t\t\t\tconst groups = [];\r\n\t\t\t\t\tfor (const item of items) {\r\n\t\t\t\t\t\tlet category = await item.fetchCategory();\r\n\t\t\t\t\t\tif (!category) category = categoryOther;\r\n\t\t\t\t\t\tlet categoryId = category ? category.id : \"\";\r\n\r\n\t\t\t\t\t\tlet group = groups.find((group) => {\r\n\t\t\t\t\t\t\treturn group.category.id === categoryId;\r\n\t\t\t\t\t\t});\r\n\r\n\t\t\t\t\t\tif (!group) {\r\n\t\t\t\t\t\t\tgroups.push((group = { category, items: [] }));\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tgroup.items.push(item);\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\treturn groups;\r\n\t\t\t\t},\r\n\t\t\t\tasync getGroupsByBrand(context) {\r\n\t\t\t\t\tconst items = await context.dispatch(\"getItems\");\r\n\r\n\t\t\t\t\tconst groups = [];\r\n\t\t\t\t\tfor (const item of items) {\r\n\t\t\t\t\t\tlet group = groups.find((group) => {\r\n\t\t\t\t\t\t\tconst brandId = group.brand ? group.brand.id : \"\";\r\n\t\t\t\t\t\t\treturn brandId === item.brandId;\r\n\t\t\t\t\t\t});\r\n\r\n\t\t\t\t\t\tlet brand = await item.fetchBrand();\r\n\t\t\t\t\t\tif (!group) {\r\n\t\t\t\t\t\t\tgroups.push((group = { brand, items: [] }));\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tgroup.items.push(item);\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\treturn groups;\r\n\t\t\t\t},\r\n\r\n\t\t\t\tasync addItem(context, arg = { data }) {\r\n\t\t\t\t\treturn context.state.processor\r\n\t\t\t\t\t\t.acquire(\"addItem\", async () => {\r\n\t\t\t\t\t\t\tlet { data } = arg;\r\n\t\t\t\t\t\t\tif (!data) throw new Error(\"data not valid\");\r\n\t\t\t\t\t\t\tlet api = await ApiHost.request()\r\n\t\t\t\t\t\t\t\t.POST()\r\n\t\t\t\t\t\t\t\t.url(\"productv2/\")\r\n\t\t\t\t\t\t\t\t.body({ content: data })\r\n\t\t\t\t\t\t\t\t.send();\r\n\t\t\t\t\t\t\tlet error = api.getError();\r\n\t\t\t\t\t\t\tlet content = api.getContent();\r\n\t\t\t\t\t\t\tif (error) throw new Error(error);\r\n\t\t\t\t\t\t\tlet productNew = new Product(Stores).fromData(content);\r\n\t\t\t\t\t\t\tlet item = new CollectionUpdater(context)\r\n\t\t\t\t\t\t\t\t.onId((item) => item.id)\r\n\t\t\t\t\t\t\t\t.getItem(productNew);\r\n\t\t\t\t\t\t\treturn item;\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t\t.catch((error) => {\r\n\t\t\t\t\t\t\tconsole.error(error);\r\n\t\t\t\t\t\t\tthrow error;\r\n\t\t\t\t\t\t});\r\n\t\t\t\t},\r\n\t\t\t\tasync removeItemOfId(context, arg = { id }) {\r\n\t\t\t\t\treturn context.state.processor.acquire(\"removeItemOfId\", async () => {\r\n\t\t\t\t\t\tlet { id } = arg;\r\n\t\t\t\t\t\tlet api = await ApiHost.request()\r\n\t\t\t\t\t\t\t.DELETE()\r\n\t\t\t\t\t\t\t.url(`productv2/id/${id}`)\r\n\t\t\t\t\t\t\t.body({ id })\r\n\t\t\t\t\t\t\t.send();\r\n\t\t\t\t\t\tlet error = api.getError();\r\n\t\t\t\t\t\tif (error) throw new Error(error);\r\n\t\t\t\t\t\tlet items = context.state.items.filter((item) => {\r\n\t\t\t\t\t\t\treturn item.id !== id;\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t\tcontext.commit(\"items\", items);\r\n\t\t\t\t\t\tcontext.commit(\"lastModified\", Date.now());\r\n\t\t\t\t\t\treturn true;\r\n\t\t\t\t\t});\r\n\t\t\t\t},\r\n\r\n\t\t\t\tasync onUpdateItem(context, arg = { id, callback }) {\r\n\t\t\t\t\treturn context.state.processor.acquire(\"onUpdateItem\", async () => {\r\n\t\t\t\t\t\tlet { id, callback } = arg;\r\n\t\t\t\t\t\tlet item = await context.dispatch(\"getItemOfId\", id);\r\n\t\t\t\t\t\tif (item) callback(item);\r\n\t\t\t\t\t\treturn item;\r\n\t\t\t\t\t});\r\n\t\t\t\t},\r\n\r\n\t\t\t\tasync updateTitleOfId(context, arg = { id, title }) {\r\n\t\t\t\t\treturn context.state.processor.acquire(\r\n\t\t\t\t\t\t\"updateTitleOfId\",\r\n\t\t\t\t\t\tasync () => {\r\n\t\t\t\t\t\t\tlet { id, title } = arg;\r\n\t\t\t\t\t\t\tlet api = await ApiHost.request()\r\n\t\t\t\t\t\t\t\t.PUT()\r\n\t\t\t\t\t\t\t\t.url(\"productv2/title/\")\r\n\t\t\t\t\t\t\t\t.body({ content: { productId: id, title } })\r\n\t\t\t\t\t\t\t\t.send();\r\n\t\t\t\t\t\t\tlet error = api.getError();\r\n\t\t\t\t\t\t\tlet content = api.getContent();\r\n\t\t\t\t\t\t\tif (error) {\r\n\t\t\t\t\t\t\t\tthrow new Error(error);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tlet item = await context.dispatch(\"onUpdateItem\", {\r\n\t\t\t\t\t\t\t\tid: content.productId,\r\n\t\t\t\t\t\t\t\tcallback: (item) => {\r\n\t\t\t\t\t\t\t\t\titem.title = U.optString(content.title);\r\n\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\treturn item;\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t);\r\n\t\t\t\t},\r\n\t\t\t\tasync updateDescriptionOfId(context, arg = { id, description }) {\r\n\t\t\t\t\treturn context.state.processor.acquire(\r\n\t\t\t\t\t\t\"updateDescriptionOfId\",\r\n\t\t\t\t\t\tasync () => {\r\n\t\t\t\t\t\t\tlet { id, description } = arg;\r\n\t\t\t\t\t\t\tlet api = await ApiHost.request()\r\n\t\t\t\t\t\t\t\t.PUT()\r\n\t\t\t\t\t\t\t\t.url(\"productv2/description/\")\r\n\t\t\t\t\t\t\t\t.body({ content: { productId: id, description } })\r\n\t\t\t\t\t\t\t\t.send();\r\n\t\t\t\t\t\t\tlet error = api.getError();\r\n\t\t\t\t\t\t\tlet content = api.getContent();\r\n\t\t\t\t\t\t\tif (error) {\r\n\t\t\t\t\t\t\t\tthrow new Error(error);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tlet item = await context.dispatch(\"onUpdateItem\", {\r\n\t\t\t\t\t\t\t\tid: content.productId,\r\n\t\t\t\t\t\t\t\tcallback: (item) => {\r\n\t\t\t\t\t\t\t\t\titem.description = U.isString(content.description)\r\n\t\t\t\t\t\t\t\t\t\t? content.description.trim()\r\n\t\t\t\t\t\t\t\t\t\t: \"\";\r\n\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\treturn item;\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t);\r\n\t\t\t\t},\r\n\t\t\t\tasync updateBrandIdOfId(context, arg = { id, brandId }) {\r\n\t\t\t\t\treturn context.state.processor.acquire(\r\n\t\t\t\t\t\t\"updateBrandIdOfId\",\r\n\t\t\t\t\t\tasync () => {\r\n\t\t\t\t\t\t\tlet { id, brandId } = arg;\r\n\t\t\t\t\t\t\tlet api = await ApiHost.request()\r\n\t\t\t\t\t\t\t\t.PUT()\r\n\t\t\t\t\t\t\t\t.url(\"productv2/brandId/\")\r\n\t\t\t\t\t\t\t\t.body({ content: { productId: id, brandId } })\r\n\t\t\t\t\t\t\t\t.send();\r\n\t\t\t\t\t\t\tlet error = api.getError();\r\n\t\t\t\t\t\t\tlet content = api.getContent();\r\n\t\t\t\t\t\t\tif (error) {\r\n\t\t\t\t\t\t\t\tthrow new Error(error);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tlet item = await context.dispatch(\"onUpdateItem\", {\r\n\t\t\t\t\t\t\t\tid: content.productId,\r\n\t\t\t\t\t\t\t\tcallback: (item) => item.setBrandId(content.brandId),\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\treturn item;\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t);\r\n\t\t\t\t},\r\n\t\t\t\tasync updateCategoryIdOfId(context, arg = { id, categoryId }) {\r\n\t\t\t\t\treturn context.state.processor.acquire(\r\n\t\t\t\t\t\t\"updateCategoryIdOfId\",\r\n\t\t\t\t\t\tasync () => {\r\n\t\t\t\t\t\t\tlet { id, categoryId } = arg;\r\n\t\t\t\t\t\t\tlet api = await ApiHost.request()\r\n\t\t\t\t\t\t\t\t.PUT()\r\n\t\t\t\t\t\t\t\t.url(\"productv2/categoryId/\")\r\n\t\t\t\t\t\t\t\t.body({ content: { productId: id, categoryId } })\r\n\t\t\t\t\t\t\t\t.send();\r\n\t\t\t\t\t\t\tlet error = api.getError();\r\n\t\t\t\t\t\t\tlet content = api.getContent();\r\n\t\t\t\t\t\t\tif (error) {\r\n\t\t\t\t\t\t\t\tthrow new Error(error);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tlet item = await context.dispatch(\"onUpdateItem\", {\r\n\t\t\t\t\t\t\t\tid: content.productId,\r\n\t\t\t\t\t\t\t\tcallback: (item) => item.setCategoryId(content.categoryId),\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\treturn item;\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t);\r\n\t\t\t\t},\r\n\t\t\t\tasync updateAvailabilityOfId(context, arg = { id, isAvailable }) {\r\n\t\t\t\t\treturn context.state.processor.acquire(\r\n\t\t\t\t\t\t\"updateAvailabilityOfId\",\r\n\t\t\t\t\t\tasync () => {\r\n\t\t\t\t\t\t\tlet { id, isAvailable } = arg;\r\n\t\t\t\t\t\t\tlet api = await ApiHost.request()\r\n\t\t\t\t\t\t\t\t.PUT()\r\n\t\t\t\t\t\t\t\t.url(\"productv2/isAvailable/\")\r\n\t\t\t\t\t\t\t\t.body({ content: { productId: id, isAvailable } })\r\n\t\t\t\t\t\t\t\t.send();\r\n\t\t\t\t\t\t\tlet error = api.getError();\r\n\t\t\t\t\t\t\tlet content = api.getContent();\r\n\t\t\t\t\t\t\tif (error) {\r\n\t\t\t\t\t\t\t\tthrow new Error(error);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tlet item = await context.dispatch(\"onUpdateItem\", {\r\n\t\t\t\t\t\t\t\tid: content.productId,\r\n\t\t\t\t\t\t\t\tcallback: (item) => {\r\n\t\t\t\t\t\t\t\t\titem.stock.isAvailable = content.isAvailable;\r\n\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\treturn item;\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t);\r\n\t\t\t\t},\r\n\t\t\t\tasync updateSecondHandOfId(context, arg = { id, isSecondHand }) {\r\n\t\t\t\t\treturn context.state.processor.acquire(\r\n\t\t\t\t\t\t\"updateSecondHandOfId\",\r\n\t\t\t\t\t\tasync () => {\r\n\t\t\t\t\t\t\tlet { id, isSecondHand } = arg;\r\n\t\t\t\t\t\t\tlet api = await ApiHost.request()\r\n\t\t\t\t\t\t\t\t.PUT()\r\n\t\t\t\t\t\t\t\t.url(\"productv2/isSecondHand/\")\r\n\t\t\t\t\t\t\t\t.body({ content: { productId: id, isSecondHand } })\r\n\t\t\t\t\t\t\t\t.send();\r\n\t\t\t\t\t\t\tlet error = api.getError();\r\n\t\t\t\t\t\t\tlet content = api.getContent();\r\n\t\t\t\t\t\t\tif (error) {\r\n\t\t\t\t\t\t\t\tthrow new Error(error);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tlet item = await context.dispatch(\"onUpdateItem\", {\r\n\t\t\t\t\t\t\t\tid: content.productId,\r\n\t\t\t\t\t\t\t\tcallback: (item) => {\r\n\t\t\t\t\t\t\t\t\titem.stock.isSecondHand = content.isSecondHand;\r\n\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\treturn item;\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t);\r\n\t\t\t\t},\r\n\t\t\t\tasync updatePriceOfId(context, arg = { id, price }) {\r\n\t\t\t\t\treturn context.state.processor.acquire(\r\n\t\t\t\t\t\t\"updatePriceOfId\",\r\n\t\t\t\t\t\tasync () => {\r\n\t\t\t\t\t\t\tlet { id, price } = arg;\r\n\t\t\t\t\t\t\tprice = ModulePrice.trim(price);\r\n\r\n\t\t\t\t\t\t\tlet api = await ApiHost.request()\r\n\t\t\t\t\t\t\t\t.PUT()\r\n\t\t\t\t\t\t\t\t.url(\"productv2/price/\")\r\n\t\t\t\t\t\t\t\t.body({ content: { productId: id, price } })\r\n\t\t\t\t\t\t\t\t.send();\r\n\t\t\t\t\t\t\tlet error = api.getError();\r\n\t\t\t\t\t\t\tlet content = api.getContent();\r\n\t\t\t\t\t\t\tif (error) throw new Error(error);\r\n\t\t\t\t\t\t\tlet item = await context.dispatch(\"onUpdateItem\", {\r\n\t\t\t\t\t\t\t\tid: content.productId,\r\n\t\t\t\t\t\t\t\tcallback: (item) => {\r\n\t\t\t\t\t\t\t\t\titem.setPrice({\r\n\t\t\t\t\t\t\t\t\t\tnormal: content.price.normal,\r\n\t\t\t\t\t\t\t\t\t\tpromotion: content.price.promotion,\r\n\t\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\treturn item;\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t);\r\n\t\t\t\t},\r\n\r\n\t\t\t\tasync addBundleOfId(context, arg = { id, bundle }) {\r\n\t\t\t\t\treturn context.state.processor.acquire(\"addBundleOfId\", async () => {\r\n\t\t\t\t\t\tlet { id, bundle } = arg;\r\n\t\t\t\t\t\tlet api = await ApiHost.request()\r\n\t\t\t\t\t\t\t.POST()\r\n\t\t\t\t\t\t\t.url(\"productv2/bundle/\")\r\n\t\t\t\t\t\t\t.body({ content: { productId: id, bundle } })\r\n\t\t\t\t\t\t\t.send();\r\n\t\t\t\t\t\tlet error = api.getError();\r\n\t\t\t\t\t\tlet content = api.getContent();\r\n\t\t\t\t\t\tif (error) throw new Error(error);\r\n\t\t\t\t\t\tlet item = await context.dispatch(\"onUpdateItem\", {\r\n\t\t\t\t\t\t\tid: content.productId,\r\n\t\t\t\t\t\t\tcallback: (item) => {\r\n\t\t\t\t\t\t\t\titem.addBundle(ModuleBundle.trim(content.bundle));\r\n\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t\treturn item;\r\n\t\t\t\t\t});\r\n\t\t\t\t},\r\n\t\t\t\tasync removeBundleOfId(context, arg = { id, bundle }) {\r\n\t\t\t\t\treturn context.state.processor.acquire(\r\n\t\t\t\t\t\t\"removeBundleOfId\",\r\n\t\t\t\t\t\tasync () => {\r\n\t\t\t\t\t\t\tlet { id, bundle } = arg;\r\n\t\t\t\t\t\t\tlet api = await ApiHost.request()\r\n\t\t\t\t\t\t\t\t.DELETE()\r\n\t\t\t\t\t\t\t\t.url(\"productv2/bundle/\")\r\n\t\t\t\t\t\t\t\t.body({\r\n\t\t\t\t\t\t\t\t\tcontent: {\r\n\t\t\t\t\t\t\t\t\t\tproductId: id,\r\n\t\t\t\t\t\t\t\t\t\tbundle: ModuleBundle.trim(bundle),\r\n\t\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t\t.send();\r\n\t\t\t\t\t\t\tlet error = api.getError();\r\n\t\t\t\t\t\t\tlet content = api.getContent();\r\n\t\t\t\t\t\t\tif (error) throw new Error(error);\r\n\t\t\t\t\t\t\tlet item = await context.dispatch(\"onUpdateItem\", {\r\n\t\t\t\t\t\t\t\tid: content.productId,\r\n\t\t\t\t\t\t\t\tcallback: (item) => item.removeBundle(content.bundle),\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\treturn item;\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t);\r\n\t\t\t\t},\r\n\r\n\t\t\t\tasync addGiftOfId(context, arg = { id, gift }) {\r\n\t\t\t\t\treturn context.state.processor.acquire(\"addGiftOfId\", async () => {\r\n\t\t\t\t\t\tlet { id, gift } = arg;\r\n\t\t\t\t\t\tlet api = await ApiHost.request()\r\n\t\t\t\t\t\t\t.POST()\r\n\t\t\t\t\t\t\t.url(\"productv2/gift/\")\r\n\t\t\t\t\t\t\t.body({ content: { productId: id, gift } })\r\n\t\t\t\t\t\t\t.send();\r\n\t\t\t\t\t\tlet error = api.getError();\r\n\t\t\t\t\t\tlet content = api.getContent();\r\n\t\t\t\t\t\tif (error) {\r\n\t\t\t\t\t\t\tthrow new Error(error);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tlet item = await context.dispatch(\"onUpdateItem\", {\r\n\t\t\t\t\t\t\tid: content.productId,\r\n\t\t\t\t\t\t\tcallback: (item) => item.addGift(content.gift),\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t\treturn item;\r\n\t\t\t\t\t});\r\n\t\t\t\t},\r\n\t\t\t\tasync removeGiftOfId(context, arg = { id, gift }) {\r\n\t\t\t\t\treturn context.state.processor.acquire(\"removeGiftOfId\", async () => {\r\n\t\t\t\t\t\tlet { id, gift } = arg;\r\n\t\t\t\t\t\tlet api = await ApiHost.request()\r\n\t\t\t\t\t\t\t.DELETE()\r\n\t\t\t\t\t\t\t.url(\"productv2/gift/\")\r\n\t\t\t\t\t\t\t.body({ content: { productId: id, gift } })\r\n\t\t\t\t\t\t\t.send();\r\n\t\t\t\t\t\tlet error = api.getError();\r\n\t\t\t\t\t\tlet content = api.getContent();\r\n\t\t\t\t\t\tif (error) {\r\n\t\t\t\t\t\t\tthrow new Error(error);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tlet item = await context.dispatch(\"onUpdateItem\", {\r\n\t\t\t\t\t\t\tid: content.productId,\r\n\t\t\t\t\t\t\tcallback: (item) => item.removeGift(content.gift),\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t\treturn item;\r\n\t\t\t\t\t});\r\n\t\t\t\t},\r\n\r\n\t\t\t\tasync addSpecificationOfId(context, arg = { id, specification }) {\r\n\t\t\t\t\treturn context.state.processor.acquire(\r\n\t\t\t\t\t\t\"addSpecificationOfId\",\r\n\t\t\t\t\t\tasync () => {\r\n\t\t\t\t\t\t\tlet { id, specification } = arg;\r\n\t\t\t\t\t\t\tlet api = await ApiHost.request()\r\n\t\t\t\t\t\t\t\t.POST()\r\n\t\t\t\t\t\t\t\t.url(\"productv2/specification/\")\r\n\t\t\t\t\t\t\t\t.body({ content: { productId: id, specification } })\r\n\t\t\t\t\t\t\t\t.send();\r\n\t\t\t\t\t\t\tlet error = api.getError();\r\n\t\t\t\t\t\t\tlet content = api.getContent();\r\n\t\t\t\t\t\t\tif (error) throw new Error(error);\r\n\t\t\t\t\t\t\tlet item = await context.dispatch(\"onUpdateItem\", {\r\n\t\t\t\t\t\t\t\tid: content.productId,\r\n\t\t\t\t\t\t\t\tcallback(item) {\r\n\t\t\t\t\t\t\t\t\titem.addSpecification(content.specification);\r\n\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\treturn item;\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t);\r\n\t\t\t\t},\r\n\t\t\t\tasync removeSpecificationOfId(context, arg = { id, specification }) {\r\n\t\t\t\t\treturn context.state.processor.acquire(\r\n\t\t\t\t\t\t\"removeSpecificationOfId\",\r\n\t\t\t\t\t\tasync () => {\r\n\t\t\t\t\t\t\tlet { id, specification } = arg;\r\n\t\t\t\t\t\t\tspecification =\r\n\t\t\t\t\t\t\t\tspecification instanceof ProductSpecContent\r\n\t\t\t\t\t\t\t\t\t? specification.toData()\r\n\t\t\t\t\t\t\t\t\t: specification;\r\n\t\t\t\t\t\t\tspecification.type = specification.key;\r\n\t\t\t\t\t\t\tlet api = await ApiHost.request()\r\n\t\t\t\t\t\t\t\t.DELETE()\r\n\t\t\t\t\t\t\t\t.url(\"productv2/specification/\")\r\n\t\t\t\t\t\t\t\t.body({ content: { productId: id, specification } })\r\n\t\t\t\t\t\t\t\t.send();\r\n\t\t\t\t\t\t\tlet error = api.getError();\r\n\t\t\t\t\t\t\tlet content = api.getContent();\r\n\t\t\t\t\t\t\tif (error) throw new Error(error);\r\n\t\t\t\t\t\t\tlet item = await context.dispatch(\"onUpdateItem\", {\r\n\t\t\t\t\t\t\t\tid: content.productId,\r\n\t\t\t\t\t\t\t\tcallback(item) {\r\n\t\t\t\t\t\t\t\t\titem.removeSpecification(content.specification);\r\n\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\treturn item;\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t);\r\n\t\t\t\t},\r\n\t\t\t\tasync updateSpecificationsOfId(context, arg = { id, specifications }) {\r\n\t\t\t\t\treturn context.state.processor.acquire(\r\n\t\t\t\t\t\t\"updateSpecificationsOfId\",\r\n\t\t\t\t\t\tasync () => {\r\n\t\t\t\t\t\t\tlet { id, specifications } = arg;\r\n\t\t\t\t\t\t\tlet api = await ApiHost.request()\r\n\t\t\t\t\t\t\t\t.PUT()\r\n\t\t\t\t\t\t\t\t.url(\"productv2/specification/list\")\r\n\t\t\t\t\t\t\t\t.body({ content: { productId: id, specifications } })\r\n\t\t\t\t\t\t\t\t.send();\r\n\t\t\t\t\t\t\tlet error = api.getError();\r\n\t\t\t\t\t\t\tlet content = api.getContent();\r\n\t\t\t\t\t\t\tif (error) throw new Error(error);\r\n\t\t\t\t\t\t\tlet item = await context.dispatch(\"onUpdateItem\", {\r\n\t\t\t\t\t\t\t\tid: content.productId,\r\n\t\t\t\t\t\t\t\tcallback(item) {\r\n\t\t\t\t\t\t\t\t\titem.setSpecifications(content.specifications);\r\n\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\treturn item;\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t);\r\n\t\t\t\t},\r\n\r\n\t\t\t\tasync addImageOfId(context, arg = { id, imageFile }) {\r\n\t\t\t\t\treturn context.state.processor.acquire(\"addImageOfId\", async () => {\r\n\t\t\t\t\t\tlet { id, imageFile } = arg;\r\n\t\t\t\t\t\tconst imageFileForm = new FormData();\r\n\t\t\t\t\t\timageFileForm.append(imageFile.name, imageFile);\r\n\t\t\t\t\t\tlet api = await ApiHost.fetch({\r\n\t\t\t\t\t\t\tmethod: \"POST\",\r\n\t\t\t\t\t\t\turl: `productv2/id/${id}/image/`,\r\n\t\t\t\t\t\t\tbody: imageFileForm,\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t\tif (api.error) throw new Error(api.error);\r\n\t\t\t\t\t\tlet { content } = api;\r\n\t\t\t\t\t\tlet item = await context.dispatch(\"onUpdateItem\", {\r\n\t\t\t\t\t\t\tid: content.productId,\r\n\t\t\t\t\t\t\tcallback(item) {\r\n\t\t\t\t\t\t\t\titem.addImages(content.images);\r\n\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t\treturn item;\r\n\t\t\t\t\t});\r\n\t\t\t\t},\r\n\t\t\t\tasync removeImageOfId(context, arg = { id, image }) {\r\n\t\t\t\t\treturn context.state.processor.acquire(\r\n\t\t\t\t\t\t\"removeImageOfId\",\r\n\t\t\t\t\t\tasync () => {\r\n\t\t\t\t\t\t\tlet { id, image } = arg;\r\n\t\t\t\t\t\t\timage = image instanceof Image ? image.toData() : image;\r\n\t\t\t\t\t\t\tlet api = await ApiHost.request()\r\n\t\t\t\t\t\t\t\t.DELETE()\r\n\t\t\t\t\t\t\t\t.url(`productv2/id/${id}/image/`)\r\n\t\t\t\t\t\t\t\t.body({ content: { image } })\r\n\t\t\t\t\t\t\t\t.send();\r\n\t\t\t\t\t\t\tlet error = api.getError();\r\n\t\t\t\t\t\t\tlet content = api.getContent();\r\n\t\t\t\t\t\t\tif (error) throw new Error(error);\r\n\t\t\t\t\t\t\tlet item = await context.dispatch(\"onUpdateItem\", {\r\n\t\t\t\t\t\t\t\tid: content.productId,\r\n\t\t\t\t\t\t\t\tcallback(item) {\r\n\t\t\t\t\t\t\t\t\titem.removeImage(content.image);\r\n\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\treturn item;\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t);\r\n\t\t\t\t},\r\n\t\t\t},\r\n\t\t});\r\n\r\n\t\treturn productStore;\r\n\t},\r\n};\r\n"]}]}